<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>osCommerce Online Merchant v2.2 RC1 Upgrade Notes</title>
<style>
/* Default heading font (outside of tables) */
body { font-family: sans-serif; font-size: 11pt; }

td { vertical-align: top; padding-left: 4px; padding-right: 4px; }

/* File Difference Report styles - Color */
table.fc { border-top: 1px solid Black; border-left: 1px solid Black; width: 100%; font-family: monospace; font-size: 10pt; }

tr.secBegin td { border-left: none; border-top: none; border-right: 1px solid Black; }
tr.secMiddle td { border-left: none; border-top: none; border-right: 1px solid Black; }
tr.secEnd td { border-left: none; border-top: none; border-bottom: 1px solid Black; border-right: 1px solid Black; }
tr.secAll td { border-left: none; border-top: none; border-bottom: 1px solid Black; border-right: 1px solid Black; }
tr.secSubEnd td { border-left: none; border-top: none; border-bottom: 1px solid Gray; border-right: 1px solid Black; }
tr.secSubAll td { border-left: none; border-top: none; border-bottom: 1px solid Gray; border-right: 1px solid Black; }
tr.secGap td { font-size: 4px; border-left: none; border-top: none; border-bottom: 1px solid Black; border-right: 1px solid Black; }

td.LineNum { text-align: right; }
td.LineRange { font-family: sans-serif; }
td.SubLineRange { font-family: sans-serif; border-bottom: none; }

td.AlignLeft { text-align: left; }
td.AlignRight { text-align: right; }
td.AlignCenter { text-align: center; }
td.Caption { text-align: left; background-color: #E7E7E7; padding-top: 8px; }

td.Normal { }
td.HasSimilar { background-color: #F0F0FF; }
td.HasMismatch { background-color: #FFF0F0; }
td.HasOrphan { background-color: #FFF0F0; }
td.Added { background-color: #FFF0F0; }
td.Deleted { background-color: #FFF0F0; text-decoration: line-through; }
td.UAdded { background-color: #F0F0FF; }
td.UDeleted { background-color: #F0F0FF; text-decoration: line-through; }

.ttSigDiff { color: #FF0000; }
.ttInsigDiff { color: #0000FF; }
.ttAdded { color: #FF0000; }
.ttDeleted { text-decoration: line-through; }

/* Directory Comparison Report styles - Color */
table.dc { border-top: 1px solid Black; border-left: 1px solid Black; width: 100%; font-family: sans-serif; font-size: 10pt; }

table.dc tr.secBegin td { border-bottom: 1px solid Silver; }
table.dc tr.secMiddle td { border-bottom: 1px solid Silver; }

.ttNewer { color: #FF0000; }
.ttOlder { color: #808080; }
.ttOrphan { color: #0000FF; }
.ttGhosted { color: #008080; }

.affectedFiles { border: 1px #cccccc dotted; background-color: #eeeeee; font-style: italic; }
.sqlBox { border: 1px #84F0B5 solid; background-color: #EAF5DE; }
</style>
</head>
<body>

<h1>osCommerce Online Merchant v2.2 RC1 Upgrade Notes</h1>

<p>The following upgrade guide is based on the osCommerce 2.2 Milestone 2 Update 060817 release. If you have not yet updated to this release please review its upgrade guide in the extras directory (<a href="update-20060817.txt">update-20060817.txt</a>) before applying these changes.</p>

<p>The following changes should be performed in order on your installation to upgrade it to osCommerce Online Merchant v2.2 RC1. Please note that the following changes are only the recommended changes to make and does not include the new Administration Tool login routine or the Administration Tool index page summary modules that are available with new installations. This is to avoid a conflict with existing Administration Tool securing mechanisms already in place.</p>

<ul>
  <li>[BUGFIX] Caching of the Manufacturers Box</li>
  <li>[IMPROVEMENT] Database Backup</li>
  <li>[IMPROVEMENT] Input Fields on Checkout Confirmation Page</li>
  <li>[IMPROVEMENT] register_globals Compatibility for PHP 4.3+ Servers</li>
  <li>[BUGFIX] Currency Case-Sensitivity</li>
  <li>[BUGFIX] Invoice and Packing Slip Billing Address</li>
  <li>[IMPROVEMENT] Configuration -> Minimum Values Settings</li>
  <li>[BUGFIX] Compatibility Array Index</li>
  <li>[IMPROVEMENT] MySQL Database Connection Identifier Link</li>
  <li>[BUGFIX] Product Sorting SQL Injection Vulnerability</li>
  <li>[BUGFIX] Product Price Calculations</li>
  <li>[BUGFIX] Country Name on the Order History Page</li>
  <li>[BUGFIX] Shopping Cart Product Quantity as Integer Value</li>
  <li>[IMPROVEMENT] Maximum Order Product Quantities [+SQL]</li>
  <li>[IMPROVEMENT] Accepting State Names</li>
  <li>[BUGFIX] Load the Order Total Modules Before Loading the Payment Modules</li>
  <li>[BUGFIX] Payment Module Selection</li>
  <li>[BUGFIX] Category Image Removal</li>
  <li>[BUGFIX] Add the Session ID to GET Based Forms</li>
  <li>[BUGFIX] Fix Typo on the Products New Page</li>
  <li>[BUGFIX] Process the Order Total Modules Earlier on the Checkout Confirmation Page</li>
  <li>[BUGFIX] PHP &lt; 4.1 Compatibility Update</li>
  <li>[BUGFIX] Strip Additional Slashes When Editing Reviews</li>
  <li>[IMPROVEMENT] New Public Title for Payment Modules</li>
  <li>[IMPROVEMENT] Navigation History Parameter Filter</li>
  <li>[IMPROVEMENT] Increase Configuration Key and Title Database Field Sizes [SQL]</li>
  <li>[BUGFIX] Strip Additional Slashes When Editing Files Through the File Manager</li>
</Ul>

<h3>[BUGFIX] Caching of the Manufacturers Box</h3>

<p>Fix a spelling mistake preventing the manufacturers box being cached.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/functions/cache.php</p>

<span class="affectedFiles">File: catalog/includes/functions/cache.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">119</td>
<td class="Normal">&nbsp; function tep_cache_manufacturers_box($auto_expire = false, $refresh = false) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">119</td>
<td class="Normal">&nbsp; function tep_cache_manufacturers_box($auto_expire = false, $refresh = false) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">120</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $language;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">120</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $language;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">121</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">121</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">122</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $cache_output = '';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">122</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $cache_output = '';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">123</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">123</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">124</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $manufacturers_id = '';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">124</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $manufacturers_id = '';</td>
</tr>
<tr class="secAll">
<td class="LineNum">125</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (isset($HTTP_GET_VARS['manufactuers_id']) &amp;&amp; is_numeric($HTTP_GET_VARS['manufacturers_id'])) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">125</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (isset($HTTP_GET_VARS['manufactu<span class="ttSigDiff">r</span>ers_id']) &amp;&amp; is_numeric($HTTP_GET_VARS['manufacturers_id'])) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">126</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $manufacturers_id = $HTTP_GET_VARS['manufacturers_id'];</td>
<td class="AlignCenter">=</td>
<td class="LineNum">126</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $manufacturers_id = $HTTP_GET_VARS['manufacturers_id'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">127</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">127</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">128</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">128</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">129</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (($refresh == true) || !read_cache($cache_output, 'manufacturers_box-' . $language . '.cache' . $manufacturers_id, $auto_expire)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">129</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (($refresh == true) || !read_cache($cache_output, 'manufacturers_box-' . $language . '.cache' . $manufacturers_id, $auto_expire)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">130</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ob_start();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">130</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ob_start();</td>
</tr>
<tr class="secEnd">
<td class="LineNum">131</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; include(DIR_WS_BOXES . 'manufacturers.php');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">131</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; include(DIR_WS_BOXES . 'manufacturers.php');</td>
</tr>
</table>

<h3>[IMPROVEMENT] Database Backup</h3>

<p>Don't store the session and whos online database tables in the database backups.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/backup.php</p>

<span class="affectedFiles">File: catalog/admin/backup.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">70</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $keys_query = tep_db_query(&quot;show keys from &quot; . $table);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">70</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $keys_query = tep_db_query(&quot;show keys from &quot; . $table);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">71</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while ($keys = tep_db_fetch_array($keys_query)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">71</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while ($keys = tep_db_fetch_array($keys_query)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">72</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $kname = $keys['Key_name'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">72</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $kname = $keys['Key_name'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">73</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">73</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">74</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!isset($index[$kname])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">74</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!isset($index[$kname])) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">75</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $index[$kname] = array('unique' =&gt; !$keys['Non_unique'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">75</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $index[$kname] = array('unique' =&gt; !$keys['Non_unique'],</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">76</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'fulltext' =&gt; ($keys['Index_type'] == 'FULLTEXT' ? '1' : '0'),</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">76</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'columns' =&gt; array());</td>
<td class="AlignCenter">=</td>
<td class="LineNum">77</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'columns' =&gt; array());</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">77</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">78</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">78</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">79</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">79</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $index[$kname]['columns'][] = $keys['Column_name'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">80</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $index[$kname]['columns'][] = $keys['Column_name'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">80</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">81</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">81</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">82</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">83</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema .= ',' . &quot;\n&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">84</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema .= ',' . &quot;\n&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">84</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">85</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">85</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $columns = implode($info['columns'], ', ');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">86</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $columns = implode($info['columns'], ', ');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">86</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">87</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">87</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($kname == 'PRIMARY') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">88</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($kname == 'PRIMARY') {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">88</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema .= '&nbsp; PRIMARY KEY (' . $columns . ')';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">89</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema .= '&nbsp; PRIMARY KEY (' . $columns . ')';</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">90</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif ( $info['fulltext'] == '1' ) {</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">91</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema .= '&nbsp; FULLTEXT ' . $kname . ' (' . $columns . ')';</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">89</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif ($info['unique']) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">92</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif ($info['unique']) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">90</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema .= '&nbsp; UNIQUE ' . $kname . ' (' . $columns . ')';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">93</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema .= '&nbsp; UNIQUE ' . $kname . ' (' . $columns . ')';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">91</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">94</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">92</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema .= '&nbsp; KEY ' . $kname . ' (' . $columns . ')';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">95</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema .= '&nbsp; KEY ' . $kname . ' (' . $columns . ')';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">93</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">96</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">94</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">97</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">95</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">98</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">96</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema .= &quot;\n&quot; . ');' . &quot;\n\n&quot;;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">99</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema .= &quot;\n&quot; . ');' . &quot;\n\n&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">97</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fputs($fp, $schema);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">100</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fputs($fp, $schema);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">98</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">101</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">99</td>
<td class="Normal">// dump the data</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">102</td>
<td class="Normal">// dump the data</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">103</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( ($table != TABLE_SESSIONS ) &amp;&amp; ($table != TABLE_WHOS_ONLINE) ) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">100</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $rows_query = tep_db_query(&quot;select &quot; . implode(',', $table_list) . &quot; from &quot; . $table);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">104</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>$rows_query = tep_db_query(&quot;select &quot; . implode(',', $table_list) . &quot; from &quot; . $table);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">101</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while ($rows = tep_db_fetch_array($rows_query)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">105</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>while ($rows = tep_db_fetch_array($rows_query)) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">102</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema = 'insert into ' . $table . ' (' . implode(', ', $table_list) . ') values (';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">106</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>$schema = 'insert into ' . $table . ' (' . implode(', ', $table_list) . ') values (';</td>
</tr>
<tr class="secAll">
<td class="LineNum">103</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">107</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">104</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($table_list);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">108</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>reset($table_list);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">105</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list(,$i) = each($table_list)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">109</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>while (list(,$i) = each($table_list)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">106</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!isset($rows[$i])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">110</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>if (!isset($rows[$i])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">107</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema .= 'NULL, ';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">111</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>$schema .= 'NULL, ';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">108</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (tep_not_null($rows[$i])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">112</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>} elseif (tep_not_null($rows[$i])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">109</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $row = addslashes($rows[$i]);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">113</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>$row = addslashes($rows[$i]);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">110</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $row = ereg_replace(&quot;\n#&quot;, &quot;\n&quot;.'\#', $row);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">114</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>$row = ereg_replace(&quot;\n#&quot;, &quot;\n&quot;.'\#', $row);</td>
</tr>
<tr class="secAll">
<td class="LineNum">111</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">115</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">112</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema .= '\'' . $row . '\', ';</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">116</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>$schema .= '\'' . $row . '\', ';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">113</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">117</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>} else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">114</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema .= '\'\', ';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">118</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>$schema .= '\'\', ';</td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">119</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">115</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">120</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">121</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">122</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema = ereg_replace(', $', '', $schema) . ');' . &quot;\n&quot;;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">123</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fputs($fp, $schema);</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">116</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">124</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secBegin">
<td class="LineNum">117</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">+-</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">118</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $schema = ereg_replace(', $', '', $schema) . ');' . &quot;\n&quot;;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">119</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fputs($fp, $schema);</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">120</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">121</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">125</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">122</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">126</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">123</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">127</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">124</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fclose($fp);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">128</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fclose($fp);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">125</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">129</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">126</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($HTTP_POST_VARS['download']) &amp;&amp; ($HTTP_POST_VARS['download'] == 'yes')) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">130</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($HTTP_POST_VARS['download']) &amp;&amp; ($HTTP_POST_VARS['download'] == 'yes')) {</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">247</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;drop table if exists address_book, address_format, banners, banners_history, categories, categories_description, configuration, configuration_group, counter, counter_history, countries, currencies, customers, customers_basket, customers_basket_attributes, customers_info, languages, manufacturers, manufacturers_info, orders, orders_products, orders_status, orders_status_history, orders_products_attributes, orders_products_download, products, products_attributes, products_attributes_download, prodcts_description, products_options, products_options_values, products_options_values_to_products_options, products_to_categories, reviews, reviews_description, sessions, specials, tax_class, tax_rates, geo_zones, whos_online, zones, zones_to_geo_zones&quot;);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">251</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;drop table if exists address_book, address_format, banners, banners_history, categories, categories_description, configuration, configuration_group, counter, counter_history, countries, currencies, customers, customers_basket, customers_basket_attributes, customers_info, languages, manufacturers, manufacturers_info, orders, orders_products, orders_status, orders_status_history, orders_products_attributes, orders_products_download, products, products_attributes, products_attributes_download, prodcts_description, products_options, products_options_values, products_options_values_to_products_options, products_to_categories, reviews, reviews_description, sessions, specials, tax_class, tax_rates, geo_zones, whos_online, zones, zones_to_geo_zones&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">248</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">252</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">249</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($sql_array); $i&lt;$n; $i++) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">253</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($sql_array); $i&lt;$n; $i++) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">250</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query($sql_array[$i]);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">254</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query($sql_array[$i]);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">251</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">255</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">252</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">256</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">257</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_session_close();</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">258</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">259</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;delete from &quot; . TABLE_WHOS_ONLINE);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">260</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;delete from &quot; . TABLE_SESSIONS);</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">261</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">253</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;delete from &quot; . TABLE_CONFIGURATION . &quot; where configuration_key = 'DB_LAST_RESTORE'&quot;);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">262</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;delete from &quot; . TABLE_CONFIGURATION . &quot; where configuration_key = 'DB_LAST_RESTORE'&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">254</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;insert into &quot; . TABLE_CONFIGURATION . &quot; values ('', 'Last Database Restore', 'DB_LAST_RESTORE', '&quot; . $read_from . &quot;', 'Last database restore file', '6', '', '', now(), '', '')&quot;);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">263</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;insert into &quot; . TABLE_CONFIGURATION . &quot; values ('', 'Last Database Restore', 'DB_LAST_RESTORE', '&quot; . $read_from . &quot;', 'Last database restore file', '6', '', '', now(), '', '')&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">255</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">264</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">256</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($remove_raw) &amp;&amp; ($remove_raw == true)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">265</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($remove_raw) &amp;&amp; ($remove_raw == true)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">257</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unlink($restore_from);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">266</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unlink($restore_from);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">258</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">267</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
</table>

<h3>[IMPROVEMENT] Input Fields on Checkout Confirmation Page</h3>

<p>Allow payment modules to display input fields on the checkout confirmation page. This is for PCI conformance where the credit card number can be directly passed to the payment gateway.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/checkout_confirmation.php</p>

<span class="affectedFiles">File: catalog/checkout_confirmation.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">107</td>
<td class="Normal">&lt;?php require(DIR_WS_INCLUDES . 'column_left.php'); ?&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">107</td>
<td class="Normal">&lt;?php require(DIR_WS_INCLUDES . 'column_left.php'); ?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">108</td>
<td class="Normal">&lt;!-- left_navigation_eof //--&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">108</td>
<td class="Normal">&lt;!-- left_navigation_eof //--&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">109</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">109</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">110</td>
<td class="Normal">&lt;!-- body_text //--&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">110</td>
<td class="Normal">&lt;!-- body_text //--&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">111</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; &lt;td width=&quot;100%&quot; valign=&quot;top&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">111</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; &lt;td width=&quot;100%&quot; valign=&quot;top&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">112</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">112</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">113</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">114</td>
<td class="HasOrphan"><span class="ttSigDiff">&lt;?php</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">115</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; if (isset($$payment-&gt;form_action_url)) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">116</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $form_action_url = $$payment-&gt;form_action_url;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">117</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; } else {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">118</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $form_action_url = tep_href_link(FILENAME_CHECKOUT_PROCESS, '', 'SSL');</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">119</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">120</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">121</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; echo tep_draw_form('checkout_confirmation', $form_action_url, 'post');</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">122</td>
<td class="HasOrphan"><span class="ttSigDiff">?&gt;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">113</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;t<span class="ttSigDiff">d&gt;&lt;t</span>able border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">123</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">114</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">124</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">115</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot;&gt;&lt;?php echo HEADING_TITLE; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">125</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot;&gt;&lt;?php echo HEADING_TITLE; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">116</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot; align=&quot;right&quot;&gt;&lt;?php echo tep_image(DIR_WS_IMAGES . 'table_background_confirmation.gif', HEADING_TITLE, HEADING_IMAGE_WIDTH, HEADING_IMAGE_HEIGHT); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">126</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot; align=&quot;right&quot;&gt;&lt;?php echo tep_image(DIR_WS_IMAGES . 'table_background_confirmation.gif', HEADING_TITLE, HEADING_IMAGE_WIDTH, HEADING_IMAGE_HEIGHT); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">117</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">127</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">118</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">128</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">119</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">129</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">306</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">316</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">307</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">317</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">308</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">318</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">309</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">319</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">310</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot; class=&quot;main&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">320</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot; class=&quot;main&quot;&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">311</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">321</td>
<td class="Normal">&lt;?php</td>
</tr>
<tr class="secBegin">
<td class="LineNum">312</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; if (isset($$payment-&gt;form_action_url)) {</span></td>
<td class="AlignCenter">+-</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">313</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $form_action_url = $$payment-&gt;form_action_url;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">314</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; } else {</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">315</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $form_action_url = tep_href_link(FILENAME_CHECKOUT_PROCESS, '', 'SSL');</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">316</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; }</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">317</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">318</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; echo tep_draw_form('checkout_confirmation', $form_action_url, 'post');</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">319</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">320</td>
<td class="Normal">&nbsp; if (is_array($payment_modules-&gt;modules)) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">322</td>
<td class="Normal">&nbsp; if (is_array($payment_modules-&gt;modules)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">321</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; echo $payment_modules-&gt;process_button();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">323</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; echo $payment_modules-&gt;process_button();</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">322</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">324</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">323</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">325</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">324</td>
<td class="HasMismatch">&nbsp; echo tep_image_submit('button_confirm_order.gif', IMAGE_BUTTON_CONFIRM_ORDER) . <span class="ttSigDiff">'&lt;/form&gt;' . </span>&quot;\n&quot;;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">326</td>
<td class="HasMismatch">&nbsp; echo tep_image_submit('button_confirm_order.gif', IMAGE_BUTTON_CONFIRM_ORDER) . &quot;\n&quot;;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">325</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">327</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">326</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">328</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">327</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">329</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">328</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">330</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">329</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">331</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">330</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">332</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">359</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;center&quot; width=&quot;25%&quot; class=&quot;checkoutBarFrom&quot;&gt;&lt;?php echo '&lt;a href=&quot;' . tep_href_link(FILENAME_CHECKOUT_PAYMENT, '', 'SSL') . '&quot; class=&quot;checkoutBarFrom&quot;&gt;' . CHECKOUT_BAR_PAYMENT . '&lt;/a&gt;'; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">361</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;center&quot; width=&quot;25%&quot; class=&quot;checkoutBarFrom&quot;&gt;&lt;?php echo '&lt;a href=&quot;' . tep_href_link(FILENAME_CHECKOUT_PAYMENT, '', 'SSL') . '&quot; class=&quot;checkoutBarFrom&quot;&gt;' . CHECKOUT_BAR_PAYMENT . '&lt;/a&gt;'; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">360</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;center&quot; width=&quot;25%&quot; class=&quot;checkoutBarCurrent&quot;&gt;&lt;?php echo CHECKOUT_BAR_CONFIRMATION; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">362</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;center&quot; width=&quot;25%&quot; class=&quot;checkoutBarCurrent&quot;&gt;&lt;?php echo CHECKOUT_BAR_CONFIRMATION; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">361</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;center&quot; width=&quot;25%&quot; class=&quot;checkoutBarTo&quot;&gt;&lt;?php echo CHECKOUT_BAR_FINISHED; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">363</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;center&quot; width=&quot;25%&quot; class=&quot;checkoutBarTo&quot;&gt;&lt;?php echo CHECKOUT_BAR_FINISHED; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">362</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">364</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">363</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">365</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">364</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">366</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secAll">
<td class="LineNum">365</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">367</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/<span class="ttSigDiff">form&gt;&lt;/</span>td&gt;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">366</td>
<td class="Normal">&lt;!-- body_text_eof //--&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">368</td>
<td class="Normal">&lt;!-- body_text_eof //--&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">367</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; &lt;td width=&quot;&lt;?php echo BOX_WIDTH; ?&gt;&quot; valign=&quot;top&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;&lt;?php echo BOX_WIDTH; ?&gt;&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">369</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; &lt;td width=&quot;&lt;?php echo BOX_WIDTH; ?&gt;&quot; valign=&quot;top&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;&lt;?php echo BOX_WIDTH; ?&gt;&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">368</td>
<td class="Normal">&lt;!-- right_navigation //--&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">370</td>
<td class="Normal">&lt;!-- right_navigation //--&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">369</td>
<td class="Normal">&lt;?php require(DIR_WS_INCLUDES . 'column_right.php'); ?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">371</td>
<td class="Normal">&lt;?php require(DIR_WS_INCLUDES . 'column_right.php'); ?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">370</td>
<td class="Normal">&lt;!-- right_navigation_eof //--&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">372</td>
<td class="Normal">&lt;!-- right_navigation_eof //--&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">371</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">373</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
</table>

<h3>[IMPROVEMENT] register_globals Compatibility for PHP 4.3+ Servers</h3>

<p>Add a register_globals compatibility layer for PHP 4.3+ servers.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/application_top.php<br />
catalog/includes/functions/compatibility.php<br />
catalog/includes/functions/sessions.php<br />
catalog/includes/functions/html_output.php<br />
catalog/includes/classes/order.php<br />
catalog/includes/modules/address_book_details.php<br />
catalog/checkout_payment.php<br />
catalog/admin/includes/application_top.php<br />
catalog/admin/includes/functions/compatibility.php<br />
catalog/admin/includes/functions/sessions.php<br />
catalog/admin/includes/functions/html_output.php<br />
catalog/admin/includes/classes/upload.php<br />
catalog/admin/file_manager.php</p>

<span class="affectedFiles">File: catalog/includes/application_top.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">13</td>
<td class="Normal">// start the timer for the page parse time log</td>
<td class="AlignCenter">=</td>
<td class="LineNum">13</td>
<td class="Normal">// start the timer for the page parse time log</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">14</td>
<td class="Normal">&nbsp; define('PAGE_PARSE_START_TIME', microtime());</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">14</td>
<td class="Normal">&nbsp; define('PAGE_PARSE_START_TIME', microtime());</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">15</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">15</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">16</td>
<td class="Normal">// set the level of error reporting</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">16</td>
<td class="Normal">// set the level of error reporting</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">17</td>
<td class="Normal">&nbsp; error_reporting(E_ALL &amp; ~E_NOTICE);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">17</td>
<td class="Normal">&nbsp; error_reporting(E_ALL &amp; ~E_NOTICE);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">18</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">18</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">19</td>
<td class="HasMismatch">// check <span class="ttSigDiff">i</span>f register_globals<span class="ttSigDiff"> is enabled.</span></td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">19</td>
<td class="HasMismatch">// check <span class="ttSigDiff">support</span><span class="ttSigDiff"> </span>f<span class="ttSigDiff">or</span> register_globals</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">20</td>
<td class="HasMismatch"><span class="ttSigDiff">//</span> <span class="ttSigDiff">s</span>inc<span class="ttSigDiff">e this </span>is<span class="ttSigDiff"> a </span>t<span class="ttSigDiff">e</span><span class="ttSigDiff">mporary measure</span> <span class="ttSigDiff">this m</span>e<span class="ttSigDiff">ssag</span>e<span class="ttSigDiff"> </span>is<span class="ttSigDiff"> </span><span class="ttSigDiff">ha</span>r<span class="ttSigDiff">dcoded. The requir</span>e<span class="ttSigDiff">ment wil</span><span class="ttSigDiff">l</span> <span class="ttSigDiff">be</span> <span class="ttSigDiff">removed before</span> <span class="ttSigDiff">2</span>.<span class="ttSigDiff">2 is</span> <span class="ttSigDiff">f</span><span class="ttSigDiff">inalized.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">20</td>
<td class="HasMismatch">&nbsp;<span class="ttSigDiff"> </span>i<span class="ttSigDiff">f (fu</span>nc<span class="ttSigDiff">tion_ex</span>ist<span class="ttSigDiff">s('ini_get') &amp;&amp;</span> <span class="ttSigDiff">(ini_g</span>e<span class="ttSigDiff">t('r</span>e<span class="ttSigDiff">g</span>is<span class="ttSigDiff">te</span>r<span class="ttSigDiff">_globals') == fals</span>e<span class="ttSigDiff">)</span> <span class="ttSigDiff">&amp;&amp;</span> <span class="ttSigDiff">(PHP_VERSION &lt;</span> <span class="ttSigDiff">4</span>.<span class="ttSigDiff">3) )</span> <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">21</td>
<td class="HasMismatch">&nbsp; i<span class="ttSigDiff">f</span> <span class="ttSigDiff">(</span>fu<span class="ttSigDiff">nc</span>tion<span class="ttSigDiff">_ex</span>is<span class="ttSigDiff">ts('</span>ini_g<span class="ttSigDiff">e</span>t<span class="ttSigDiff">'))</span> <span class="ttSigDiff">{</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">21</td>
<td class="HasMismatch">&nbsp; <span class="ttSigDiff">&nbsp; exit('Server Requirement Error: register_globals </span>i<span class="ttSigDiff">s</span> <span class="ttSigDiff">disabled in your PHP co</span><span class="ttSigDiff">n</span>f<span class="ttSigDiff">ig</span>u<span class="ttSigDiff">ra</span>tion<span class="ttSigDiff">.</span><span class="ttSigDiff"> Th</span>is<span class="ttSigDiff"> can be enabled in your </span><span class="ttSigDiff">php.</span>ini<span class="ttSigDiff"> configuration file or in the .htaccess file in your catalog directory. Please use PHP 4.3+ if register</span>_g<span class="ttSigDiff">lobals cann</span><span class="ttSigDiff">o</span>t<span class="ttSigDiff"> be</span> <span class="ttSigDiff">e</span><span class="ttSigDiff">nabled on the server.');</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">22</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; ini_get('register_globals') or exit('Server Requirement Error: register_globals is disabled in your PHP configuration. This can be enabled in your php.ini configuration file or in the .htaccess file in your catalog directory.');</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">23</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">22</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">24</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">23</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">25</td>
<td class="Normal">// Set the local configuration parameters - mainly for developers</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">24</td>
<td class="Normal">// Set the local configuration parameters - mainly for developers</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">26</td>
<td class="Normal">&nbsp; if (file_exists('includes/local/configure.php')) include('includes/local/configure.php');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">25</td>
<td class="Normal">&nbsp; if (file_exists('includes/local/configure.php')) include('includes/local/configure.php');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">27</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">26</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">28</td>
<td class="Normal">// include server parameters</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">27</td>
<td class="Normal">// include server parameters</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">33</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; header('Location: install/index.php');</td>
<td class="AlignCenter">=</td>
<td class="LineNum">32</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; header('Location: install/index.php');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">34</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">33</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">35</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">34</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">36</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">35</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">37</td>
<td class="Normal">// define the project version</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">36</td>
<td class="Normal">// define the project version</td>
</tr>
<tr class="secEnd">
<td class="LineNum">38</td>
<td class="Normal">&nbsp; define('PROJECT_VERSION', 'osCommerce 2.2-MS2');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">37</td>
<td class="Normal">&nbsp; define('PROJECT_VERSION', 'osCommerce 2.2-MS2');</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">38</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">39</td>
<td class="HasOrphan"><span class="ttSigDiff">// some code to solve compatibility issues</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">40</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; require(DIR_WS_FUNCTIONS . 'compatibility.php');</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">39</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">41</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">40</td>
<td class="Normal">// set the type of request (secure or not)</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">42</td>
<td class="Normal">// set the type of request (secure or not)</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">41</td>
<td class="Normal">&nbsp; $request_type = (getenv('HTTPS') == 'on') ? 'SSL' : 'NONSSL';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">43</td>
<td class="Normal">&nbsp; $request_type = (getenv('HTTPS') == 'on') ? 'SSL' : 'NONSSL';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">42</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">44</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">43</td>
<td class="Normal">// set php_self in the local scope</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">45</td>
<td class="Normal">// set php_self in the local scope</td>
</tr>
<tr class="secEnd">
<td class="LineNum">44</td>
<td class="Normal">&nbsp; if (!isset($PHP_SELF)) $PHP_SELF = $HTTP_SERVER_VARS['PHP_SELF'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">46</td>
<td class="Normal">&nbsp; if (!isset($PHP_SELF)) $PHP_SELF = $HTTP_SERVER_VARS['PHP_SELF'];</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">122</td>
<td class="Normal">// include shopping cart class</td>
<td class="AlignCenter">=</td>
<td class="LineNum">124</td>
<td class="Normal">// include shopping cart class</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">123</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'shopping_cart.php');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">125</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'shopping_cart.php');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">124</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">126</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">125</td>
<td class="Normal">// include navigation history class</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">127</td>
<td class="Normal">// include navigation history class</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">126</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'navigation_history.php');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">128</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'navigation_history.php');</td>
</tr>
<tr class="secEnd">
<td class="LineNum">127</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">129</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">128</td>
<td class="HasOrphan"><span class="ttSigDiff">// some code to solve compatibility issues</span></td>
<td class="AlignCenter">+-</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">129</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; require(DIR_WS_FUNCTIONS . 'compatibility.php');</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">130</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">131</td>
<td class="Normal">// check if sessions are supported, otherwise use the php3 compatible session class</td>
<td class="AlignCenter">=</td>
<td class="LineNum">130</td>
<td class="Normal">// check if sessions are supported, otherwise use the php3 compatible session class</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">132</td>
<td class="Normal">&nbsp; if (!function_exists('session_start')) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">131</td>
<td class="Normal">&nbsp; if (!function_exists('session_start')) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">133</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; define('PHP_SESSION_NAME', 'osCsid');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">132</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; define('PHP_SESSION_NAME', 'osCsid');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">134</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; define('PHP_SESSION_PATH', $cookie_path);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">133</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; define('PHP_SESSION_PATH', $cookie_path);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">135</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; define('PHP_SESSION_DOMAIN', $cookie_domain);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">134</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; define('PHP_SESSION_DOMAIN', $cookie_domain);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">136</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; define('PHP_SESSION_SAVE_PATH', SESSION_WRITE_DIRECTORY);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">135</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; define('PHP_SESSION_SAVE_PATH', SESSION_WRITE_DIRECTORY);</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">191</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_session_start();</td>
<td class="AlignCenter">=</td>
<td class="LineNum">190</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_session_start();</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">192</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $session_started = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">191</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $session_started = true;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">193</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">192</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">194</td>
<td class="Normal">&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">193</td>
<td class="Normal">&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">195</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; tep_session_start();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">194</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; tep_session_start();</td>
</tr>
<tr class="secEnd">
<td class="LineNum">196</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $session_started = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">195</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $session_started = true;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">196</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">197</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">198</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; if ( ($session_started == true) &amp;&amp; (PHP_VERSION &gt;= 4.3) &amp;&amp; function_exists('ini_get') &amp;&amp; (ini_get('register_globals') == false) ) {</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">199</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; extract($_SESSION, EXTR_OVERWRITE+EXTR_REFS);</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">197</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">200</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">198</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">201</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">199</td>
<td class="Normal">// set SID once, even if empty</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">202</td>
<td class="Normal">// set SID once, even if empty</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">200</td>
<td class="Normal">&nbsp; $SID = (defined('SID') ? SID : '');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">203</td>
<td class="Normal">&nbsp; $SID = (defined('SID') ? SID : '');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">201</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">204</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">202</td>
<td class="Normal">// verify the ssl_session_id if the feature is enabled</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">205</td>
<td class="Normal">// verify the ssl_session_id if the feature is enabled</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/functions/compatibility.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">2</td>
<td class="Normal">/*</td>
<td class="AlignCenter">=</td>
<td class="LineNum">2</td>
<td class="Normal">/*</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">3</td>
<td class="Normal">&nbsp; $Id$</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">3</td>
<td class="Normal">&nbsp; $Id$</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">4</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">4</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">5</td>
<td class="Normal">&nbsp; osCommerce, Open Source E-Commerce Solutions</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">5</td>
<td class="Normal">&nbsp; osCommerce, Open Source E-Commerce Solutions</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">6</td>
<td class="Normal">&nbsp; http://www.oscommerce.com</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">6</td>
<td class="Normal">&nbsp; http://www.oscommerce.com</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">7</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">7</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">8</td>
<td class="Normal">&nbsp; Copyright (c) 2006 osCommerce</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">8</td>
<td class="Normal">&nbsp; Copyright (c) 2007 osCommerce</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">9</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">9</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">10</td>
<td class="Normal">&nbsp; Released under the GNU General Public License</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">10</td>
<td class="Normal">&nbsp; Released under the GNU General Public License</td>
</tr>
<tr class="secBegin">
<td class="LineNum">11</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">+-</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">12</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; Modified by Marco Canini, &lt;m.canini@libero.it&gt;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">13</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; - Fixed a bug with arrays in $HTTP_xxx_VARS</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">14</td>
<td class="Normal">*/</td>
<td class="AlignCenter">=</td>
<td class="LineNum">11</td>
<td class="Normal">*/</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">15</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">12</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">16</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">13</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">17</td>
<td class="Normal">// Recursively handle magic_quotes_gpc turned off.</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">14</td>
<td class="Normal">// Recursively handle magic_quotes_gpc turned off.</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">18</td>
<td class="Normal">// This is due to the possibility of have an array in</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">15</td>
<td class="Normal">// This is due to the possibility of have an array in</td>
</tr>
<tr class="secEnd">
<td class="LineNum">19</td>
<td class="Normal">// $HTTP_xxx_VARS</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">16</td>
<td class="Normal">// $HTTP_xxx_VARS</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">27</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">24</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">28</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ar[$key] = addslashes($value);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">25</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ar[$key] = addslashes($value);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">29</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">30</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">27</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">31</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">28</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">32</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">29</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">33</td>
<td class="HasMismatch"><span class="ttSigDiff">/</span><span class="ttSigDiff">/</span> <span class="ttSigDiff">$HTT</span>P<span class="ttSigDiff">_x</span><span class="ttSigDiff">xx</span>_V<span class="ttSigDiff">A</span>RS<span class="ttSigDiff"> are always</span> <span class="ttSigDiff">s</span><span class="ttSigDiff">et on php4</span></td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">30</td>
<td class="HasMismatch"><span class="ttSigDiff">&nbsp;</span> <span class="ttSigDiff">if (</span>P<span class="ttSigDiff">HP</span>_V<span class="ttSigDiff">E</span>RS<span class="ttSigDiff">ION &gt;= 4.1)</span> <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">31</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $HTTP_GET_VARS =&amp; $_GET;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">32</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $HTTP_POST_VARS =&amp; $_POST;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">33</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $HTTP_COOKIE_VARS =&amp; $_COOKIE;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">34</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $HTTP_SESSION_VARS =&amp; $_SESSION;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">35</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $HTTP_POST_FILES =&amp; $_FILES;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">36</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $HTTP_SERVER_VARS =&amp; $_SERVER;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">37</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; } else {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">34</td>
<td class="HasMismatch">&nbsp; if (!is_array($HTTP_GET_VARS)) $HTTP_GET_VARS = array();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">38</td>
<td class="HasMismatch">&nbsp; <span class="ttSigDiff">&nbsp; </span>if (!is_array($HTTP_GET_VARS)) $HTTP_GET_VARS = array();</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">35</td>
<td class="HasMismatch">&nbsp; if (!is_array($HTTP_POST_VARS)) $HTTP_POST_VARS = array();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">39</td>
<td class="HasMismatch">&nbsp; <span class="ttSigDiff">&nbsp; </span>if (!is_array($HTTP_POST_VARS)) $HTTP_POST_VARS = array();</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">36</td>
<td class="HasMismatch">&nbsp; if (!is_array($HTTP_COOKIE_VARS)) $HTTP_COOKIE_VARS = array();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">40</td>
<td class="HasMismatch">&nbsp; <span class="ttSigDiff">&nbsp; </span>if (!is_array($HTTP_COOKIE_VARS)) $HTTP_COOKIE_VARS = array();</td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">41</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">37</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">42</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">38</td>
<td class="Normal">// handle magic_quotes_gpc turned off.</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">43</td>
<td class="Normal">// handle magic_quotes_gpc turned off.</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">39</td>
<td class="Normal">&nbsp; if (!get_magic_quotes_gpc()) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">44</td>
<td class="Normal">&nbsp; if (!get_magic_quotes_gpc()) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">40</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($HTTP_GET_VARS);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">45</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($HTTP_GET_VARS);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">41</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($HTTP_POST_VARS);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">46</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($HTTP_POST_VARS);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">42</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($HTTP_COOKIE_VARS);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">47</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($HTTP_COOKIE_VARS);</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/functions/sessions.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">98</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">98</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">99</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">99</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">100</td>
<td class="Normal">&nbsp; function tep_session_register($variable) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">100</td>
<td class="Normal">&nbsp; function tep_session_register($variable) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">101</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; global $session_started;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">101</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; global $session_started;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">102</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">102</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">103</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if ($session_started == true) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">103</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if ($session_started == true) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">104</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (PHP_VERSION &lt; 4.3) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">104</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return session_register($variable);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">105</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>return session_register($variable);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">105</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">106</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>} else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">107</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $_SESSION[$variable] = (isset($GLOBALS[$variable])) ? $GLOBALS[$variable] : null;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">108</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">109</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $GLOBALS[$variable] =&amp; $_SESSION[$variable];</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">106</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">r</span><span class="ttSigDiff">eturn false;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">110</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">107</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">111</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">112</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">113</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; return false;</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">108</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">114</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">109</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">115</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">110</td>
<td class="Normal">&nbsp; function tep_session_is_registered($variable) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">116</td>
<td class="Normal">&nbsp; function tep_session_is_registered($variable) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">117</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; if (PHP_VERSION &lt; 4.3) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">111</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; return session_is_registered($variable);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">118</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>return session_is_registered($variable);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">119</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; } else {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">120</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return isset($_SESSION[$variable]);</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">121</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">112</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">122</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">113</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">123</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">114</td>
<td class="Normal">&nbsp; function tep_session_unregister($variable) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">124</td>
<td class="Normal">&nbsp; function tep_session_unregister($variable) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">125</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; if (PHP_VERSION &lt; 4.3) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">115</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; return session_unregister($variable);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">126</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>return session_unregister($variable);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">127</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; } else {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">128</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unset($_SESSION[$variable]);</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">129</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">116</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">130</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">117</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">131</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">118</td>
<td class="Normal">&nbsp; function tep_session_id($sessid = '') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">132</td>
<td class="Normal">&nbsp; function tep_session_id($sessid = '') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">119</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (!empty($sessid)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">133</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (!empty($sessid)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">120</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return session_id($sessid);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">134</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return session_id($sessid);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">121</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">135</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/functions/html_output.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">155</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $form;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">155</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $form;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">156</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">156</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">157</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">157</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">158</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">158</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">159</td>
<td class="Normal">// Output a form input field</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">159</td>
<td class="Normal">// Output a form input field</td>
</tr>
<tr class="secEnd">
<td class="LineNum">160</td>
<td class="Normal">&nbsp; function tep_draw_input_field($name, $value = '', $parameters = '', $type = 'text', $reinsert_value = true) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">160</td>
<td class="Normal">&nbsp; function tep_draw_input_field($name, $value = '', $parameters = '', $type = 'text', $reinsert_value = true) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">161</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $HTTP_POST_VARS;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">162</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">161</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;input type=&quot;' . tep_output_string($type) . '&quot; name=&quot;' . tep_output_string($name) . '&quot;';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">163</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;input type=&quot;' . tep_output_string($type) . '&quot; name=&quot;' . tep_output_string($name) . '&quot;';</td>
</tr>
<tr class="secEnd">
<td class="LineNum">162</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">164</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">163</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if ( (isset($G<span class="ttSigDiff">LOB</span>A<span class="ttSigDiff">L</span>S[$name]<span class="ttSigDiff">)</span>) &amp;&amp; ($<span class="ttSigDiff">r</span>ei<span class="ttSigDiff">n</span>se<span class="ttSigDiff">rt</span>_<span class="ttSigDiff">valu</span>e <span class="ttSigDiff">==</span> tr<span class="ttSigDiff">u</span>e) ) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">165</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if ( (<span class="ttSigDiff">$reinsert_value == true) &amp;&amp; ( (</span>isset($<span class="ttSigDiff">HTTP_</span>G<span class="ttSigDiff">E</span><span class="ttSigDiff">T_V</span>A<span class="ttSigDiff">R</span>S[$name]) &amp;&amp; <span class="ttSigDiff">is_string</span>($<span class="ttSigDiff">HTTP_GET_VARS[$na</span><span class="ttSigDiff">m</span>e<span class="ttSigDiff">])) || (</span>i<span class="ttSigDiff">s</span>se<span class="ttSigDiff">t($HT</span><span class="ttSigDiff">TP</span>_<span class="ttSigDiff">POST_VARS[</span><span class="ttSigDiff">$nam</span>e<span class="ttSigDiff">])</span> <span class="ttSigDiff">&amp;&amp;</span> <span class="ttSigDiff">is_s</span>tr<span class="ttSigDiff">ing($HTTP_POST_VARS[$na</span><span class="ttSigDiff">m</span>e<span class="ttSigDiff">])) </span>) ) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">164</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">$</span>fie<span class="ttSigDiff">ld .= ' value=&quot;' . t</span>e<span class="ttSigDiff">p_output</span>_string(<span class="ttSigDiff">stripsl</span><span class="ttSigDiff">ashes($GLOB</span>A<span class="ttSigDiff">L</span>S[$name])) <span class="ttSigDiff">.</span><span class="ttSigDiff"> '&quot;';</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">166</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">i</span>f<span class="ttSigDiff"> (</span>i<span class="ttSigDiff">ss</span>e<span class="ttSigDiff">t</span><span class="ttSigDiff">($HTTP_GET_VARS[$nam</span>e<span class="ttSigDiff">]) &amp;&amp; is</span>_string(<span class="ttSigDiff">$HTTP_GET_V</span>A<span class="ttSigDiff">R</span>S[$name])) <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">167</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $value = stripslashes($HTTP_GET_VARS[$name]);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">168</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (isset($HTTP_POST_VARS[$name]) &amp;&amp; is_string($HTTP_POST_VARS[$name])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">169</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $value = stripslashes($HTTP_POST_VARS[$name]);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">170</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">171</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">172</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">165</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">} else</span>if (tep_not_null($value)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">173</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (tep_not_null($value)) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">166</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' value=&quot;' . tep_output_string($value) . '&quot;';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">174</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' value=&quot;' . tep_output_string($value) . '&quot;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">167</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">175</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">168</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">176</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">169</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">177</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">170</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">178</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">171</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">179</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">179</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return tep_draw_input_field($name, $value, $parameters, 'password', false);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">187</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return tep_draw_input_field($name, $value, $parameters, 'password', false);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">180</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">188</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">181</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">189</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">182</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">190</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">183</td>
<td class="Normal">// Output a selection field - alias function for tep_draw_checkbox_field() and tep_draw_radio_field()</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">191</td>
<td class="Normal">// Output a selection field - alias function for tep_draw_checkbox_field() and tep_draw_radio_field()</td>
</tr>
<tr class="secEnd">
<td class="LineNum">184</td>
<td class="Normal">&nbsp; function tep_draw_selection_field($name, $type, $value = '', $checked = false, $parameters = '') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">192</td>
<td class="Normal">&nbsp; function tep_draw_selection_field($name, $type, $value = '', $checked = false, $parameters = '') {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">193</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $HTTP_POST_VARS;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">194</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">185</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $selection = '&lt;input type=&quot;' . tep_output_string($type) . '&quot; name=&quot;' . tep_output_string($name) . '&quot;';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">195</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $selection = '&lt;input type=&quot;' . tep_output_string($type) . '&quot; name=&quot;' . tep_output_string($name) . '&quot;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">186</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">196</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">187</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($value)) $selection .= ' value=&quot;' . tep_output_string($value) . '&quot;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">197</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($value)) $selection .= ' value=&quot;' . tep_output_string($value) . '&quot;';</td>
</tr>
<tr class="secEnd">
<td class="LineNum">188</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">198</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">189</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if ( ($checked == true) || (<span class="ttSigDiff"> </span>isset($<span class="ttSigDiff">GLOBAL</span>S[$name]) &amp;&amp; is_string($<span class="ttSigDiff">GLOBAL</span>S[$name]) &amp;&amp; (<span class="ttSigDiff"> </span>($<span class="ttSigDiff">GLOBAL</span>S[$name] == 'on') || (<span class="ttSigDiff">isset(</span>$value<span class="ttSigDiff">) </span>&amp;&amp; <span class="ttSigDiff">(</span>stripslashes($<span class="ttSigDiff">GLOBAL</span>S[$name]) == $value))<span class="ttSigDiff"> ) </span>) ) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">199</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if ( ($checked == true) || (isset($<span class="ttSigDiff">HTTP_</span><span class="ttSigDiff">GET_</span><span class="ttSigDiff">V</span><span class="ttSigDiff">AR</span>S[$name]) &amp;&amp; is_string($<span class="ttSigDiff">HTTP_</span><span class="ttSigDiff">GET_</span><span class="ttSigDiff">V</span><span class="ttSigDiff">AR</span>S[$name]) &amp;&amp; (($<span class="ttSigDiff">HTTP_</span><span class="ttSigDiff">GET_</span><span class="ttSigDiff">V</span><span class="ttSigDiff">AR</span>S[$name] == 'on') || (<span class="ttSigDiff">str</span><span class="ttSigDiff">i</span><span class="ttSigDiff">p</span><span class="ttSigDiff">s</span><span class="ttSigDiff">la</span><span class="ttSigDiff">s</span><span class="ttSigDiff">h</span><span class="ttSigDiff">es(</span><span class="ttSigDiff">$HTTP_GET_VARS[$name]) == </span>$value<span class="ttSigDiff">)</span><span class="ttSigDiff">)</span><span class="ttSigDiff">)</span><span class="ttSigDiff"> </span><span class="ttSigDiff">|| (isset($HTTP_POST_VARS[$name]) &amp;&amp; is_string($HTTP_POST_VARS[$name]) </span>&amp;&amp; <span class="ttSigDiff">(</span><span class="ttSigDiff">(</span><span class="ttSigDiff">$HTTP_POST_VARS[$name] == 'on') || (</span>stripslashes($<span class="ttSigDiff">HT</span><span class="ttSigDiff">TP_P</span><span class="ttSigDiff">OS</span><span class="ttSigDiff">T_V</span><span class="ttSigDiff">AR</span>S[$name]) == $value))) ) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">190</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $selection .= ' CHECKED';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">200</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $selection .= ' CHECKED';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">191</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">201</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">192</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">202</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">193</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $selection .= ' ' . $parameters;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">203</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $selection .= ' ' . $parameters;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">194</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">204</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">195</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $selection .= '&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">205</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $selection .= '&gt;';</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">209</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return tep_draw_selection_field($name, 'radio', $value, $checked, $parameters);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">219</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return tep_draw_selection_field($name, 'radio', $value, $checked, $parameters);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">210</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">220</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">211</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">221</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">212</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">222</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">213</td>
<td class="Normal">// Output a form textarea field</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">223</td>
<td class="Normal">// Output a form textarea field</td>
</tr>
<tr class="secEnd">
<td class="LineNum">214</td>
<td class="Normal">&nbsp; function tep_draw_textarea_field($name, $wrap, $width, $height, $text = '', $parameters = '', $reinsert_value = true) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">224</td>
<td class="Normal">&nbsp; function tep_draw_textarea_field($name, $wrap, $width, $height, $text = '', $parameters = '', $reinsert_value = true) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">225</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $HTTP_POST_VARS;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">226</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">215</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;textarea name=&quot;' . tep_output_string($name) . '&quot; wrap=&quot;' . tep_output_string($wrap) . '&quot; cols=&quot;' . tep_output_string($width) . '&quot; rows=&quot;' . tep_output_string($height) . '&quot;';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">227</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;textarea name=&quot;' . tep_output_string($name) . '&quot; wrap=&quot;' . tep_output_string($wrap) . '&quot; cols=&quot;' . tep_output_string($width) . '&quot; rows=&quot;' . tep_output_string($height) . '&quot;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">216</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">228</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">217</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">229</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">218</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">230</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">219</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">231</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
</tr>
<tr class="secEnd">
<td class="LineNum">220</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">232</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">221</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if ( (isset($G<span class="ttSigDiff">LOB</span>A<span class="ttSigDiff">L</span>S[$name]<span class="ttSigDiff">)</span>) &amp;&amp; ($<span class="ttSigDiff">r</span>ei<span class="ttSigDiff">n</span>se<span class="ttSigDiff">rt</span>_<span class="ttSigDiff">valu</span>e <span class="ttSigDiff">==</span> tr<span class="ttSigDiff">u</span>e) ) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">233</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if ( (<span class="ttSigDiff">$reinsert_value == true) &amp;&amp; ( (</span>isset($<span class="ttSigDiff">HTTP_</span>G<span class="ttSigDiff">E</span><span class="ttSigDiff">T_V</span>A<span class="ttSigDiff">R</span>S[$name]) &amp;&amp; <span class="ttSigDiff">is_string</span>($<span class="ttSigDiff">HTTP_GET_VARS[$na</span><span class="ttSigDiff">m</span>e<span class="ttSigDiff">])) || (</span>i<span class="ttSigDiff">s</span>se<span class="ttSigDiff">t($HT</span><span class="ttSigDiff">TP</span>_<span class="ttSigDiff">POST_VARS[</span><span class="ttSigDiff">$nam</span>e<span class="ttSigDiff">])</span> <span class="ttSigDiff">&amp;&amp;</span> <span class="ttSigDiff">is_s</span>tr<span class="ttSigDiff">ing($HTTP_POST_VARS[$na</span><span class="ttSigDiff">m</span>e<span class="ttSigDiff">])) </span>) ) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">234</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($HTTP_GET_VARS[$name]) &amp;&amp; is_string($HTTP_GET_VARS[$name])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">222</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= tep_output_string_protected(stripslashes($G<span class="ttSigDiff">LOB</span>A<span class="ttSigDiff">L</span>S[$name]));</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">235</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>$field .= tep_output_string_protected(stripslashes($<span class="ttSigDiff">HTTP_</span>G<span class="ttSigDiff">E</span><span class="ttSigDiff">T_V</span>A<span class="ttSigDiff">R</span>S[$name]));</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">236</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (isset($HTTP_POST_VARS[$name]) &amp;&amp; is_string($HTTP_POST_VARS[$name])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">237</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= tep_output_string_protected(stripslashes($HTTP_POST_VARS[$name]));</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">238</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">223</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } elseif (tep_not_null($text)) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">239</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } elseif (tep_not_null($text)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">224</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= tep_output_string_protected($text);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">240</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= tep_output_string_protected($text);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">225</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">241</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">226</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">242</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">227</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&lt;/textarea&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">243</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&lt;/textarea&gt;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">228</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">244</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">229</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $field;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">245</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $field;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">230</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">246</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">231</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">247</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">232</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">248</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">233</td>
<td class="Normal">// Output a form hidden field</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">249</td>
<td class="Normal">// Output a form hidden field</td>
</tr>
<tr class="secEnd">
<td class="LineNum">234</td>
<td class="Normal">&nbsp; function tep_draw_hidden_field($name, $value = '', $parameters = '') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">250</td>
<td class="Normal">&nbsp; function tep_draw_hidden_field($name, $value = '', $parameters = '') {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">251</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $HTTP_POST_VARS;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">252</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">235</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;input type=&quot;hidden&quot; name=&quot;' . tep_output_string($name) . '&quot;';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">253</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;input type=&quot;hidden&quot; name=&quot;' . tep_output_string($name) . '&quot;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">236</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">254</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">237</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($value)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">255</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($value)) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">238</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' value=&quot;' . tep_output_string($value) . '&quot;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">256</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' value=&quot;' . tep_output_string($value) . '&quot;';</td>
</tr>
<tr class="secBegin">
<td class="LineNum">239</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; } elseif (isset($G<span class="ttSigDiff">LOB</span>A<span class="ttSigDiff">L</span>S[$name])) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">257</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; } elseif (<span class="ttSigDiff"> (</span>isset($<span class="ttSigDiff">HTTP_</span>G<span class="ttSigDiff">E</span><span class="ttSigDiff">T_V</span>A<span class="ttSigDiff">R</span>S[$name])<span class="ttSigDiff"> &amp;&amp; is_string($HTTP_GET_VARS[$name])) || (isset($HTTP_POST_VARS[$name]) &amp;&amp; is_string($HTTP_POST_VARS[$name])) </span>) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">258</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( (isset($HTTP_GET_VARS[$name]) &amp;&amp; is_string($HTTP_GET_VARS[$name])) ) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">240</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' value=&quot;' . tep_output_string(stripslashes($G<span class="ttSigDiff">LOB</span>A<span class="ttSigDiff">L</span>S[$name])) . '&quot;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">259</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>$field .= ' value=&quot;' . tep_output_string(stripslashes($<span class="ttSigDiff">HTTP_</span>G<span class="ttSigDiff">E</span><span class="ttSigDiff">T_V</span>A<span class="ttSigDiff">R</span>S[$name])) . '&quot;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">260</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif ( (isset($HTTP_POST_VARS[$name]) &amp;&amp; is_string($HTTP_POST_VARS[$name])) ) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">261</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' value=&quot;' . tep_output_string(stripslashes($HTTP_POST_VARS[$name])) . '&quot;';</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">262</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">241</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">263</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">242</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">264</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">243</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">265</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">244</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">266</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">245</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">267</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
</tr>
<tr class="secEnd">
<td class="LineNum">246</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">268</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">257</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">279</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">258</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">280</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">259</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">281</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">260</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">282</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">261</td>
<td class="Normal">// Output a form pull down menu</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">283</td>
<td class="Normal">// Output a form pull down menu</td>
</tr>
<tr class="secEnd">
<td class="LineNum">262</td>
<td class="Normal">&nbsp; function tep_draw_pull_down_menu($name, $values, $default = '', $parameters = '', $required = false) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">284</td>
<td class="Normal">&nbsp; function tep_draw_pull_down_menu($name, $values, $default = '', $parameters = '', $required = false) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">285</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $HTTP_POST_VARS;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">286</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">263</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;select name=&quot;' . tep_output_string($name) . '&quot;';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">287</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;select name=&quot;' . tep_output_string($name) . '&quot;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">264</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">288</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">265</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">289</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">266</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">290</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">267</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">291</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
</tr>
<tr class="secEnd">
<td class="LineNum">268</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">292</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">269</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (empty($default) &amp;&amp; isset($G<span class="ttSigDiff">LOB</span>A<span class="ttSigDiff">L</span>S[$name])) $<span class="ttSigDiff">d</span>e<span class="ttSigDiff">fault</span> <span class="ttSigDiff">= </span>stri<span class="ttSigDiff">pslashes($GLOB</span>A<span class="ttSigDiff">L</span>S[$name])<span class="ttSigDiff">;</span></td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">293</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (empty($default) &amp;&amp; <span class="ttSigDiff">( (</span>isset($<span class="ttSigDiff">HTTP_</span>G<span class="ttSigDiff">ET_VARS[$name]) &amp;&amp; is_string($HTTP_GE</span><span class="ttSigDiff">T_V</span>A<span class="ttSigDiff">R</span>S[$name])) <span class="ttSigDiff">|| (isset(</span>$<span class="ttSigDiff">HTTP_POST_VARS[$na</span><span class="ttSigDiff">m</span>e<span class="ttSigDiff">]) &amp;&amp;</span> <span class="ttSigDiff">i</span><span class="ttSigDiff">s_</span>stri<span class="ttSigDiff">n</span><span class="ttSigDiff">g($HTTP_POST_V</span>A<span class="ttSigDiff">R</span>S[$name])<span class="ttSigDiff">)</span><span class="ttSigDiff"> ) ) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">294</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($HTTP_GET_VARS[$name]) &amp;&amp; is_string($HTTP_GET_VARS[$name])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">295</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $default = stripslashes($HTTP_GET_VARS[$name]);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">296</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (isset($HTTP_POST_VARS[$name]) &amp;&amp; is_string($HTTP_POST_VARS[$name])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">297</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $default = stripslashes($HTTP_POST_VARS[$name]);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">298</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">299</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">270</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">300</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">271</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($values); $i&lt;$n; $i++) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">301</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($values); $i&lt;$n; $i++) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">272</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= '&lt;option value=&quot;' . tep_output_string($values[$i]['id']) . '&quot;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">302</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= '&lt;option value=&quot;' . tep_output_string($values[$i]['id']) . '&quot;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">273</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($default == $values[$i]['id']) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">303</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($default == $values[$i]['id']) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">274</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' SELECTED';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">304</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' SELECTED';</td>
</tr>
<tr class="secEnd">
<td class="LineNum">275</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">305</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/classes/order.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">128</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">128</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">129</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $index++;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">129</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $index++;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">130</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">130</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">131</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">131</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">132</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">132</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">133</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function cart() {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">133</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function cart() {</td>
</tr>
<tr class="secAll">
<td class="LineNum">134</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $customer_id, $sendto, $billto, $cart, $languages_id, $currency, $currencies, $shipping, $payment;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">134</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $<span class="ttSigDiff">HTTP_POST_VARS, $</span>customer_id, $sendto, $billto, $cart, $languages_id, $currency, $currencies, $shipping, $payment<span class="ttSigDiff">, $comments</span>;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">135</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">135</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">136</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;content_type = $cart-&gt;get_content_type();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">136</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;content_type = $cart-&gt;get_content_type();</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">137</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">137</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">138</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_address_query = tep_db_query(&quot;select c.customers_firstname, c.customers_lastname, c.customers_telephone, c.customers_email_address, ab.entry_company, ab.entry_street_address, ab.entry_suburb, ab.entry_postcode, ab.entry_city, ab.entry_zone_id, z.zone_name, co.countries_id, co.countries_name, co.countries_iso_code_2, co.countries_iso_code_3, co.address_format_id, ab.entry_state from &quot; . TABLE_CUSTOMERS . &quot; c, &quot; . TABLE_ADDRESS_BOOK . &quot; ab left join &quot; . TABLE_ZONES . &quot; z on (ab.entry_zone_id = z.zone_id) left join &quot; . TABLE_COUNTRIES . &quot; co on (ab.entry_country_id = co.countries_id) where c.customers_id = '&quot; . (int)$customer_id . &quot;' and ab.customers_id = '&quot; . (int)$customer_id . &quot;' and c.customers_default_address_id = ab.address_book_id&quot;);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">138</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_address_query = tep_db_query(&quot;select c.customers_firstname, c.customers_lastname, c.customers_telephone, c.customers_email_address, ab.entry_company, ab.entry_street_address, ab.entry_suburb, ab.entry_postcode, ab.entry_city, ab.entry_zone_id, z.zone_name, co.countries_id, co.countries_name, co.countries_iso_code_2, co.countries_iso_code_3, co.address_format_id, ab.entry_state from &quot; . TABLE_CUSTOMERS . &quot; c, &quot; . TABLE_ADDRESS_BOOK . &quot; ab left join &quot; . TABLE_ZONES . &quot; z on (ab.entry_zone_id = z.zone_id) left join &quot; . TABLE_COUNTRIES . &quot; co on (ab.entry_country_id = co.countries_id) where c.customers_id = '&quot; . (int)$customer_id . &quot;' and ab.customers_id = '&quot; . (int)$customer_id . &quot;' and c.customers_default_address_id = ab.address_book_id&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">139</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_address = tep_db_fetch_array($customer_address_query);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">139</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_address = tep_db_fetch_array($customer_address_query);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">140</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">140</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">148</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tax_address = tep_db_fetch_array($tax_address_query);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">148</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tax_address = tep_db_fetch_array($tax_address_query);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">149</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">149</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">150</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info = array('order_status' =&gt; DEFAULT_ORDERS_STATUS_ID,</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">150</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info = array('order_status' =&gt; DEFAULT_ORDERS_STATUS_ID,</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">151</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'currency' =&gt; $currency,</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">151</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'currency' =&gt; $currency,</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">152</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'currency_value' =&gt; $currencies-&gt;currencies[$currency]['value'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">152</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'currency_value' =&gt; $currencies-&gt;currencies[$currency]['value'],</td>
</tr>
<tr class="secEnd">
<td class="LineNum">153</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'payment_method' =&gt; $payment,</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">153</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'payment_method' =&gt; $payment,</td>
</tr>
<tr class="secBegin">
<td class="LineNum">154</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'cc_type' =&gt; (isset($<span class="ttSigDiff">GL</span>O<span class="ttSigDiff">B</span>A<span class="ttSigDiff">L</span>S['cc_type']) ? $<span class="ttSigDiff">GL</span>O<span class="ttSigDiff">B</span>A<span class="ttSigDiff">L</span>S['cc_type'] : ''),</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">154</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'cc_type' =&gt; (isset($<span class="ttSigDiff">HTTP</span><span class="ttSigDiff">_P</span>O<span class="ttSigDiff">ST_</span><span class="ttSigDiff">V</span>A<span class="ttSigDiff">R</span>S['cc_type']) ? $<span class="ttSigDiff">HTTP</span><span class="ttSigDiff">_P</span>O<span class="ttSigDiff">ST_</span><span class="ttSigDiff">V</span>A<span class="ttSigDiff">R</span>S['cc_type'] : ''),</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">155</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'cc_owner' =&gt; (isset($<span class="ttSigDiff">GL</span>O<span class="ttSigDiff">B</span>A<span class="ttSigDiff">L</span>S['cc_owner']) ? $<span class="ttSigDiff">GL</span>O<span class="ttSigDiff">B</span>A<span class="ttSigDiff">L</span>S['cc_owner'] : ''),</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">155</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'cc_owner' =&gt; (isset($<span class="ttSigDiff">HTTP</span><span class="ttSigDiff">_P</span>O<span class="ttSigDiff">ST_</span><span class="ttSigDiff">V</span>A<span class="ttSigDiff">R</span>S['cc_owner']) ? $<span class="ttSigDiff">HTTP</span><span class="ttSigDiff">_P</span>O<span class="ttSigDiff">ST_</span><span class="ttSigDiff">V</span>A<span class="ttSigDiff">R</span>S['cc_owner'] : ''),</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">156</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'cc_number' =&gt; (isset($<span class="ttSigDiff">GL</span>O<span class="ttSigDiff">B</span>A<span class="ttSigDiff">L</span>S['cc_number']) ? $<span class="ttSigDiff">GL</span>O<span class="ttSigDiff">B</span>A<span class="ttSigDiff">L</span>S['cc_number'] : ''),</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">156</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'cc_number' =&gt; (isset($<span class="ttSigDiff">HTTP</span><span class="ttSigDiff">_P</span>O<span class="ttSigDiff">ST_</span><span class="ttSigDiff">V</span>A<span class="ttSigDiff">R</span>S['cc_number']) ? $<span class="ttSigDiff">HTTP</span><span class="ttSigDiff">_P</span>O<span class="ttSigDiff">ST_</span><span class="ttSigDiff">V</span>A<span class="ttSigDiff">R</span>S['cc_number'] : ''),</td>
</tr>
<tr class="secEnd">
<td class="LineNum">157</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'cc_expires' =&gt; (isset($<span class="ttSigDiff">GL</span>O<span class="ttSigDiff">B</span>A<span class="ttSigDiff">L</span>S['cc_expires']) ? $<span class="ttSigDiff">GL</span>O<span class="ttSigDiff">B</span>A<span class="ttSigDiff">L</span>S['cc_expires'] : ''),</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">157</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'cc_expires' =&gt; (isset($<span class="ttSigDiff">HTTP</span><span class="ttSigDiff">_P</span>O<span class="ttSigDiff">ST_</span><span class="ttSigDiff">V</span>A<span class="ttSigDiff">R</span>S['cc_expires']) ? $<span class="ttSigDiff">HTTP</span><span class="ttSigDiff">_P</span>O<span class="ttSigDiff">ST_</span><span class="ttSigDiff">V</span>A<span class="ttSigDiff">R</span>S['cc_expires'] : ''),</td>
</tr>
<tr class="secBegin">
<td class="LineNum">158</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'shipping_method' =&gt; $shipping['title'],</td>
<td class="AlignCenter">=</td>
<td class="LineNum">158</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'shipping_method' =&gt; $shipping['title'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">159</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'shipping_cost' =&gt; $shipping['cost'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">159</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'shipping_cost' =&gt; $shipping['cost'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">160</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'subtotal' =&gt; 0,</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">160</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'subtotal' =&gt; 0,</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">161</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'tax' =&gt; 0,</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">161</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'tax' =&gt; 0,</td>
</tr>
<tr class="secEnd">
<td class="LineNum">162</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'tax_groups' =&gt; array(),</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">162</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'tax_groups' =&gt; array(),</td>
</tr>
<tr class="secAll">
<td class="LineNum">163</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'comments' =&gt; (<span class="ttSigDiff">is</span>se<span class="ttSigDiff">t($GLOBALS[</span>'comments'<span class="ttSigDiff">]</span>) <span class="ttSigDiff">?</span> $<span class="ttSigDiff">GLOBALS['</span>comments<span class="ttSigDiff">']</span> : ''));</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">163</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'comments' =&gt; (<span class="ttSigDiff">te</span><span class="ttSigDiff">p_</span>se<span class="ttSigDiff">ssion_is_</span><span class="ttSigDiff">registered(</span>'comments') <span class="ttSigDiff">&amp;</span><span class="ttSigDiff">&amp;</span> <span class="ttSigDiff">!empty(</span>$<span class="ttSigDiff">comm</span><span class="ttSigDiff">ents) ? $</span>comments : ''));</td>
</tr>
<tr class="secBegin">
<td class="LineNum">164</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">164</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">165</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($GLOBALS[$payment]) &amp;&amp; is_object($GLOBALS[$payment])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">165</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($GLOBALS[$payment]) &amp;&amp; is_object($GLOBALS[$payment])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">166</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info['payment_method'] = $GLOBALS[$payment]-&gt;title;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">166</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info['payment_method'] = $GLOBALS[$payment]-&gt;title;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">167</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">167</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">168</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( isset($GLOBALS[$payment]-&gt;order_status) &amp;&amp; is_numeric($GLOBALS[$payment]-&gt;order_status) &amp;&amp; ($GLOBALS[$payment]-&gt;order_status &gt; 0) ) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">168</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( isset($GLOBALS[$payment]-&gt;order_status) &amp;&amp; is_numeric($GLOBALS[$payment]-&gt;order_status) &amp;&amp; ($GLOBALS[$payment]-&gt;order_status &gt; 0) ) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">169</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info['order_status'] = $GLOBALS[$payment]-&gt;order_status;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">169</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info['order_status'] = $GLOBALS[$payment]-&gt;order_status;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/modules/address_book_details.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">24</td>
<td class="Normal">&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">24</td>
<td class="Normal">&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">25</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;2&quot; class=&quot;infoBox&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">25</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;2&quot; class=&quot;infoBox&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr class=&quot;infoBoxContents&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr class=&quot;infoBoxContents&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">27</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; cellspacing=&quot;2&quot; cellpadding=&quot;2&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">27</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; cellspacing=&quot;2&quot; cellpadding=&quot;2&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">28</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">28</td>
<td class="Normal">&lt;?php</td>
</tr>
<tr class="secEnd">
<td class="LineNum">29</td>
<td class="Normal">&nbsp; if (ACCOUNT_GENDER == 'true') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">29</td>
<td class="Normal">&nbsp; if (ACCOUNT_GENDER == 'true') {</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">30</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $male = $female = false;</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">30</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (isset($gender)) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">31</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (isset($gender)) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">31</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $male = ($gender == 'm') ? true : false;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">32</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $male = ($gender == 'm') ? true : false;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">32</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">}</span> e<span class="ttSigDiff">ls</span>e <span class="ttSigDiff">{</span></td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">33</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;<span class="ttSigDiff">&nbsp;</span> <span class="ttSigDiff">$f</span>e<span class="ttSigDiff">m</span><span class="ttSigDiff">al</span>e <span class="ttSigDiff">=</span><span class="ttSigDiff"> !$male;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">34</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; } elseif (isset($entry['entry_gender'])) {</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">33</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $male = ($entry['entry_gender'] == 'm') ? true : false;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">35</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $male = ($entry['entry_gender'] == 'm') ? true : false;</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">36</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $female = !$male;</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">34</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">37</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secAll">
<td class="LineNum">35</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $female = !$male;</span></td>
<td class="AlignCenter">+-</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">36</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">38</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">37</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">39</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">38</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;?php echo ENTRY_GENDER; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">40</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;?php echo ENTRY_GENDER; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">39</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;?php echo tep_draw_radio_field('gender', 'm', $male) . '&amp;nbsp;&amp;nbsp;' . MALE . '&amp;nbsp;&amp;nbsp;' . tep_draw_radio_field('gender', 'f', $female) . '&amp;nbsp;&amp;nbsp;' . FEMALE . '&amp;nbsp;' . (tep_not_null(ENTRY_GENDER_TEXT) ? '&lt;span class=&quot;inputRequirement&quot;&gt;' . ENTRY_GENDER_TEXT . '&lt;/span&gt;': ''); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">41</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;?php echo tep_draw_radio_field('gender', 'm', $male) . '&amp;nbsp;&amp;nbsp;' . MALE . '&amp;nbsp;&amp;nbsp;' . tep_draw_radio_field('gender', 'f', $female) . '&amp;nbsp;&amp;nbsp;' . FEMALE . '&amp;nbsp;' . (tep_not_null(ENTRY_GENDER_TEXT) ? '&lt;span class=&quot;inputRequirement&quot;&gt;' . ENTRY_GENDER_TEXT . '&lt;/span&gt;': ''); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">40</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">42</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">41</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">43</td>
<td class="Normal">&lt;?php</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/checkout_payment.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">62</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">62</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">63</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">63</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">64</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'order.php');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">64</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'order.php');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">65</td>
<td class="Normal">&nbsp; $order = new order;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">65</td>
<td class="Normal">&nbsp; $order = new order;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">66</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">66</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">67</td>
<td class="Normal">&nbsp; if (!tep_session_is_registered('comments')) tep_session_register('comments');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">67</td>
<td class="Normal">&nbsp; if (!tep_session_is_registered('comments')) tep_session_register('comments');</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">68</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; if (isset($HTTP_POST_VARS['comments']) &amp;&amp; tep_not_null($HTTP_POST_VARS['comments'])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">69</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $comments = tep_db_prepare_input($HTTP_POST_VARS['comments']);</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">70</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">68</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">71</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">69</td>
<td class="Normal">&nbsp; $total_weight = $cart-&gt;show_weight();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">72</td>
<td class="Normal">&nbsp; $total_weight = $cart-&gt;show_weight();</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">70</td>
<td class="Normal">&nbsp; $total_count = $cart-&gt;count_contents();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">73</td>
<td class="Normal">&nbsp; $total_count = $cart-&gt;count_contents();</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">71</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">74</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">72</td>
<td class="Normal">// load all enabled payment modules</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">75</td>
<td class="Normal">// load all enabled payment modules</td>
</tr>
<tr class="secEnd">
<td class="LineNum">73</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'payment.php');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">76</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'payment.php');</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">319</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">322</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">320</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">323</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">321</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;2&quot; class=&quot;infoBox&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">324</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;2&quot; class=&quot;infoBox&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">322</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr class=&quot;infoBoxContents&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">325</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr class=&quot;infoBoxContents&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">323</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">326</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">324</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">327</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secAll">
<td class="LineNum">325</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;?php echo tep_draw_textarea_field('comments', 'soft', '60', '5'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">328</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;?php echo tep_draw_textarea_field('comments', 'soft', '60', '5'<span class="ttSigDiff">, $comments</span>); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">326</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">329</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">327</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">330</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">328</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">331</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">329</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">332</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">330</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">333</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">331</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">334</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/application_top.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">13</td>
<td class="Normal">// Start the clock for the page parse time log</td>
<td class="AlignCenter">=</td>
<td class="LineNum">13</td>
<td class="Normal">// Start the clock for the page parse time log</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">14</td>
<td class="Normal">&nbsp; define('PAGE_PARSE_START_TIME', microtime());</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">14</td>
<td class="Normal">&nbsp; define('PAGE_PARSE_START_TIME', microtime());</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">15</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">15</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">16</td>
<td class="Normal">// Set the level of error reporting</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">16</td>
<td class="Normal">// Set the level of error reporting</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">17</td>
<td class="Normal">&nbsp; error_reporting(E_ALL &amp; ~E_NOTICE);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">17</td>
<td class="Normal">&nbsp; error_reporting(E_ALL &amp; ~E_NOTICE);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">18</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">18</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">19</td>
<td class="HasMismatch">// <span class="ttSigDiff">C</span>heck <span class="ttSigDiff">i</span>f register_globals<span class="ttSigDiff"> is enabled.</span></td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">19</td>
<td class="HasMismatch">// <span class="ttSigDiff">c</span>heck <span class="ttSigDiff">support</span><span class="ttSigDiff"> </span>f<span class="ttSigDiff">or</span> register_globals</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">20</td>
<td class="HasMismatch"><span class="ttSigDiff">//</span> <span class="ttSigDiff">S</span>inc<span class="ttSigDiff">e this </span>is<span class="ttSigDiff"> a </span>t<span class="ttSigDiff">e</span><span class="ttSigDiff">mporary measure</span> <span class="ttSigDiff">this m</span>e<span class="ttSigDiff">ssag</span>e<span class="ttSigDiff"> </span>is<span class="ttSigDiff"> </span><span class="ttSigDiff">ha</span>r<span class="ttSigDiff">dcoded. The requir</span>e<span class="ttSigDiff">ment wil</span><span class="ttSigDiff">l</span> <span class="ttSigDiff">be</span> <span class="ttSigDiff">removed before</span> <span class="ttSigDiff">2</span>.<span class="ttSigDiff">2 is</span> <span class="ttSigDiff">f</span><span class="ttSigDiff">inalized.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">20</td>
<td class="HasMismatch">&nbsp;<span class="ttSigDiff"> </span>i<span class="ttSigDiff">f (fu</span>nc<span class="ttSigDiff">tion_ex</span>ist<span class="ttSigDiff">s('ini_get') &amp;&amp;</span> <span class="ttSigDiff">(ini_g</span>e<span class="ttSigDiff">t('r</span>e<span class="ttSigDiff">g</span>is<span class="ttSigDiff">te</span>r<span class="ttSigDiff">_globals') == fals</span>e<span class="ttSigDiff">)</span> <span class="ttSigDiff">&amp;&amp;</span> <span class="ttSigDiff">(PHP_VERSION &lt;</span> <span class="ttSigDiff">4</span>.<span class="ttSigDiff">3) )</span> <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">21</td>
<td class="HasMismatch">&nbsp; i<span class="ttSigDiff">f</span> <span class="ttSigDiff">(</span>fu<span class="ttSigDiff">nc</span>tion<span class="ttSigDiff">_ex</span>is<span class="ttSigDiff">ts('</span>ini_g<span class="ttSigDiff">e</span>t<span class="ttSigDiff">'))</span> <span class="ttSigDiff">{</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">21</td>
<td class="HasMismatch">&nbsp; <span class="ttSigDiff">&nbsp; exit('Server Requirement Error: register_globals </span>i<span class="ttSigDiff">s</span> <span class="ttSigDiff">disabled in your PHP co</span><span class="ttSigDiff">n</span>f<span class="ttSigDiff">ig</span>u<span class="ttSigDiff">ra</span>tion<span class="ttSigDiff">.</span><span class="ttSigDiff"> Th</span>is<span class="ttSigDiff"> can be enabled in your </span><span class="ttSigDiff">php.</span>ini<span class="ttSigDiff"> configuration file or in the .htaccess file in your catalog directory. Please use PHP 4.3+ if register</span>_g<span class="ttSigDiff">lobals cann</span><span class="ttSigDiff">o</span>t<span class="ttSigDiff"> be</span> <span class="ttSigDiff">e</span><span class="ttSigDiff">nabled on the server.');</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">22</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; ini_get('register_globals') or exit('Server Requirement Error: register_globals is disabled in your PHP configuration. This can be enabled in your php.ini configuration file or in the .htaccess file in your catalog directory.');</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">23</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">22</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">24</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">23</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">25</td>
<td class="Normal">// Set the local configuration parameters - mainly for developers</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">24</td>
<td class="Normal">// Set the local configuration parameters - mainly for developers</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">26</td>
<td class="Normal">&nbsp; if (file_exists('includes/local/configure.php')) include('includes/local/configure.php');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">25</td>
<td class="Normal">&nbsp; if (file_exists('includes/local/configure.php')) include('includes/local/configure.php');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">27</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">26</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">28</td>
<td class="Normal">// Include application configuration parameters</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">27</td>
<td class="Normal">// Include application configuration parameters</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">29</td>
<td class="Normal">&nbsp; require('includes/configure.php');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">28</td>
<td class="Normal">&nbsp; require('includes/configure.php');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">30</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">29</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">31</td>
<td class="Normal">// Define the project version</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">30</td>
<td class="Normal">// Define the project version</td>
</tr>
<tr class="secEnd">
<td class="LineNum">32</td>
<td class="Normal">&nbsp; define('PROJECT_VERSION', 'osCommerce 2.2-MS2');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">31</td>
<td class="Normal">&nbsp; define('PROJECT_VERSION', 'osCommerce 2.2-MS2');</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">32</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">33</td>
<td class="HasOrphan"><span class="ttSigDiff">// some code to solve compatibility issues</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">34</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; require(DIR_WS_FUNCTIONS . 'compatibility.php');</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">33</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">35</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">34</td>
<td class="Normal">// set php_self in the local scope</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">36</td>
<td class="Normal">// set php_self in the local scope</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">35</td>
<td class="Normal">&nbsp; $PHP_SELF = (isset($HTTP_SERVER_VARS['PHP_SELF']) ? $HTTP_SERVER_VARS['PHP_SELF'] : $HTTP_SERVER_VARS['SCRIPT_NAME']);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">37</td>
<td class="Normal">&nbsp; $PHP_SELF = (isset($HTTP_SERVER_VARS['PHP_SELF']) ? $HTTP_SERVER_VARS['PHP_SELF'] : $HTTP_SERVER_VARS['SCRIPT_NAME']);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">36</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">38</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">37</td>
<td class="Normal">// Used in the &quot;Backup Manager&quot; to compress backups</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">39</td>
<td class="Normal">// Used in the &quot;Backup Manager&quot; to compress backups</td>
</tr>
<tr class="secEnd">
<td class="LineNum">38</td>
<td class="Normal">&nbsp; define('LOCAL_EXE_GZIP', '/usr/bin/gzip');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">40</td>
<td class="Normal">&nbsp; define('LOCAL_EXE_GZIP', '/usr/bin/gzip');</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">73</td>
<td class="Normal">// initialize the logger class</td>
<td class="AlignCenter">=</td>
<td class="LineNum">75</td>
<td class="Normal">// initialize the logger class</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">74</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'logger.php');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">76</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'logger.php');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">75</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">77</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">76</td>
<td class="Normal">// include shopping cart class</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">78</td>
<td class="Normal">// include shopping cart class</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">77</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'shopping_cart.php');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">79</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'shopping_cart.php');</td>
</tr>
<tr class="secEnd">
<td class="LineNum">78</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">80</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">79</td>
<td class="HasOrphan"><span class="ttSigDiff">// some code to solve compatibility issues</span></td>
<td class="AlignCenter">+-</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">80</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; require(DIR_WS_FUNCTIONS . 'compatibility.php');</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">81</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">82</td>
<td class="Normal">// check to see if php implemented session management functions - if not, include php3/php4 compatible session class</td>
<td class="AlignCenter">=</td>
<td class="LineNum">81</td>
<td class="Normal">// check to see if php implemented session management functions - if not, include php3/php4 compatible session class</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">83</td>
<td class="Normal">&nbsp; if (!function_exists('session_start')) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">82</td>
<td class="Normal">&nbsp; if (!function_exists('session_start')) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">84</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; define('PHP_SESSION_NAME', 'osCAdminID');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">83</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; define('PHP_SESSION_NAME', 'osCAdminID');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">85</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; define('PHP_SESSION_PATH', '/');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">84</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; define('PHP_SESSION_PATH', '/');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">86</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; define('PHP_SESSION_SAVE_PATH', SESSION_WRITE_DIRECTORY);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">85</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; define('PHP_SESSION_SAVE_PATH', SESSION_WRITE_DIRECTORY);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">87</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">86</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">102</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; ini_set('session.cookie_lifetime', '0');</td>
<td class="AlignCenter">=</td>
<td class="LineNum">101</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; ini_set('session.cookie_lifetime', '0');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">103</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; ini_set('session.cookie_path', DIR_WS_ADMIN);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">102</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; ini_set('session.cookie_path', DIR_WS_ADMIN);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">104</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">103</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">105</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">104</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">106</td>
<td class="Normal">// lets start our session</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">105</td>
<td class="Normal">// lets start our session</td>
</tr>
<tr class="secEnd">
<td class="LineNum">107</td>
<td class="Normal">&nbsp; tep_session_start();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">106</td>
<td class="Normal">&nbsp; tep_session_start();</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">107</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">108</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; if ( (PHP_VERSION &gt;= 4.3) &amp;&amp; function_exists('ini_get') &amp;&amp; (ini_get('register_globals') == false) ) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">109</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; extract($_SESSION, EXTR_OVERWRITE+EXTR_REFS);</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">110</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">108</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">111</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">109</td>
<td class="Normal">// set the language</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">112</td>
<td class="Normal">// set the language</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">110</td>
<td class="Normal">&nbsp; if (!tep_session_is_registered('language') || isset($HTTP_GET_VARS['language'])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">113</td>
<td class="Normal">&nbsp; if (!tep_session_is_registered('language') || isset($HTTP_GET_VARS['language'])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">111</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (!tep_session_is_registered('language')) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">114</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (!tep_session_is_registered('language')) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">112</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_session_register('language');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">115</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_session_register('language');</td>
</tr>
<tr class="secEnd">
<td class="LineNum">113</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_session_register('languages_id');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">116</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_session_register('languages_id');</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/functions/compatibility.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">24</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">24</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">25</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ar[$key] = addslashes($value);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">25</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ar[$key] = addslashes($value);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">27</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">27</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">28</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">28</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">29</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">29</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">30</td>
<td class="HasMismatch"><span class="ttSigDiff">/</span><span class="ttSigDiff">/</span> <span class="ttSigDiff">$HTT</span>P<span class="ttSigDiff">_x</span><span class="ttSigDiff">xx</span>_V<span class="ttSigDiff">A</span>RS<span class="ttSigDiff"> are always</span> <span class="ttSigDiff">s</span><span class="ttSigDiff">et on php4</span></td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">30</td>
<td class="HasMismatch"><span class="ttSigDiff">&nbsp;</span> <span class="ttSigDiff">if (</span>P<span class="ttSigDiff">HP</span>_V<span class="ttSigDiff">E</span>RS<span class="ttSigDiff">ION &gt;= 4.1)</span> <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">31</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $HTTP_GET_VARS =&amp; $_GET;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">32</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $HTTP_POST_VARS =&amp; $_POST;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">33</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $HTTP_COOKIE_VARS =&amp; $_COOKIE;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">34</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $HTTP_SESSION_VARS =&amp; $_SESSION;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">35</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $HTTP_POST_FILES =&amp; $_FILES;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">36</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $HTTP_SERVER_VARS =&amp; $_SERVER;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">37</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; } else {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">31</td>
<td class="HasMismatch">&nbsp; if (!is_array($HTTP_GET_VARS)) $HTTP_GET_VARS = array();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">38</td>
<td class="HasMismatch">&nbsp; <span class="ttSigDiff">&nbsp; </span>if (!is_array($HTTP_GET_VARS)) $HTTP_GET_VARS = array();</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">32</td>
<td class="HasMismatch">&nbsp; if (!is_array($HTTP_POST_VARS)) $HTTP_POST_VARS = array();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">39</td>
<td class="HasMismatch">&nbsp; <span class="ttSigDiff">&nbsp; </span>if (!is_array($HTTP_POST_VARS)) $HTTP_POST_VARS = array();</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">33</td>
<td class="HasMismatch">&nbsp; if (!is_array($HTTP_COOKIE_VARS)) $HTTP_COOKIE_VARS = array();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">40</td>
<td class="HasMismatch">&nbsp; <span class="ttSigDiff">&nbsp; </span>if (!is_array($HTTP_COOKIE_VARS)) $HTTP_COOKIE_VARS = array();</td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">41</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">34</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">42</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">35</td>
<td class="Normal">// handle magic_quotes_gpc turned off.</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">43</td>
<td class="Normal">// handle magic_quotes_gpc turned off.</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">36</td>
<td class="Normal">&nbsp; if (!get_magic_quotes_gpc()) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">44</td>
<td class="Normal">&nbsp; if (!get_magic_quotes_gpc()) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">37</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($HTTP_GET_VARS);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">45</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($HTTP_GET_VARS);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">38</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($HTTP_POST_VARS);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">46</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($HTTP_POST_VARS);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">39</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($HTTP_COOKIE_VARS);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">47</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($HTTP_COOKIE_VARS);</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/functions/sessions.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">21</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">21</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">22</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function _sess_close() {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">22</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function _sess_close() {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">23</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">23</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">24</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">24</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">25</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">25</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function _sess_read($key) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function _sess_read($key) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">27</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $q<span class="ttSigDiff">id</span> = tep_db_query(&quot;select value from &quot; . TABLE_SESSIONS . &quot; where sesskey = '&quot; . tep_db_input($key) . &quot;' and expiry &gt; '&quot; . time() . &quot;'&quot;);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">27</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $<span class="ttSigDiff">value_</span>q<span class="ttSigDiff">ue</span><span class="ttSigDiff">ry</span> = tep_db_query(&quot;select value from &quot; . TABLE_SESSIONS . &quot; where sesskey = '&quot; . tep_db_input($key) . &quot;' and expiry &gt; '&quot; . time() . &quot;'&quot;);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">28</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $value = tep_db_fetch_array($value_query);</span></td>
</tr>
<tr class="secAll">
<td class="LineNum">28</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">29</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">29</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $value = tep_db_fetch_array($qid);</span></td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">30</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($value['value']) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">30</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (<span class="ttSigDiff">isset(</span>$value['value']<span class="ttSigDiff">)</span>) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">31</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $value['value'];</td>
<td class="AlignCenter">=</td>
<td class="LineNum">31</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $value['value'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">32</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">32</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">33</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">33</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">34</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">34</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">35</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">35</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">36</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">36</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">37</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function _sess_write($key, $val) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">37</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function _sess_write($key, $val) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">38</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $SESS_LIFE;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">38</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $SESS_LIFE;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">39</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">39</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">40</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $expiry = time() + $SESS_LIFE;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">40</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $expiry = time() + $SESS_LIFE;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">41</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $value = $val;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">41</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $value = $val;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">42</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">42</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">43</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $q<span class="ttSigDiff">id</span> = tep_db_query(&quot;select count(*) as total from &quot; . TABLE_SESSIONS . &quot; where sesskey = '&quot; . tep_db_input($key) . &quot;'&quot;);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">43</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $<span class="ttSigDiff">check_</span>q<span class="ttSigDiff">ue</span><span class="ttSigDiff">ry</span> = tep_db_query(&quot;select count(*) as total from &quot; . TABLE_SESSIONS . &quot; where sesskey = '&quot; . tep_db_input($key) . &quot;'&quot;);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">44</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $<span class="ttSigDiff">total</span> = tep_db_fetch_array($q<span class="ttSigDiff">id</span>);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">44</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $<span class="ttSigDiff">check</span> = tep_db_fetch_array($<span class="ttSigDiff">check_</span>q<span class="ttSigDiff">ue</span><span class="ttSigDiff">ry</span>);</td>
</tr>
<tr class="secAll">
<td class="LineNum">45</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">45</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">46</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($<span class="ttSigDiff">total</span>['total'] &gt; 0) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">46</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($<span class="ttSigDiff">check</span>['total'] &gt; 0) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">47</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return tep_db_query(&quot;update &quot; . TABLE_SESSIONS . &quot; set expiry = '&quot; . tep_db_input($expiry) . &quot;', value = '&quot; . tep_db_input($value) . &quot;' where sesskey = '&quot; . tep_db_input($key) . &quot;'&quot;);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">47</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return tep_db_query(&quot;update &quot; . TABLE_SESSIONS . &quot; set expiry = '&quot; . tep_db_input($expiry) . &quot;', value = '&quot; . tep_db_input($value) . &quot;' where sesskey = '&quot; . tep_db_input($key) . &quot;'&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">48</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">48</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">49</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return tep_db_query(&quot;insert into &quot; . TABLE_SESSIONS . &quot; values ('&quot; . tep_db_input($key) . &quot;', '&quot; . tep_db_input($expiry) . &quot;', '&quot; . tep_db_input($value) . &quot;')&quot;);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">49</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return tep_db_query(&quot;insert into &quot; . TABLE_SESSIONS . &quot; values ('&quot; . tep_db_input($key) . &quot;', '&quot; . tep_db_input($expiry) . &quot;', '&quot; . tep_db_input($value) . &quot;')&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">50</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">50</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">51</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">51</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">52</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">52</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">61</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">61</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">62</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">62</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">63</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; session_set_save_handler('_sess_open', '_sess_close', '_sess_read', '_sess_write', '_sess_destroy', '_sess_gc');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">63</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; session_set_save_handler('_sess_open', '_sess_close', '_sess_read', '_sess_write', '_sess_destroy', '_sess_gc');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">64</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">64</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">65</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">65</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">66</td>
<td class="Normal">&nbsp; function tep_session_start() {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">66</td>
<td class="Normal">&nbsp; function tep_session_start() {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">67</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $HTTP_POST_VARS, $HTTP_COOKIE_VARS;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">68</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">69</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $sane_session_id = true;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">70</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">71</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; if (isset($HTTP_GET_VARS[tep_session_name()])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">72</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (preg_match('/^[a-zA-Z0-9]+$/', $HTTP_GET_VARS[tep_session_name()]) == false) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">73</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unset($HTTP_GET_VARS[tep_session_name()]);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">74</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">75</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sane_session_id = false;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">76</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">77</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; } elseif (isset($HTTP_POST_VARS[tep_session_name()])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">78</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (preg_match('/^[a-zA-Z0-9]+$/', $HTTP_POST_VARS[tep_session_name()]) == false) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">79</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unset($HTTP_POST_VARS[tep_session_name()]);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">80</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">81</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sane_session_id = false;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">82</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">83</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; } elseif (isset($HTTP_COOKIE_VARS[tep_session_name()])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">84</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (preg_match('/^[a-zA-Z0-9]+$/', $HTTP_COOKIE_VARS[tep_session_name()]) == false) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">85</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $session_data = session_get_cookie_params();</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">86</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">87</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setcookie(tep_session_name(), '', time()-42000, $session_data['path'], $session_data['domain']);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">88</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">89</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sane_session_id = false;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">90</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">91</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">92</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">93</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; if ($sane_session_id == false) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">94</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_DEFAULT, '', 'NONSSL', false));</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">95</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">96</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">67</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return session_start();</td>
<td class="AlignCenter">=</td>
<td class="LineNum">97</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return session_start();</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">68</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">98</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">69</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">99</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">70</td>
<td class="Normal">&nbsp; function tep_session_register($variable) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">100</td>
<td class="Normal">&nbsp; function tep_session_register($variable) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">101</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; if (PHP_VERSION &lt; 4.3) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">71</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; return session_register($variable);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">102</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>return session_register($variable);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">103</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; } else {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">104</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($GLOBALS[$variable])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">105</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $_SESSION[$variable] =&amp; $GLOBALS[$variable];</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">106</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">107</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $_SESSION[$variable] = null;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">108</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">109</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $GLOBALS[$variable] =&amp; $_SESSION[$variable];</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">110</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">111</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">112</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; return false;</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">72</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">113</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">73</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">114</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">74</td>
<td class="Normal">&nbsp; function tep_session_is_registered($variable) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">115</td>
<td class="Normal">&nbsp; function tep_session_is_registered($variable) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">116</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; if (PHP_VERSION &lt; 4.3) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">75</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; return session_is_registered($variable);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">117</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>return session_is_registered($variable);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">118</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; } else {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">119</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return isset($_SESSION[$variable]);</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">120</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">76</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">121</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">77</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">122</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">78</td>
<td class="Normal">&nbsp; function tep_session_unregister($variable) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">123</td>
<td class="Normal">&nbsp; function tep_session_unregister($variable) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">124</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; if (PHP_VERSION &lt; 4.3) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">79</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; return session_unregister($variable);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">125</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>return session_unregister($variable);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">126</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; } else {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">127</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unset($_SESSION[$variable]);</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">128</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">80</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">129</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">81</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">130</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">82</td>
<td class="Normal">&nbsp; function tep_session_id($sessid = '') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">131</td>
<td class="Normal">&nbsp; function tep_session_id($sessid = '') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">83</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if ($sessid != '') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">132</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if ($sessid != '') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">84</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return session_id($sessid);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">133</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return session_id($sessid);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">85</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">134</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">93</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">142</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">94</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return session_name();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">143</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return session_name();</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">95</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">144</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">96</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">145</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">97</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">146</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">98</td>
<td class="Normal">&nbsp; function tep_session_close() {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">147</td>
<td class="Normal">&nbsp; function tep_session_close() {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">148</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; if (PHP_VERSION &gt;= '4.0.4') {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">149</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return session_write_close();</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">99</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (function_exists('session_close')) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">150</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">} else</span>if (function_exists('session_close')) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">100</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return session_close();</td>
<td class="AlignCenter">=</td>
<td class="LineNum">151</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return session_close();</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">101</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">152</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">102</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">153</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">103</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">154</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">104</td>
<td class="Normal">&nbsp; function tep_session_destroy() {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">155</td>
<td class="Normal">&nbsp; function tep_session_destroy() {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">105</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return session_destroy();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">156</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return session_destroy();</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/functions/html_output.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">167</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $form;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">167</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $form;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">168</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">168</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">169</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">169</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">170</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">170</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">171</td>
<td class="Normal">// Output a form input field</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">171</td>
<td class="Normal">// Output a form input field</td>
</tr>
<tr class="secEnd">
<td class="LineNum">172</td>
<td class="Normal">&nbsp; function tep_draw_input_field($name, $value = '', $parameters = '', $required = false, $type = 'text', $reinsert_value = true) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">172</td>
<td class="Normal">&nbsp; function tep_draw_input_field($name, $value = '', $parameters = '', $required = false, $type = 'text', $reinsert_value = true) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">173</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $HTTP_POST_VARS;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">174</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">173</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;input type=&quot;' . tep_output_string($type) . '&quot; name=&quot;' . tep_output_string($name) . '&quot;';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">175</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;input type=&quot;' . tep_output_string($type) . '&quot; name=&quot;' . tep_output_string($name) . '&quot;';</td>
</tr>
<tr class="secEnd">
<td class="LineNum">174</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">176</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">175</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (isset($G<span class="ttSigDiff">LOB</span>A<span class="ttSigDiff">L</span>S[$name]) &amp;&amp; ($<span class="ttSigDiff">r</span>ei<span class="ttSigDiff">n</span>se<span class="ttSigDiff">rt</span>_<span class="ttSigDiff">value == tru</span>e) &amp;&amp; is_string($<span class="ttSigDiff">GL</span>O<span class="ttSigDiff">B</span>A<span class="ttSigDiff">L</span>S[$name])) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">177</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (<span class="ttSigDiff"> ($reinsert_value == true) &amp;&amp; ( (</span>isset($<span class="ttSigDiff">HTTP_</span>G<span class="ttSigDiff">E</span><span class="ttSigDiff">T_V</span>A<span class="ttSigDiff">R</span>S[$name]) &amp;&amp; <span class="ttSigDiff">is_string</span>($<span class="ttSigDiff">HTTP_GET_VARS[$na</span><span class="ttSigDiff">m</span>e<span class="ttSigDiff">])) || (</span>i<span class="ttSigDiff">s</span>se<span class="ttSigDiff">t($HT</span><span class="ttSigDiff">TP</span>_<span class="ttSigDiff">PO</span><span class="ttSigDiff">ST_VARS[$nam</span>e<span class="ttSigDiff">]</span>) &amp;&amp; is_string($<span class="ttSigDiff">HTTP</span><span class="ttSigDiff">_P</span>O<span class="ttSigDiff">ST_</span><span class="ttSigDiff">V</span>A<span class="ttSigDiff">R</span>S[$name])<span class="ttSigDiff">) ) </span>) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">176</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">$</span>fie<span class="ttSigDiff">ld .= ' value=&quot;' . t</span>e<span class="ttSigDiff">p_output</span>_string(<span class="ttSigDiff">stripsl</span><span class="ttSigDiff">ashes($GLOB</span>A<span class="ttSigDiff">L</span>S[$name])) <span class="ttSigDiff">.</span><span class="ttSigDiff"> '&quot;';</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">178</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">i</span>f<span class="ttSigDiff"> (</span>i<span class="ttSigDiff">ss</span>e<span class="ttSigDiff">t</span><span class="ttSigDiff">($HTTP_GET_VARS[$nam</span>e<span class="ttSigDiff">]) &amp;&amp; is</span>_string(<span class="ttSigDiff">$HTTP_GET_V</span>A<span class="ttSigDiff">R</span>S[$name])) <span class="ttSigDiff">{</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">179</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $value = stripslashes($HTTP_GET_VARS[$name]);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">180</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (isset($HTTP_POST_VARS[$name]) &amp;&amp; is_string($HTTP_POST_VARS[$name])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">181</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $value = stripslashes($HTTP_POST_VARS[$name]);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">182</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">183</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">184</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">177</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">} else</span>if (tep_not_null($value)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">185</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (tep_not_null($value)) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">178</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' value=&quot;' . tep_output_string($value) . '&quot;';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">186</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' value=&quot;' . tep_output_string($value) . '&quot;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">179</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">187</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">180</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">188</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">181</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">189</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">182</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">190</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">183</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">191</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">203</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $field;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">211</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $field;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">204</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">212</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">205</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">213</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">206</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">214</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">207</td>
<td class="Normal">// Output a selection field - alias function for tep_draw_checkbox_field() and tep_draw_radio_field()</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">215</td>
<td class="Normal">// Output a selection field - alias function for tep_draw_checkbox_field() and tep_draw_radio_field()</td>
</tr>
<tr class="secEnd">
<td class="LineNum">208</td>
<td class="Normal">&nbsp; function tep_draw_selection_field($name, $type, $value = '', $checked = false, $compare = '') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">216</td>
<td class="Normal">&nbsp; function tep_draw_selection_field($name, $type, $value = '', $checked = false, $compare = '') {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">217</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $HTTP_POST_VARS;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">218</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">209</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $selection = '&lt;input type=&quot;' . tep_output_string($type) . '&quot; name=&quot;' . tep_output_string($name) . '&quot;';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">219</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $selection = '&lt;input type=&quot;' . tep_output_string($type) . '&quot; name=&quot;' . tep_output_string($name) . '&quot;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">210</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">220</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">211</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($value)) $selection .= ' value=&quot;' . tep_output_string($value) . '&quot;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">221</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($value)) $selection .= ' value=&quot;' . tep_output_string($value) . '&quot;';</td>
</tr>
<tr class="secEnd">
<td class="LineNum">212</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">222</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">213</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if ( ($checked == true) || (isset($<span class="ttSigDiff">GLOBAL</span>S[$name]) &amp;&amp; is_string($<span class="ttSigDiff">GLOBAL</span>S[$name]) &amp;&amp; ($<span class="ttSigDiff">GLOBAL</span>S[$name] == 'on')<span class="ttSigDiff">)</span> || (<span class="ttSigDiff">isset</span>($value) &amp;&amp; is<span class="ttSigDiff">s</span><span class="ttSigDiff">e</span><span class="ttSigDiff">t</span>($<span class="ttSigDiff">GLOBAL</span>S[$name]) &amp;&amp;<span class="ttSigDiff"> </span>(stripslashes($<span class="ttSigDiff">GLOBAL</span>S[$name]) == $value)) || <span class="ttSigDiff">(tep_not_null</span><span class="ttSigDiff">(</span><span class="ttSigDiff">$value) &amp;&amp; </span>tep_not_null($compare) &amp;&amp; ($value == $compare)) ) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">223</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if ( ($checked == true) || (isset($<span class="ttSigDiff">HTTP_</span><span class="ttSigDiff">GET_</span><span class="ttSigDiff">V</span><span class="ttSigDiff">AR</span>S[$name]) &amp;&amp; is_string($<span class="ttSigDiff">HTTP_</span><span class="ttSigDiff">GET_</span><span class="ttSigDiff">V</span><span class="ttSigDiff">AR</span>S[$name]) &amp;&amp; <span class="ttSigDiff">(</span>($<span class="ttSigDiff">HTTP_</span><span class="ttSigDiff">GET_</span><span class="ttSigDiff">V</span><span class="ttSigDiff">AR</span>S[$name] == 'on') || (<span class="ttSigDiff">str</span><span class="ttSigDiff">i</span><span class="ttSigDiff">p</span><span class="ttSigDiff">s</span><span class="ttSigDiff">la</span><span class="ttSigDiff">s</span><span class="ttSigDiff">h</span><span class="ttSigDiff">es</span>($<span class="ttSigDiff">HTTP_GET_VARS[$name]) == $</span>value<span class="ttSigDiff">))</span>) <span class="ttSigDiff">|| (isset($HTTP_POST_VARS[$name]) </span>&amp;&amp; is<span class="ttSigDiff">_</span><span class="ttSigDiff">st</span><span class="ttSigDiff">ring</span>($<span class="ttSigDiff">HT</span><span class="ttSigDiff">TP_P</span><span class="ttSigDiff">OS</span><span class="ttSigDiff">T_V</span><span class="ttSigDiff">AR</span>S[$name]) &amp;&amp;<span class="ttSigDiff"> (($HTTP_POST_VARS[$name] == 'on')</span><span class="ttSigDiff"> </span><span class="ttSigDiff">|| </span>(stripslashes($<span class="ttSigDiff">HT</span><span class="ttSigDiff">TP_P</span><span class="ttSigDiff">OS</span><span class="ttSigDiff">T_V</span><span class="ttSigDiff">AR</span>S[$name]) == $value<span class="ttSigDiff">)</span>)) || <span class="ttSigDiff">(</span>tep_not_null($compare) &amp;&amp; ($value == $compare)) ) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">214</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $selection .= ' CHECKED';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">224</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $selection .= ' CHECKED';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">215</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">225</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">216</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">226</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">217</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $selection .= '&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">227</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $selection .= '&gt;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">218</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">228</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">219</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $selection;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">229</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $selection;</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">231</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return tep_draw_selection_field($name, 'radio', $value, $checked, $compare);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">241</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return tep_draw_selection_field($name, 'radio', $value, $checked, $compare);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">232</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">242</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">233</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">243</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">234</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">244</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">235</td>
<td class="Normal">// Output a form textarea field</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">245</td>
<td class="Normal">// Output a form textarea field</td>
</tr>
<tr class="secEnd">
<td class="LineNum">236</td>
<td class="Normal">&nbsp; function tep_draw_textarea_field($name, $wrap, $width, $height, $text = '', $parameters = '', $reinsert_value = true) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">246</td>
<td class="Normal">&nbsp; function tep_draw_textarea_field($name, $wrap, $width, $height, $text = '', $parameters = '', $reinsert_value = true) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">247</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $HTTP_POST_VARS;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">248</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">237</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;textarea name=&quot;' . tep_output_string($name) . '&quot; wrap=&quot;' . tep_output_string($wrap) . '&quot; cols=&quot;' . tep_output_string($width) . '&quot; rows=&quot;' . tep_output_string($height) . '&quot;';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">249</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;textarea name=&quot;' . tep_output_string($name) . '&quot; wrap=&quot;' . tep_output_string($wrap) . '&quot; cols=&quot;' . tep_output_string($width) . '&quot; rows=&quot;' . tep_output_string($height) . '&quot;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">238</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">250</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">239</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">251</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">240</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">252</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">241</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">253</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
</tr>
<tr class="secEnd">
<td class="LineNum">242</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">254</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">243</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if ( (isset($G<span class="ttSigDiff">LOB</span>A<span class="ttSigDiff">L</span>S[$name]<span class="ttSigDiff">)</span>) &amp;&amp; ($<span class="ttSigDiff">r</span>ei<span class="ttSigDiff">n</span>se<span class="ttSigDiff">rt</span>_<span class="ttSigDiff">valu</span>e <span class="ttSigDiff">==</span> tr<span class="ttSigDiff">u</span>e) ) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">255</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if ( (<span class="ttSigDiff">$reinsert_value == true) &amp;&amp; ( (</span>isset($<span class="ttSigDiff">HTTP_</span>G<span class="ttSigDiff">E</span><span class="ttSigDiff">T_V</span>A<span class="ttSigDiff">R</span>S[$name]) &amp;&amp; <span class="ttSigDiff">is_string</span>($<span class="ttSigDiff">HTTP_GET_VARS[$na</span><span class="ttSigDiff">m</span>e<span class="ttSigDiff">])) || (</span>i<span class="ttSigDiff">s</span>se<span class="ttSigDiff">t($HT</span><span class="ttSigDiff">TP</span>_<span class="ttSigDiff">POST_VARS[</span><span class="ttSigDiff">$nam</span>e<span class="ttSigDiff">])</span> <span class="ttSigDiff">&amp;&amp;</span> <span class="ttSigDiff">is_s</span>tr<span class="ttSigDiff">ing($HTTP_POST_VARS[$na</span><span class="ttSigDiff">m</span>e<span class="ttSigDiff">])) </span>) ) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">256</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($HTTP_GET_VARS[$name]) &amp;&amp; is_string($HTTP_GET_VARS[$name])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">244</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= tep_output_string_protected(stripslashes($G<span class="ttSigDiff">LOB</span>A<span class="ttSigDiff">L</span>S[$name]));</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">257</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>$field .= tep_output_string_protected(stripslashes($<span class="ttSigDiff">HTTP_</span>G<span class="ttSigDiff">E</span><span class="ttSigDiff">T_V</span>A<span class="ttSigDiff">R</span>S[$name]));</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">258</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (isset($HTTP_POST_VARS[$name]) &amp;&amp; is_string($HTTP_POST_VARS[$name])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">259</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= tep_output_string_protected(stripslashes($HTTP_POST_VARS[$name]));</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">260</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">245</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } elseif (tep_not_null($text)) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">261</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } elseif (tep_not_null($text)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">246</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= tep_output_string_protected($text);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">262</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= tep_output_string_protected($text);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">247</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">263</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">248</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">264</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">249</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&lt;/textarea&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">265</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&lt;/textarea&gt;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">250</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">266</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">251</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $field;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">267</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $field;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">252</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">268</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">253</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">269</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">254</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">270</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">255</td>
<td class="Normal">// Output a form hidden field</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">271</td>
<td class="Normal">// Output a form hidden field</td>
</tr>
<tr class="secEnd">
<td class="LineNum">256</td>
<td class="Normal">&nbsp; function tep_draw_hidden_field($name, $value = '', $parameters = '') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">272</td>
<td class="Normal">&nbsp; function tep_draw_hidden_field($name, $value = '', $parameters = '') {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">273</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $HTTP_POST_VARS;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">274</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">257</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;input type=&quot;hidden&quot; name=&quot;' . tep_output_string($name) . '&quot;';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">275</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;input type=&quot;hidden&quot; name=&quot;' . tep_output_string($name) . '&quot;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">258</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">276</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">259</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($value)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">277</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($value)) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">260</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' value=&quot;' . tep_output_string($value) . '&quot;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">278</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' value=&quot;' . tep_output_string($value) . '&quot;';</td>
</tr>
<tr class="secBegin">
<td class="LineNum">261</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; } elseif (isset($G<span class="ttSigDiff">LOB</span>A<span class="ttSigDiff">L</span>S[$name]) &amp;&amp; is_string($G<span class="ttSigDiff">LOB</span>A<span class="ttSigDiff">L</span>S[$name])) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">279</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; } elseif (<span class="ttSigDiff"> (</span>isset($<span class="ttSigDiff">HTTP_</span>G<span class="ttSigDiff">E</span><span class="ttSigDiff">T_V</span>A<span class="ttSigDiff">R</span>S[$name]) &amp;&amp; is_string($<span class="ttSigDiff">HTTP_</span>G<span class="ttSigDiff">E</span><span class="ttSigDiff">T_V</span>A<span class="ttSigDiff">R</span>S[$name])<span class="ttSigDiff">) || (isset($HTTP_POST_VARS[$name]) &amp;&amp; is_string($HTTP_POST_VARS[$name])) </span>) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">280</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( (isset($HTTP_GET_VARS[$name]) &amp;&amp; is_string($HTTP_GET_VARS[$name])) ) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">262</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' value=&quot;' . tep_output_string(stripslashes($G<span class="ttSigDiff">LOB</span>A<span class="ttSigDiff">L</span>S[$name])) . '&quot;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">281</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>$field .= ' value=&quot;' . tep_output_string(stripslashes($<span class="ttSigDiff">HTTP_</span>G<span class="ttSigDiff">E</span><span class="ttSigDiff">T_V</span>A<span class="ttSigDiff">R</span>S[$name])) . '&quot;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">282</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif ( (isset($HTTP_POST_VARS[$name]) &amp;&amp; is_string($HTTP_POST_VARS[$name])) ) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">283</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' value=&quot;' . tep_output_string(stripslashes($HTTP_POST_VARS[$name])) . '&quot;';</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">284</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">263</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">285</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">264</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">286</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">265</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">287</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">266</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">288</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">267</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">289</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">268</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">290</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">269</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $field;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">291</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $field;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">270</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">292</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">271</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">293</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">272</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">294</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">273</td>
<td class="Normal">// Output a form pull down menu</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">295</td>
<td class="Normal">// Output a form pull down menu</td>
</tr>
<tr class="secEnd">
<td class="LineNum">274</td>
<td class="Normal">&nbsp; function tep_draw_pull_down_menu($name, $values, $default = '', $parameters = '', $required = false) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">296</td>
<td class="Normal">&nbsp; function tep_draw_pull_down_menu($name, $values, $default = '', $parameters = '', $required = false) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">297</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $HTTP_POST_VARS;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">298</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">275</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;select name=&quot;' . tep_output_string($name) . '&quot;';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">299</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;select name=&quot;' . tep_output_string($name) . '&quot;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">276</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">300</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">277</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">301</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($parameters)) $field .= ' ' . $parameters;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">278</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">302</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">279</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">303</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
</tr>
<tr class="secEnd">
<td class="LineNum">280</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">304</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">281</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (empty($default) &amp;&amp; isset($G<span class="ttSigDiff">LOB</span>A<span class="ttSigDiff">L</span>S[$name])) $<span class="ttSigDiff">d</span>e<span class="ttSigDiff">fault</span> <span class="ttSigDiff">= </span>stri<span class="ttSigDiff">pslashes($GLOB</span>A<span class="ttSigDiff">L</span>S[$name])<span class="ttSigDiff">;</span></td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">305</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (empty($default) &amp;&amp; <span class="ttSigDiff">( (</span>isset($<span class="ttSigDiff">HTTP_</span>G<span class="ttSigDiff">ET_VARS[$name]) &amp;&amp; is_string($HTTP_GE</span><span class="ttSigDiff">T_V</span>A<span class="ttSigDiff">R</span>S[$name])) <span class="ttSigDiff">|| (isset(</span>$<span class="ttSigDiff">HTTP_POST_VARS[$na</span><span class="ttSigDiff">m</span>e<span class="ttSigDiff">]) &amp;&amp;</span> <span class="ttSigDiff">i</span><span class="ttSigDiff">s_</span>stri<span class="ttSigDiff">n</span><span class="ttSigDiff">g($HTTP_POST_V</span>A<span class="ttSigDiff">R</span>S[$name])<span class="ttSigDiff">)</span><span class="ttSigDiff"> ) ) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">306</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($HTTP_GET_VARS[$name]) &amp;&amp; is_string($HTTP_GET_VARS[$name])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">307</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $default = stripslashes($HTTP_GET_VARS[$name]);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">308</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (isset($HTTP_POST_VARS[$name]) &amp;&amp; is_string($HTTP_POST_VARS[$name])) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">309</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $default = stripslashes($HTTP_POST_VARS[$name]);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">310</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">311</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">282</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">312</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">283</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($values); $i&lt;$n; $i++) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">313</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($values); $i&lt;$n; $i++) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">284</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= '&lt;option value=&quot;' . tep_output_string($values[$i]['id']) . '&quot;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">314</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= '&lt;option value=&quot;' . tep_output_string($values[$i]['id']) . '&quot;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">285</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($default == $values[$i]['id']) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">315</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($default == $values[$i]['id']) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">286</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' SELECTED';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">316</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $field .= ' SELECTED';</td>
</tr>
<tr class="secEnd">
<td class="LineNum">287</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">317</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/classes/upload.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">30</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">30</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">31</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">31</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">32</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">32</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">33</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">33</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">34</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">34</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">35</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function parse() {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">35</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function parse() {</td>
</tr>
<tr class="secAll">
<td class="LineNum">36</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $messageStack;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">36</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $<span class="ttSigDiff">HTTP_POST_FILES, $</span>messageStack;</td>
</tr>
<tr class="secAll">
<td class="LineNum">37</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">37</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">38</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $file = array();</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">39</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">38</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($_FILES[$this-&gt;file])) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">40</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($_FILES[$this-&gt;file])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">39</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $file = array('name' =&gt; $_FILES[$this-&gt;file]['name'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">41</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $file = array('name' =&gt; $_FILES[$this-&gt;file]['name'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">40</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'type' =&gt; $_FILES[$this-&gt;file]['type'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">42</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'type' =&gt; $_FILES[$this-&gt;file]['type'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">41</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'size' =&gt; $_FILES[$this-&gt;file]['size'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">43</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'size' =&gt; $_FILES[$this-&gt;file]['size'],</td>
</tr>
<tr class="secEnd">
<td class="LineNum">42</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'tmp_name' =&gt; $_FILES[$this-&gt;file]['tmp_name']);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">44</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'tmp_name' =&gt; $_FILES[$this-&gt;file]['tmp_name']);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">43</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (isset($<span class="ttSigDiff">GLOBALS['</span>HTTP_POST_FILES<span class="ttSigDiff">']</span>[$this-&gt;file])) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">45</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (isset($HTTP_POST_FILES[$this-&gt;file])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">44</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $HTTP_POST_FILES;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">45</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">46</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $file = array('name' =&gt; $HTTP_POST_FILES[$this-&gt;file]['name'],</td>
<td class="AlignCenter">=</td>
<td class="LineNum">46</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $file = array('name' =&gt; $HTTP_POST_FILES[$this-&gt;file]['name'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">47</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'type' =&gt; $HTTP_POST_FILES[$this-&gt;file]['type'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">47</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'type' =&gt; $HTTP_POST_FILES[$this-&gt;file]['type'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">48</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'size' =&gt; $HTTP_POST_FILES[$this-&gt;file]['size'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">48</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'size' =&gt; $HTTP_POST_FILES[$this-&gt;file]['size'],</td>
</tr>
<tr class="secEnd">
<td class="LineNum">49</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'tmp_name' =&gt; $HTTP_POST_FILES[$this-&gt;file]['tmp_name']);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">49</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'tmp_name' =&gt; $HTTP_POST_FILES[$this-&gt;file]['tmp_name']);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">50</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</span></td>
<td class="AlignCenter">+-</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">51</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $file = array('name' =&gt; (isset($GLOBALS[$this-&gt;file . '_name']) ? $GLOBALS[$this-&gt;file . '_name'] : ''),</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">52</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'type' =&gt; (isset($GLOBALS[$this-&gt;file . '_type']) ? $GLOBALS[$this-&gt;file . '_type'] : ''),</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">53</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'size' =&gt; (isset($GLOBALS[$this-&gt;file . '_size']) ? $GLOBALS[$this-&gt;file . '_size'] : ''),</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">54</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'tmp_name' =&gt; (isset($GLOBALS[$this-&gt;file]) ? $GLOBALS[$this-&gt;file] : ''));</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">55</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">50</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">56</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">51</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">57</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( tep_not_null($file['tmp_name']) &amp;&amp; ($file['tmp_name'] != 'none') &amp;&amp; is_uploaded_file($file['tmp_name']) ) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">52</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( tep_not_null($file['tmp_name']) &amp;&amp; ($file['tmp_name'] != 'none') &amp;&amp; is_uploaded_file($file['tmp_name']) ) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">58</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (sizeof($this-&gt;extensions) &gt; 0) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">53</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (sizeof($this-&gt;extensions) &gt; 0) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">59</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!in_array(strtolower(substr($file['name'], strrpos($file['name'], '.')+1)), $this-&gt;extensions)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">54</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!in_array(strtolower(substr($file['name'], strrpos($file['name'], '.')+1)), $this-&gt;extensions)) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">60</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($this-&gt;message_location == 'direct') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">55</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($this-&gt;message_location == 'direct') {</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/file_manager.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">53</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fclose($fp);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">53</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fclose($fp);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">54</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_FILE_MANAGER, 'info=' . urlencode($HTTP_POST_VARS['filename'])));</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">54</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_FILE_MANAGER, 'info=' . urlencode($HTTP_POST_VARS['filename'])));</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">55</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">55</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">56</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">56</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">57</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'processuploads':</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">57</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'processuploads':</td>
</tr>
<tr class="secEnd">
<td class="LineNum">58</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($i=1; $i&lt;6; $i++) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">58</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($i=1; $i&lt;6; $i++) {</td>
</tr>
<tr class="secAll">
<td class="LineNum">59</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is<span class="ttSigDiff">set(</span><span class="ttSigDiff">$GLOBALS['</span>file<span class="ttSigDiff">_' .</span><span class="ttSigDiff"> </span>$<span class="ttSigDiff">i]) &amp;&amp; tep</span><span class="ttSigDiff">_not</span>_<span class="ttSigDiff">null($G</span>L<span class="ttSigDiff">OBA</span><span class="ttSigDiff">L</span>S['file_' . $i])) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">59</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is<span class="ttSigDiff">_uploaded_</span>file<span class="ttSigDiff">(</span>$<span class="ttSigDiff">HTTP</span>_<span class="ttSigDiff">POST_FI</span>L<span class="ttSigDiff">E</span>S['file_' . $i<span class="ttSigDiff">]['tmp_name'</span>])) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">60</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new upload('file_' . $i, $current_path);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">60</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new upload('file_' . $i, $current_path);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">61</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">61</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">62</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">62</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">63</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">63</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">64</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_FILE_MANAGER));</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">64</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_FILE_MANAGER));</td>
</tr>
<tr class="secEnd">
<td class="LineNum">65</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">65</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
</tr>
</table>

<h3>[BUGFIX] Currency Case-Sensitivity</h3>

<p>Use the currency code from the currencies database table instead of the value checked on to make sure the currency is valid.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/application_top.php<br />
catalog/includes/functions/general.php</p>

<span class="affectedFiles">File: catalog/includes/application_top.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">288</td>
<td class="Normal">&nbsp; require(DIR_WS_LANGUAGES . $language . '.php');</td>
<td class="AlignCenter">=</td>
<td class="LineNum">288</td>
<td class="Normal">&nbsp; require(DIR_WS_LANGUAGES . $language . '.php');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">289</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">289</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">290</td>
<td class="Normal">// currency</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">290</td>
<td class="Normal">// currency</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">291</td>
<td class="Normal">&nbsp; if (!tep_session_is_registered('currency') || isset($HTTP_GET_VARS['currency']) || ( (USE_DEFAULT_LANGUAGE_CURRENCY == 'true') &amp;&amp; (LANGUAGE_CURRENCY != $currency) ) ) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">291</td>
<td class="Normal">&nbsp; if (!tep_session_is_registered('currency') || isset($HTTP_GET_VARS['currency']) || ( (USE_DEFAULT_LANGUAGE_CURRENCY == 'true') &amp;&amp; (LANGUAGE_CURRENCY != $currency) ) ) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">292</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (!tep_session_is_registered('currency')) tep_session_register('currency');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">292</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (!tep_session_is_registered('currency')) tep_session_register('currency');</td>
</tr>
<tr class="secEnd">
<td class="LineNum">293</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">293</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">294</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (isset($HTTP_GET_VARS['currency'])) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">294</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (isset($HTTP_GET_VARS['currency'])<span class="ttSigDiff"> &amp;&amp; $currencies-&gt;is_set($HTTP_GET_VARS['currency'])</span>) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">295</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if (!</span>$currency = <span class="ttSigDiff">tep_currency_exists(</span>$HTTP_GET_VARS['currency']<span class="ttSigDiff">)) $currency = (USE_DEFAULT_LANGUAGE_CURRENCY == 'true') ? LANGUAGE_CURRENCY : DEFAULT_CURRENCY</span>;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">295</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $currency = $HTTP_GET_VARS['currency'];</td>
</tr>
<tr class="secBegin">
<td class="LineNum">296</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">296</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">297</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $currency = (USE_DEFAULT_LANGUAGE_CURRENCY == 'true') ? LANGUAGE_CURRENCY : DEFAULT_CURRENCY;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">297</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $currency = (USE_DEFAULT_LANGUAGE_CURRENCY == 'true') ? LANGUAGE_CURRENCY : DEFAULT_CURRENCY;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">298</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">298</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">299</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">299</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">300</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">300</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">301</td>
<td class="Normal">// navigation history</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">301</td>
<td class="Normal">// navigation history</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/functions/general.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">1168</td>
<td class="Normal">////</td>
<td class="AlignCenter">=</td>
<td class="LineNum">1168</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1169</td>
<td class="Normal">// Checks to see if the currency code exists as a currency</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1169</td>
<td class="Normal">// Checks to see if the currency code exists as a currency</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1170</td>
<td class="Normal">// TABLES: currencies</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1170</td>
<td class="Normal">// TABLES: currencies</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1171</td>
<td class="Normal">&nbsp; function tep_currency_exists($code) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1171</td>
<td class="Normal">&nbsp; function tep_currency_exists($code) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1172</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $code = tep_db_prepare_input($code);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1172</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $code = tep_db_prepare_input($code);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">1173</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1173</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">1174</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; $currency_<span class="ttSigDiff">code</span> = tep_db_query(&quot;select c<span class="ttSigDiff">u</span><span class="ttSigDiff">rr</span>e<span class="ttSigDiff">ncies_id</span> from &quot; . TABLE_CURRENCIES . &quot; where code = '&quot; . tep_db_input($code) . &quot;'&quot;);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">1174</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; $currency_<span class="ttSigDiff">q</span><span class="ttSigDiff">uery</span> = tep_db_query(&quot;select c<span class="ttSigDiff">od</span>e from &quot; . TABLE_CURRENCIES . &quot; where code = '&quot; . tep_db_input($code) . &quot;'<span class="ttSigDiff"> limit 1</span>&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1175</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (tep_db_num_rows($currency_<span class="ttSigDiff">code</span>)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1175</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (tep_db_num_rows($currency_<span class="ttSigDiff">q</span><span class="ttSigDiff">uery</span>)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1176</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $currency = tep_db_fetch_array($currency_query);</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">1176</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $code;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1177</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $c<span class="ttSigDiff">urrency['c</span>ode<span class="ttSigDiff">']</span>;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">1177</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">1178</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1178</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1179</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1179</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1180</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1180</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1181</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1181</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1182</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">1182</td>
<td class="Normal">&nbsp; function tep_string_to_int($string) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1183</td>
<td class="Normal">&nbsp; function tep_string_to_int($string) {</td>
</tr>
</table>

<h3>[BUGFIX] Invoice and Packing Slip Billing Address</h3>

<p>Correct the display of the billing address on the invoice and packing slip pages.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/invoice.php<br />
catalog/admin/packingslip.php</p>

<span class="affectedFiles">File: catalog/admin/invoice.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">48</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">48</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">49</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td valign=&quot;top&quot;&gt;&lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">49</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td valign=&quot;top&quot;&gt;&lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">50</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">50</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">51</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;b&gt;&lt;?php echo ENTRY_SOLD_TO; ?&gt;&lt;/b&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">51</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;b&gt;&lt;?php echo ENTRY_SOLD_TO; ?&gt;&lt;/b&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">52</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">52</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">53</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">53</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secAll">
<td class="LineNum">54</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;?php echo tep_address_format($order-&gt;customer['format_id'], $order-&gt;<span class="ttSigDiff">c</span><span class="ttSigDiff">ustomer</span>, 1, '', '&lt;br&gt;'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">54</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;?php echo tep_address_format($order-&gt;customer['format_id'], $order-&gt;<span class="ttSigDiff">billing</span>, 1, '', '&lt;br&gt;'); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">55</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">55</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">56</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">56</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">57</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '1', '5'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">57</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '1', '5'); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">58</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">58</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">59</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">59</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">60</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;?php echo $order-&gt;customer['telephone']; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">60</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;?php echo $order-&gt;customer['telephone']; ?&gt;&lt;/td&gt;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/packingslip.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">47</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">47</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">48</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td valign=&quot;top&quot;&gt;&lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">48</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td valign=&quot;top&quot;&gt;&lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">49</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">49</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">50</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;b&gt;&lt;?php echo ENTRY_SOLD_TO; ?&gt;&lt;/b&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">50</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;b&gt;&lt;?php echo ENTRY_SOLD_TO; ?&gt;&lt;/b&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">51</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">51</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">52</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">52</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secAll">
<td class="LineNum">53</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;?php echo tep_address_format($order-&gt;customer['format_id'], $order-&gt;<span class="ttSigDiff">c</span><span class="ttSigDiff">ustomer</span>, 1, '', '&lt;br&gt;'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">53</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;?php echo tep_address_format($order-&gt;customer['format_id'], $order-&gt;<span class="ttSigDiff">billing</span>, 1, '', '&lt;br&gt;'); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">54</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">54</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">55</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">55</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">56</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '1', '5'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">56</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '1', '5'); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">57</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">57</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">58</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">58</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">59</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;?php echo $order-&gt;customer['telephone']; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">59</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;?php echo $order-&gt;customer['telephone']; ?&gt;&lt;/td&gt;</td>
</tr>
</table>

<h3>[IMPROVEMENT] Configuration -> Minimum Values Settings</h3>

<p>Respect the Configuration -> Minimum Values settings when editing a customer on the Administration Tool.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/form_check.js.php<br />
catalog/admin/customers.php</p>

<span class="affectedFiles">File: catalog/includes/form_check.js.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">17</td>
<td class="Normal">var error_message = &quot;&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">17</td>
<td class="Normal">var error_message = &quot;&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">18</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">18</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">19</td>
<td class="Normal">function check_input(field_name, field_size, message) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">19</td>
<td class="Normal">function check_input(field_name, field_size, message) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">20</td>
<td class="Normal">&nbsp; if (form.elements[field_name] &amp;&amp; (form.elements[field_name].type != &quot;hidden&quot;)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">20</td>
<td class="Normal">&nbsp; if (form.elements[field_name] &amp;&amp; (form.elements[field_name].type != &quot;hidden&quot;)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">21</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; var field_value = form.elements[field_name].value;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">21</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; var field_value = form.elements[field_name].value;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">22</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">22</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">23</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (field_value<span class="ttSigDiff"> == '' || field_value</span>.length &lt; field_size) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">23</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (field_value.length &lt; field_size) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">24</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;* &quot; + message + &quot;\n&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">24</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;* &quot; + message + &quot;\n&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">25</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">25</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = true;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">27</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">27</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">28</td>
<td class="Normal">}</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">28</td>
<td class="Normal">}</td>
</tr>
<tr class="secEnd">
<td class="LineNum">29</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">29</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">60</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">60</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">61</td>
<td class="Normal">function check_password(field_name_1, field_name_2, field_size, message_1, message_2) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">61</td>
<td class="Normal">function check_password(field_name_1, field_name_2, field_size, message_1, message_2) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">62</td>
<td class="Normal">&nbsp; if (form.elements[field_name_1] &amp;&amp; (form.elements[field_name_1].type != &quot;hidden&quot;)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">62</td>
<td class="Normal">&nbsp; if (form.elements[field_name_1] &amp;&amp; (form.elements[field_name_1].type != &quot;hidden&quot;)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">63</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; var password = form.elements[field_name_1].value;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">63</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; var password = form.elements[field_name_1].value;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">64</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; var confirmation = form.elements[field_name_2].value;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">64</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; var confirmation = form.elements[field_name_2].value;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">65</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">65</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">66</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (password<span class="ttSigDiff"> == '' || password</span>.length &lt; field_size) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">66</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (password.length &lt; field_size) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">67</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;* &quot; + message_1 + &quot;\n&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">67</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;* &quot; + message_1 + &quot;\n&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">68</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">68</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = true;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">69</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else if (password != confirmation) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">69</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else if (password != confirmation) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">70</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;* &quot; + message_2 + &quot;\n&quot;;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">70</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;* &quot; + message_2 + &quot;\n&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">71</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">71</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = true;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">72</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">72</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">76</td>
<td class="Normal">function check_password_new(field_name_1, field_name_2, field_name_3, field_size, message_1, message_2, message_3) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">76</td>
<td class="Normal">function check_password_new(field_name_1, field_name_2, field_name_3, field_size, message_1, message_2, message_3) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">77</td>
<td class="Normal">&nbsp; if (form.elements[field_name_1] &amp;&amp; (form.elements[field_name_1].type != &quot;hidden&quot;)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">77</td>
<td class="Normal">&nbsp; if (form.elements[field_name_1] &amp;&amp; (form.elements[field_name_1].type != &quot;hidden&quot;)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">78</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; var password_current = form.elements[field_name_1].value;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">78</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; var password_current = form.elements[field_name_1].value;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">79</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; var password_new = form.elements[field_name_2].value;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">79</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; var password_new = form.elements[field_name_2].value;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">80</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; var password_confirmation = form.elements[field_name_3].value;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">80</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; var password_confirmation = form.elements[field_name_3].value;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">81</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">81</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">82</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (password_current<span class="ttSigDiff"> == '' || password_current</span>.length &lt; field_size) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">82</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (password_current.length &lt; field_size) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">83</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;* &quot; + message_1 + &quot;\n&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">83</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;* &quot; + message_1 + &quot;\n&quot;;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">84</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">84</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = true;</td>
</tr>
<tr class="secAll">
<td class="LineNum">85</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; } else if (password_new<span class="ttSigDiff"> == '' || password_new</span>.length &lt; field_size) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">85</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; } else if (password_new.length &lt; field_size) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">86</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;* &quot; + message_2 + &quot;\n&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">86</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;* &quot; + message_2 + &quot;\n&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">87</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">87</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = true;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">88</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else if (password_new != password_confirmation) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">88</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else if (password_new != password_confirmation) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">89</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;* &quot; + message_3 + &quot;\n&quot;;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">89</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;* &quot; + message_3 + &quot;\n&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">90</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">90</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = true;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">91</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">91</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/customers.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">123</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $entry_zone_id = $zone_values['zone_id'];</td>
<td class="AlignCenter">=</td>
<td class="LineNum">123</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $entry_zone_id = $zone_values['zone_id'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">124</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">124</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">125</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $error = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">125</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $error = true;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">126</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $entry_state_error = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">126</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $entry_state_error = true;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">127</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">127</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">128</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">128</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secAll">
<td class="LineNum">129</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($entry_state<span class="ttSigDiff"> ==</span> <span class="ttSigDiff">false</span>) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">129</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (<span class="ttSigDiff">strlen(</span>$entry_state<span class="ttSigDiff">) &lt;</span> <span class="ttSigDiff">ENTRY_STATE_MIN_L</span><span class="ttSigDiff">ENGTH</span>) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">130</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $error = true;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">130</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $error = true;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">131</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $entry_state_error = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">131</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $entry_state_error = true;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">132</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">132</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">133</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">133</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">134</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">134</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">135</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">135</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">258</td>
<td class="Normal">&nbsp; } else {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">258</td>
<td class="Normal">&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">259</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_GENDER; ?&gt;&quot;;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">259</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_GENDER; ?&gt;&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">260</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">260</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">261</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">261</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">262</td>
<td class="Normal">&lt;?php } ?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">262</td>
<td class="Normal">&lt;?php } ?&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">263</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">263</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">264</td>
<td class="HasMismatch">&nbsp; if (customers_firstname<span class="ttSigDiff"> == &quot;&quot; || customers_firstname</span>.length &lt; &lt;?php echo ENTRY_FIRST_NAME_MIN_LENGTH; ?&gt;) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">264</td>
<td class="HasMismatch">&nbsp; if (customers_firstname.length &lt; &lt;?php echo ENTRY_FIRST_NAME_MIN_LENGTH; ?&gt;) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">265</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_FIRST_NAME; ?&gt;&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">265</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_FIRST_NAME; ?&gt;&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">266</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">266</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">267</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">267</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">268</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">268</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">269</td>
<td class="HasMismatch">&nbsp; if (customers_lastname<span class="ttSigDiff"> == &quot;&quot; || customers_lastname</span>.length &lt; &lt;?php echo ENTRY_LAST_NAME_MIN_LENGTH; ?&gt;) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">269</td>
<td class="HasMismatch">&nbsp; if (customers_lastname.length &lt; &lt;?php echo ENTRY_LAST_NAME_MIN_LENGTH; ?&gt;) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">270</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_LAST_NAME; ?&gt;&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">270</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_LAST_NAME; ?&gt;&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">271</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">271</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">272</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">272</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">273</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">273</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">274</td>
<td class="Normal">&lt;?php if (ACCOUNT_DOB == 'true') { ?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">274</td>
<td class="Normal">&lt;?php if (ACCOUNT_DOB == 'true') { ?&gt;</td>
</tr>
<tr class="secAll">
<td class="LineNum">275</td>
<td class="HasMismatch">&nbsp; if (customers_dob<span class="ttSigDiff"> == &quot;&quot; || customers_dob</span>.length &lt; &lt;?php echo ENTRY_DOB_MIN_LENGTH; ?&gt;) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">275</td>
<td class="HasMismatch">&nbsp; if (customers_dob.length &lt; &lt;?php echo ENTRY_DOB_MIN_LENGTH; ?&gt;) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">276</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_DOB; ?&gt;&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">276</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_DOB; ?&gt;&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">277</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">277</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">278</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">278</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">279</td>
<td class="Normal">&lt;?php } ?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">279</td>
<td class="Normal">&lt;?php } ?&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">280</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">280</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">281</td>
<td class="HasMismatch">&nbsp; if (customers_email_address<span class="ttSigDiff"> == &quot;&quot; || customers_email_address</span>.length &lt; &lt;?php echo ENTRY_EMAIL_ADDRESS_MIN_LENGTH; ?&gt;) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">281</td>
<td class="HasMismatch">&nbsp; if (customers_email_address.length &lt; &lt;?php echo ENTRY_EMAIL_ADDRESS_MIN_LENGTH; ?&gt;) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">282</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_EMAIL_ADDRESS; ?&gt;&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">282</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_EMAIL_ADDRESS; ?&gt;&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">283</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">283</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">284</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">284</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">285</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">285</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">286</td>
<td class="HasMismatch">&nbsp; if (entry_street_address<span class="ttSigDiff"> == &quot;&quot; || entry_street_address</span>.length &lt; &lt;?php echo ENTRY_STREET_ADDRESS_MIN_LENGTH; ?&gt;) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">286</td>
<td class="HasMismatch">&nbsp; if (entry_street_address.length &lt; &lt;?php echo ENTRY_STREET_ADDRESS_MIN_LENGTH; ?&gt;) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">287</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_ADDRESS; ?&gt;&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">287</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_ADDRESS; ?&gt;&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">288</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">288</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">289</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">289</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">290</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">290</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">291</td>
<td class="HasMismatch">&nbsp; if (entry_postcode<span class="ttSigDiff"> == &quot;&quot; || entry_postcode</span>.length &lt; &lt;?php echo ENTRY_POSTCODE_MIN_LENGTH; ?&gt;) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">291</td>
<td class="HasMismatch">&nbsp; if (entry_postcode.length &lt; &lt;?php echo ENTRY_POSTCODE_MIN_LENGTH; ?&gt;) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">292</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_POST_CODE; ?&gt;&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">292</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_POST_CODE; ?&gt;&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">293</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">293</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">294</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">294</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">295</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">295</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">296</td>
<td class="HasMismatch">&nbsp; if (entry_city<span class="ttSigDiff"> == &quot;&quot; || entry_city</span>.length &lt; &lt;?php echo ENTRY_CITY_MIN_LENGTH; ?&gt;) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">296</td>
<td class="HasMismatch">&nbsp; if (entry_city.length &lt; &lt;?php echo ENTRY_CITY_MIN_LENGTH; ?&gt;) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">297</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_CITY; ?&gt;&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">297</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_CITY; ?&gt;&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">298</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">298</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">299</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">299</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">300</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">300</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">301</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">301</td>
<td class="Normal">&lt;?php</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">302</td>
<td class="Normal">&nbsp; if (ACCOUNT_STATE == 'true') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">302</td>
<td class="Normal">&nbsp; if (ACCOUNT_STATE == 'true') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">303</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">303</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">304</td>
<td class="Normal">&nbsp; if (document.customers.elements['entry_state'].type != &quot;hidden&quot;) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">304</td>
<td class="Normal">&nbsp; if (document.customers.elements['entry_state'].type != &quot;hidden&quot;) {</td>
</tr>
<tr class="secAll">
<td class="LineNum">305</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (document.customers.entry_state.value<span class="ttSigDiff"> == '' || document.customers.entry_state.value</span>.length &lt; &lt;?php echo ENTRY_STATE_MIN_LENGTH; ?&gt;<span class="ttSigDiff"> </span>) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">305</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (document.customers.entry_state.value.length &lt; &lt;?php echo ENTRY_STATE_MIN_LENGTH; ?&gt;) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">306</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_STATE; ?&gt;&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">306</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_STATE; ?&gt;&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">307</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = 1;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">307</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = 1;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">308</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">308</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">309</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">309</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">310</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">310</td>
<td class="Normal">&lt;?php</td>
</tr>
<tr class="secEnd">
<td class="LineNum">311</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">311</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">315</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (document.customers.entry_country_id.value == 0) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">315</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (document.customers.entry_country_id.value == 0) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">316</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_COUNTRY; ?&gt;&quot;;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">316</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_COUNTRY; ?&gt;&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">317</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = 1;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">317</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = 1;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">318</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">318</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">319</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">319</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">320</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">320</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">321</td>
<td class="HasMismatch">&nbsp; if (customers_telephone<span class="ttSigDiff"> == &quot;&quot; || customers_telephone</span>.length &lt; &lt;?php echo ENTRY_TELEPHONE_MIN_LENGTH; ?&gt;) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">321</td>
<td class="HasMismatch">&nbsp; if (customers_telephone.length &lt; &lt;?php echo ENTRY_TELEPHONE_MIN_LENGTH; ?&gt;) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">322</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_TELEPHONE; ?&gt;&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">322</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error_message = error_message + &quot;&lt;?php echo JS_TELEPHONE; ?&gt;&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">323</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">323</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; error = 1;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">324</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">324</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">325</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">325</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">326</td>
<td class="Normal">&nbsp; if (error == 1) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">326</td>
<td class="Normal">&nbsp; if (error == 1) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">327</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; alert(error_message);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">327</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; alert(error_message);</td>
</tr>
</table>

<h3>[BUGFIX] Compatibility Array Index</h3>

<p>Reset compatibility array indexes when working through its elements.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/functions/compatibility.php<br />
catalog/admin/includes/functions/compatibility.php</p>

<span class="affectedFiles">File: catalog/includes/functions/compatibility.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">15</td>
<td class="Normal">// This is due to the possibility of have an array in</td>
<td class="AlignCenter">=</td>
<td class="LineNum">15</td>
<td class="Normal">// This is due to the possibility of have an array in</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">16</td>
<td class="Normal">// $HTTP_xxx_VARS</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">16</td>
<td class="Normal">// $HTTP_xxx_VARS</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">17</td>
<td class="Normal">// Ie, products attributes</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">17</td>
<td class="Normal">// Ie, products attributes</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">18</td>
<td class="Normal">&nbsp; function do_magic_quotes_gpc(&amp;$ar) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">18</td>
<td class="Normal">&nbsp; function do_magic_quotes_gpc(&amp;$ar) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">19</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (!is_array($ar)) return false;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">19</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (!is_array($ar)) return false;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">20</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">20</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">21</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; reset($ar);</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">21</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; while (list($key, $value) = each($ar)) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">22</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; while (list($key, $value) = each($ar)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">22</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($ar[$key])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">23</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($ar[$key])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">23</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($ar[$key]);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">24</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($ar[$key]);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">24</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">25</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">25</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ar[$key] = addslashes($value);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ar[$key] = addslashes($value);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">27</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">27</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">28</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">29</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; reset($ar);</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">28</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">30</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">29</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">31</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">30</td>
<td class="Normal">&nbsp; if (PHP_VERSION &gt;= 4.1) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">32</td>
<td class="Normal">&nbsp; if (PHP_VERSION &gt;= 4.1) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">31</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $HTTP_GET_VARS =&amp; $_GET;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">33</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $HTTP_GET_VARS =&amp; $_GET;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">32</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $HTTP_POST_VARS =&amp; $_POST;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">34</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $HTTP_POST_VARS =&amp; $_POST;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">33</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $HTTP_COOKIE_VARS =&amp; $_COOKIE;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">35</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $HTTP_COOKIE_VARS =&amp; $_COOKIE;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/functions/compatibility.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">15</td>
<td class="Normal">// This is due to the possibility of have an array in</td>
<td class="AlignCenter">=</td>
<td class="LineNum">15</td>
<td class="Normal">// This is due to the possibility of have an array in</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">16</td>
<td class="Normal">// $HTTP_xxx_VARS</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">16</td>
<td class="Normal">// $HTTP_xxx_VARS</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">17</td>
<td class="Normal">// Ie, products attributes</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">17</td>
<td class="Normal">// Ie, products attributes</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">18</td>
<td class="Normal">&nbsp; function do_magic_quotes_gpc(&amp;$ar) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">18</td>
<td class="Normal">&nbsp; function do_magic_quotes_gpc(&amp;$ar) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">19</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (!is_array($ar)) return false;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">19</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (!is_array($ar)) return false;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">20</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">20</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">21</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; reset($ar);</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">21</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; while (list($key, $value) = each($ar)) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">22</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; while (list($key, $value) = each($ar)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">22</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($ar[$key])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">23</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($ar[$key])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">23</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($ar[$key]);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">24</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do_magic_quotes_gpc($ar[$key]);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">24</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">25</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">25</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ar[$key] = addslashes($value);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ar[$key] = addslashes($value);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">27</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">27</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">28</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">29</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; reset($ar);</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">28</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">30</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">29</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">31</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">30</td>
<td class="Normal">&nbsp; if (PHP_VERSION &gt;= 4.1) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">32</td>
<td class="Normal">&nbsp; if (PHP_VERSION &gt;= 4.1) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">31</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $HTTP_GET_VARS =&amp; $_GET;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">33</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $HTTP_GET_VARS =&amp; $_GET;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">32</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $HTTP_POST_VARS =&amp; $_POST;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">34</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $HTTP_POST_VARS =&amp; $_POST;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">33</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $HTTP_COOKIE_VARS =&amp; $_COOKIE;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">35</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $HTTP_COOKIE_VARS =&amp; $_COOKIE;</td>
</tr>
</table>

<h3>[IMPROVEMENT] MySQL Database Connection Identifier Link</h3>

<p>Pass the MySQL connection identifier link to the mysql_insert_id() function.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/functions/database.php<br />
catalog/admin/includes/functions/database.php</p>

<span class="affectedFiles">File: catalog/includes/functions/database.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">104</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">104</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">105</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">105</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">106</td>
<td class="Normal">&nbsp; function tep_db_data_seek($db_query, $row_number) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">106</td>
<td class="Normal">&nbsp; function tep_db_data_seek($db_query, $row_number) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">107</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return mysql_data_seek($db_query, $row_number);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">107</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return mysql_data_seek($db_query, $row_number);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">108</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">108</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">109</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">109</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">110</td>
<td class="HasMismatch">&nbsp; function tep_db_insert_id() {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">110</td>
<td class="HasMismatch">&nbsp; function tep_db_insert_id(<span class="ttSigDiff">$link = 'db_link'</span>) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">111</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $$link;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">112</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">111</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; return mysql_insert_id();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">113</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; return mysql_insert_id(<span class="ttSigDiff">$$link</span>);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">112</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">114</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">113</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">115</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">114</td>
<td class="Normal">&nbsp; function tep_db_free_result($db_query) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">116</td>
<td class="Normal">&nbsp; function tep_db_free_result($db_query) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">115</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return mysql_free_result($db_query);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">117</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return mysql_free_result($db_query);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">116</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">118</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">117</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">119</td>
<td class="Normal">&nbsp;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/functions/database.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">108</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">108</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">109</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">109</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">110</td>
<td class="Normal">&nbsp; function tep_db_data_seek($db_query, $row_number) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">110</td>
<td class="Normal">&nbsp; function tep_db_data_seek($db_query, $row_number) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">111</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return mysql_data_seek($db_query, $row_number);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">111</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return mysql_data_seek($db_query, $row_number);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">112</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">112</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">113</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">113</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">114</td>
<td class="HasMismatch">&nbsp; function tep_db_insert_id() {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">114</td>
<td class="HasMismatch">&nbsp; function tep_db_insert_id(<span class="ttSigDiff">$link = 'db_link'</span>) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">115</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $$link;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">116</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">115</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; return mysql_insert_id();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">117</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; return mysql_insert_id(<span class="ttSigDiff">$$link</span>);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">116</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">118</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">117</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">119</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">118</td>
<td class="Normal">&nbsp; function tep_db_free_result($db_query) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">120</td>
<td class="Normal">&nbsp; function tep_db_free_result($db_query) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">119</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return mysql_free_result($db_query);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">121</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return mysql_free_result($db_query);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">120</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">122</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">121</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">123</td>
<td class="Normal">&nbsp;</td>
</tr>
</table>

<h3>[BUGFIX] Product Sorting SQL Injection Vulnerability</h3>

<p>Fix an SQL injection vulnerability when sorting products on the index listing.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/index.php</p>

<span class="affectedFiles">File: catalog/index.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">185</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">185</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">186</td>
<td class="Normal">// We show them all</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">186</td>
<td class="Normal">// We show them all</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">187</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql = &quot;select &quot; . $select_column_list . &quot; p.products_id, p.manufacturers_id, p.products_price, p.products_tax_class_id, IF(s.status, s.specials_new_products_price, NULL) as specials_new_products_price, IF(s.status, s.specials_new_products_price, p.products_price) as final_price from &quot; . TABLE_PRODUCTS_DESCRIPTION . &quot; pd, &quot; . TABLE_PRODUCTS . &quot; p left join &quot; . TABLE_MANUFACTURERS . &quot; m on p.manufacturers_id = m.manufacturers_id left join &quot; . TABLE_SPECIALS . &quot; s on p.products_id = s.products_id, &quot; . TABLE_PRODUCTS_TO_CATEGORIES . &quot; p2c where p.products_status = '1' and p.products_id = p2c.products_id and pd.products_id = p2c.products_id and pd.language_id = '&quot; . (int)$languages_id . &quot;' and p2c.categories_id = '&quot; . (int)$current_category_id . &quot;'&quot;;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">187</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql = &quot;select &quot; . $select_column_list . &quot; p.products_id, p.manufacturers_id, p.products_price, p.products_tax_class_id, IF(s.status, s.specials_new_products_price, NULL) as specials_new_products_price, IF(s.status, s.specials_new_products_price, p.products_price) as final_price from &quot; . TABLE_PRODUCTS_DESCRIPTION . &quot; pd, &quot; . TABLE_PRODUCTS . &quot; p left join &quot; . TABLE_MANUFACTURERS . &quot; m on p.manufacturers_id = m.manufacturers_id left join &quot; . TABLE_SPECIALS . &quot; s on p.products_id = s.products_id, &quot; . TABLE_PRODUCTS_TO_CATEGORIES . &quot; p2c where p.products_status = '1' and p.products_id = p2c.products_id and pd.products_id = p2c.products_id and pd.language_id = '&quot; . (int)$languages_id . &quot;' and p2c.categories_id = '&quot; . (int)$current_category_id . &quot;'&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">188</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">188</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">189</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">189</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">190</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">190</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">191</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if ( (!isset($HTTP_GET_VARS['sort'])) || (!ereg('[1-8][ad]', $HTTP_GET_VARS['sort'])) || (substr($HTTP_GET_VARS['sort'], 0, 1) &gt; sizeof($column_list)) ) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">191</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if ( (!isset($HTTP_GET_VARS['sort'])) || (!ereg('<span class="ttSigDiff">^</span>[1-8][ad]<span class="ttSigDiff">$</span>', $HTTP_GET_VARS['sort'])) || (substr($HTTP_GET_VARS['sort'], 0, 1) &gt; sizeof($column_list)) ) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">192</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($column_list); $i&lt;$n; $i++) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">192</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($column_list); $i&lt;$n; $i++) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">193</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($column_list[$i] == 'PRODUCT_LIST_NAME') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">193</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($column_list[$i] == 'PRODUCT_LIST_NAME') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">194</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $HTTP_GET_VARS['sort'] = $i+1 . 'a';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">194</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $HTTP_GET_VARS['sort'] = $i+1 . 'a';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">195</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot; order by pd.products_name&quot;;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">195</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot; order by pd.products_name&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">196</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">196</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">197</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">197</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">198</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">198</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">199</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">199</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">200</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sort_col = substr($HTTP_GET_VARS['sort'], 0 , 1);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">200</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sort_col = substr($HTTP_GET_VARS['sort'], 0 , 1);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">201</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sort_order = substr($HTTP_GET_VARS['sort'], 1);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">201</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sort_order = substr($HTTP_GET_VARS['sort'], 1);</td>
</tr>
<tr class="secAll">
<td class="LineNum">202</td>
<td class="HasMismatch"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= ' order by ';</span></td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">202</td>
<td class="HasMismatch">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">203</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; switch ($column_list[$sort_col-1]) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">203</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; switch ($column_list[$sort_col-1]) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">204</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'PRODUCT_LIST_MODEL':</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">204</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'PRODUCT_LIST_MODEL':</td>
</tr>
<tr class="secAll">
<td class="LineNum">205</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot;p.products_model &quot; . ($sort_order == 'd' ? 'desc' : '') . &quot;, pd.products_name&quot;;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">205</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot;<span class="ttSigDiff"> order by </span>p.products_model &quot; . ($sort_order == 'd' ? 'desc' : '') . &quot;, pd.products_name&quot;;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">206</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">206</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">207</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'PRODUCT_LIST_NAME':</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">207</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'PRODUCT_LIST_NAME':</td>
</tr>
<tr class="secAll">
<td class="LineNum">208</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot;pd.products_name &quot; . ($sort_order == 'd' ? 'desc' : '');</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">208</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot;<span class="ttSigDiff"> order by </span>pd.products_name &quot; . ($sort_order == 'd' ? 'desc' : '');</td>
</tr>
<tr class="secBegin">
<td class="LineNum">209</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">209</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">210</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'PRODUCT_LIST_MANUFACTURER':</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">210</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'PRODUCT_LIST_MANUFACTURER':</td>
</tr>
<tr class="secAll">
<td class="LineNum">211</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot;m.manufacturers_name &quot; . ($sort_order == 'd' ? 'desc' : '') . &quot;, pd.products_name&quot;;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">211</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot;<span class="ttSigDiff"> order by </span>m.manufacturers_name &quot; . ($sort_order == 'd' ? 'desc' : '') . &quot;, pd.products_name&quot;;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">212</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">212</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">213</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'PRODUCT_LIST_QUANTITY':</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">213</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'PRODUCT_LIST_QUANTITY':</td>
</tr>
<tr class="secAll">
<td class="LineNum">214</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot;p.products_quantity &quot; . ($sort_order == 'd' ? 'desc' : '') . &quot;, pd.products_name&quot;;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">214</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot;<span class="ttSigDiff"> order by </span>p.products_quantity &quot; . ($sort_order == 'd' ? 'desc' : '') . &quot;, pd.products_name&quot;;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">215</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">215</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">216</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'PRODUCT_LIST_IMAGE':</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">216</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'PRODUCT_LIST_IMAGE':</td>
</tr>
<tr class="secAll">
<td class="LineNum">217</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot;pd.products_name&quot;;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">217</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot;<span class="ttSigDiff"> order by </span>pd.products_name&quot;;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">218</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">218</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">219</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'PRODUCT_LIST_WEIGHT':</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">219</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'PRODUCT_LIST_WEIGHT':</td>
</tr>
<tr class="secAll">
<td class="LineNum">220</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot;p.products_weight &quot; . ($sort_order == 'd' ? 'desc' : '') . &quot;, pd.products_name&quot;;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">220</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot;<span class="ttSigDiff"> order by </span>p.products_weight &quot; . ($sort_order == 'd' ? 'desc' : '') . &quot;, pd.products_name&quot;;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">221</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">221</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">222</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'PRODUCT_LIST_PRICE':</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">222</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'PRODUCT_LIST_PRICE':</td>
</tr>
<tr class="secAll">
<td class="LineNum">223</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot;final_price &quot; . ($sort_order == 'd' ? 'desc' : '') . &quot;, pd.products_name&quot;;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">223</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $listing_sql .= &quot;<span class="ttSigDiff"> order by </span>final_price &quot; . ($sort_order == 'd' ? 'desc' : '') . &quot;, pd.products_name&quot;;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">224</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">224</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">225</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">225</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">226</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">226</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">227</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">227</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">228</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; &lt;td width=&quot;100%&quot; valign=&quot;top&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">228</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; &lt;td width=&quot;100%&quot; valign=&quot;top&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">229</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">229</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
</table>

<h3>[BUGFIX] Product Price Calculations</h3>

<p>Don't calculate product prices with tax by rounding the net value as this brings down the default precision of 4 to the decimal places of the selected currency.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/classes/currencies.php<br />
catalog/includes/classes/order.php<br />
catalog/includes/classes/shopping_cart.php<br />
catalog/includes/functions/general.php<br />
catalog/admin/includes/classes/currencies.php<br />
catalog/admin/includes/functions/general.php<br />
catalog/admin/orders.php<br />
catalog/admin/invoice.php</p>

<span class="affectedFiles">File: catalog/includes/classes/currencies.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">49</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $format_string = $this-&gt;currencies[$currency_type]['symbol_left'] . number_format(tep_round($number, $this-&gt;currencies[$currency_type]['decimal_places']), $this-&gt;currencies[$currency_type]['decimal_places'], $this-&gt;currencies[$currency_type]['decimal_point'], $this-&gt;currencies[$currency_type]['thousands_point']) . $this-&gt;currencies[$currency_type]['symbol_right'];</td>
<td class="AlignCenter">=</td>
<td class="LineNum">49</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $format_string = $this-&gt;currencies[$currency_type]['symbol_left'] . number_format(tep_round($number, $this-&gt;currencies[$currency_type]['decimal_places']), $this-&gt;currencies[$currency_type]['decimal_places'], $this-&gt;currencies[$currency_type]['decimal_point'], $this-&gt;currencies[$currency_type]['thousands_point']) . $this-&gt;currencies[$currency_type]['symbol_right'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">50</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">50</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">51</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">51</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">52</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $format_string;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">52</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $format_string;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">53</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">53</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">54</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">54</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">55</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; function calculate_price($products_price, $products_tax, $quantity = 1) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">56</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $currency;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">57</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">58</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return tep_round(tep_add_tax($products_price, $products_tax), $this-&gt;currencies[$currency]['decimal_places']) * $quantity;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">59</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">60</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">55</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function is_set($code) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">61</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function is_set($code) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">56</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($this-&gt;currencies[$code]) &amp;&amp; tep_not_null($this-&gt;currencies[$code])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">62</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($this-&gt;currencies[$code]) &amp;&amp; tep_not_null($this-&gt;currencies[$code])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">57</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">63</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">58</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">64</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">59</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">65</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">60</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">66</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">66</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">72</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">67</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function get_decimal_places($code) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">73</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function get_decimal_places($code) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">68</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $this-&gt;currencies[$code]['decimal_places'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">74</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $this-&gt;currencies[$code]['decimal_places'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">69</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">75</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">70</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">76</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">71</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function display_price($products_price, $products_tax, $quantity = 1) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">77</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function display_price($products_price, $products_tax, $quantity = 1) {</td>
</tr>
<tr class="secAll">
<td class="LineNum">72</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $this-&gt;format(t<span class="ttSigDiff">ep_</span>a<span class="ttSigDiff">dd_t</span>a<span class="ttSigDiff">x</span>($products_price, $products_tax<span class="ttSigDiff">) </span><span class="ttSigDiff">*</span> $quantity);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">78</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $this-&gt;format(<span class="ttSigDiff">$</span>t<span class="ttSigDiff">his</span><span class="ttSigDiff">-&gt;c</span>a<span class="ttSigDiff">lcul</span>a<span class="ttSigDiff">te_pric</span><span class="ttSigDiff">e</span>($products_price, $products_tax<span class="ttSigDiff">,</span> $quantity<span class="ttSigDiff">)</span>);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">73</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">79</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">74</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">80</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">75</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">81</td>
<td class="Normal">?&gt;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/classes/order.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">238</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'price' =&gt; $attributes['options_values_price']);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">238</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'price' =&gt; $attributes['options_values_price']);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">239</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">239</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">240</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $subindex++;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">240</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $subindex++;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">241</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">241</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">242</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">242</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">243</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">243</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">244</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $shown_price = <span class="ttSigDiff">t</span>e<span class="ttSigDiff">p_</span>a<span class="ttSigDiff">dd_t</span>a<span class="ttSigDiff">x</span>($this-&gt;products[$index]['final_price'], $this-&gt;products[$index]['tax']<span class="ttSigDiff">) </span><span class="ttSigDiff">*</span> $this-&gt;products[$index]['qty'];</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">244</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $shown_price = <span class="ttSigDiff">$cur</span><span class="ttSigDiff">r</span>e<span class="ttSigDiff">ncies-</span><span class="ttSigDiff">&gt;c</span>a<span class="ttSigDiff">lcul</span>a<span class="ttSigDiff">te_pric</span><span class="ttSigDiff">e</span>($this-&gt;products[$index]['final_price'], $this-&gt;products[$index]['tax']<span class="ttSigDiff">,</span> $this-&gt;products[$index]['qty']<span class="ttSigDiff">)</span>;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">245</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info['subtotal'] += $shown_price;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">245</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info['subtotal'] += $shown_price;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">246</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">246</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">247</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_tax = $this-&gt;products[$index]['tax'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">247</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_tax = $this-&gt;products[$index]['tax'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">248</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_tax_description = $this-&gt;products[$index]['tax_description'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">248</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_tax_description = $this-&gt;products[$index]['tax_description'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">249</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (DISPLAY_PRICE_WITH_TAX == 'true') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">249</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (DISPLAY_PRICE_WITH_TAX == 'true') {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">250</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info['tax'] += $shown_price - ($shown_price / (($products_tax &lt; 10) ? &quot;1.0&quot; . str_replace('.', '', $products_tax) : &quot;1.&quot; . str_replace('.', '', $products_tax)));</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">250</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info['tax'] += $shown_price - ($shown_price / (($products_tax &lt; 10) ? &quot;1.0&quot; . str_replace('.', '', $products_tax) : &quot;1.&quot; . str_replace('.', '', $products_tax)));</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/classes/shopping_cart.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($this-&gt;contents)) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">26</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($this-&gt;contents)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">27</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($this-&gt;contents);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">27</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($this-&gt;contents);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">28</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($products_id, ) = each($this-&gt;contents)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">28</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($products_id, ) = each($this-&gt;contents)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">29</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $qty = $this-&gt;contents[$products_id]['qty'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">29</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $qty = $this-&gt;contents[$products_id]['qty'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">30</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $product_query = tep_db_query(&quot;select products_id from &quot; . TABLE_CUSTOMERS_BASKET . &quot; where customers_id = '&quot; . (int)$customer_id . &quot;' and products_id = '&quot; . tep_db_input($products_id) . &quot;'&quot;);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">30</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $product_query = tep_db_query(&quot;select products_id from &quot; . TABLE_CUSTOMERS_BASKET . &quot; where customers_id = '&quot; . (int)$customer_id . &quot;' and products_id = '&quot; . tep_db_input($products_id) . &quot;'&quot;);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">31</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!tep_db_num_rows($product_query)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">31</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!tep_db_num_rows($product_query)) {</td>
</tr>
<tr class="secAll">
<td class="LineNum">32</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;insert into &quot; . TABLE_CUSTOMERS_BASKET . &quot; (customers_id, products_id, customers_basket_quantity, customers_basket_date_added) values ('&quot; . (int)$customer_id . &quot;', '&quot; . tep_db_input($products_id) . &quot;', '&quot; . $qty . &quot;', '&quot; . date('Ymd') . &quot;')&quot;);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">32</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;insert into &quot; . TABLE_CUSTOMERS_BASKET . &quot; (customers_id, products_id, customers_basket_quantity, customers_basket_date_added) values ('&quot; . (int)$customer_id . &quot;', '&quot; . tep_db_input($products_id) . &quot;', '&quot; . <span class="ttSigDiff">tep_db_input(</span>$qty<span class="ttSigDiff">)</span> . &quot;', '&quot; . date('Ymd') . &quot;')&quot;);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">33</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($this-&gt;contents[$products_id]['attributes'])) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">33</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($this-&gt;contents[$products_id]['attributes'])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">34</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($this-&gt;contents[$products_id]['attributes']);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">34</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($this-&gt;contents[$products_id]['attributes']);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">35</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($option, $value) = each($this-&gt;contents[$products_id]['attributes'])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">35</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($option, $value) = each($this-&gt;contents[$products_id]['attributes'])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">36</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;insert into &quot; . TABLE_CUSTOMERS_BASKET_ATTRIBUTES . &quot; (customers_id, products_id, products_options_id, products_options_value_id) values ('&quot; . (int)$customer_id . &quot;', '&quot; . tep_db_input($products_id) . &quot;', '&quot; . (int)$option . &quot;', '&quot; . (int)$value . &quot;')&quot;);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">36</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;insert into &quot; . TABLE_CUSTOMERS_BASKET_ATTRIBUTES . &quot; (customers_id, products_id, products_options_id, products_options_value_id) values ('&quot; . (int)$customer_id . &quot;', '&quot; . tep_db_input($products_id) . &quot;', '&quot; . (int)$option . &quot;', '&quot; . (int)$value . &quot;')&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">37</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">37</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">38</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">38</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">39</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">39</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secAll">
<td class="LineNum">40</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;update &quot; . TABLE_CUSTOMERS_BASKET . &quot; set customers_basket_quantity = '&quot; . $qty . &quot;' where customers_id = '&quot; . (int)$customer_id . &quot;' and products_id = '&quot; . tep_db_input($products_id) . &quot;'&quot;);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">40</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;update &quot; . TABLE_CUSTOMERS_BASKET . &quot; set customers_basket_quantity = '&quot; . <span class="ttSigDiff">tep_db_input(</span>$qty<span class="ttSigDiff">)</span> . &quot;' where customers_id = '&quot; . (int)$customer_id . &quot;' and products_id = '&quot; . tep_db_input($products_id) . &quot;'&quot;);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">41</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">41</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">42</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">42</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">43</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">43</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">44</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">44</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">45</td>
<td class="Normal">// reset per-session cart contents, but not the database contents</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">45</td>
<td class="Normal">// reset per-session cart contents, but not the database contents</td>
</tr>
<tr class="secEnd">
<td class="LineNum">46</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;reset(false);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">46</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;reset(false);</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">234</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">234</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">235</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">235</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">236</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return substr($product_id_list, 2);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">236</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return substr($product_id_list, 2);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">237</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">237</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">238</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">238</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">239</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function calculate() {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">239</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function calculate() {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">240</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $currencies;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">241</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">240</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;total = 0;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">242</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;total = 0;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">241</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;weight = 0;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">243</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;weight = 0;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">242</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!is_array($this-&gt;contents)) return 0;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">244</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!is_array($this-&gt;contents)) return 0;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">243</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">245</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">244</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($this-&gt;contents);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">246</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($this-&gt;contents);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">245</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($products_id, ) = each($this-&gt;contents)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">247</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($products_id, ) = each($this-&gt;contents)) {</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">256</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $specials_query = tep_db_query(&quot;select specials_new_products_price from &quot; . TABLE_SPECIALS . &quot; where products_id = '&quot; . (int)$prid . &quot;' and status = '1'&quot;);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">258</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $specials_query = tep_db_query(&quot;select specials_new_products_price from &quot; . TABLE_SPECIALS . &quot; where products_id = '&quot; . (int)$prid . &quot;' and status = '1'&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">257</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_db_num_rows ($specials_query)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">259</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_db_num_rows ($specials_query)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">258</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $specials = tep_db_fetch_array($specials_query);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">260</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $specials = tep_db_fetch_array($specials_query);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">259</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_price = $specials['specials_new_products_price'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">261</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_price = $specials['specials_new_products_price'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">260</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">262</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">261</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">263</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">262</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;total += <span class="ttSigDiff">t</span>e<span class="ttSigDiff">p_</span>a<span class="ttSigDiff">dd_t</span>a<span class="ttSigDiff">x</span>($products_price, $products_tax<span class="ttSigDiff">) </span><span class="ttSigDiff">*</span> $qty;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">264</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;total += <span class="ttSigDiff">$cur</span><span class="ttSigDiff">r</span>e<span class="ttSigDiff">ncies-</span><span class="ttSigDiff">&gt;c</span>a<span class="ttSigDiff">lcul</span>a<span class="ttSigDiff">te_pric</span><span class="ttSigDiff">e</span>($products_price, $products_tax<span class="ttSigDiff">,</span> $qty<span class="ttSigDiff">)</span>;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">263</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;weight += ($qty * $products_weight);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">265</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;weight += ($qty * $products_weight);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">264</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">266</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">265</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">267</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">266</td>
<td class="Normal">// attributes price</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">268</td>
<td class="Normal">// attributes price</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">267</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($this-&gt;contents[$products_id]['attributes'])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">269</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($this-&gt;contents[$products_id]['attributes'])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">268</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($this-&gt;contents[$products_id]['attributes']);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">270</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($this-&gt;contents[$products_id]['attributes']);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">269</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($option, $value) = each($this-&gt;contents[$products_id]['attributes'])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">271</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($option, $value) = each($this-&gt;contents[$products_id]['attributes'])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">270</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $attribute_price_query = tep_db_query(&quot;select options_values_price, price_prefix from &quot; . TABLE_PRODUCTS_ATTRIBUTES . &quot; where products_id = '&quot; . (int)$prid . &quot;' and options_id = '&quot; . (int)$option . &quot;' and options_values_id = '&quot; . (int)$value . &quot;'&quot;);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">272</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $attribute_price_query = tep_db_query(&quot;select options_values_price, price_prefix from &quot; . TABLE_PRODUCTS_ATTRIBUTES . &quot; where products_id = '&quot; . (int)$prid . &quot;' and options_id = '&quot; . (int)$option . &quot;' and options_values_id = '&quot; . (int)$value . &quot;'&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">271</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $attribute_price = tep_db_fetch_array($attribute_price_query);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">273</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $attribute_price = tep_db_fetch_array($attribute_price_query);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">272</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($attribute_price['price_prefix'] == '+') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">274</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($attribute_price['price_prefix'] == '+') {</td>
</tr>
<tr class="secAll">
<td class="LineNum">273</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;total += $<span class="ttSigDiff">qty * t</span>e<span class="ttSigDiff">p_</span>a<span class="ttSigDiff">dd_t</span>a<span class="ttSigDiff">x</span>($attribute_price['options_values_price'], $products_tax);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">275</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;total += $<span class="ttSigDiff">c</span><span class="ttSigDiff">urrenci</span>e<span class="ttSigDiff">s-</span><span class="ttSigDiff">&gt;c</span>a<span class="ttSigDiff">lcul</span>a<span class="ttSigDiff">te_pric</span><span class="ttSigDiff">e</span>($attribute_price['options_values_price'], $products_tax<span class="ttSigDiff">, $qty</span>);</td>
</tr>
<tr class="secAll">
<td class="LineNum">274</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">276</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secAll">
<td class="LineNum">275</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;total -= $<span class="ttSigDiff">qty * t</span>e<span class="ttSigDiff">p_</span>a<span class="ttSigDiff">dd_t</span>a<span class="ttSigDiff">x</span>($attribute_price['options_values_price'], $products_tax);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">277</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;total -= $<span class="ttSigDiff">c</span><span class="ttSigDiff">urrenci</span>e<span class="ttSigDiff">s-</span><span class="ttSigDiff">&gt;c</span>a<span class="ttSigDiff">lcul</span>a<span class="ttSigDiff">te_pric</span><span class="ttSigDiff">e</span>($attribute_price['options_values_price'], $products_tax<span class="ttSigDiff">, $qty</span>);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">276</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">278</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">277</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">279</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">278</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">280</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">279</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">281</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">280</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">282</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">281</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">283</td>
<td class="Normal">&nbsp;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/functions/general.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">352</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">352</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">353</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">353</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">354</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">354</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">355</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">355</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">356</td>
<td class="Normal">// Add tax to a products price</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">356</td>
<td class="Normal">// Add tax to a products price</td>
</tr>
<tr class="secEnd">
<td class="LineNum">357</td>
<td class="Normal">&nbsp; function tep_add_tax($price, $tax) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">357</td>
<td class="Normal">&nbsp; function tep_add_tax($price, $tax) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">358</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $currencies;</span></td>
<td class="AlignCenter">+-</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">359</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">360</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if ( (DISPLAY_PRICE_WITH_TAX == 'true') &amp;&amp; ($tax &gt; 0) ) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">358</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if ( (DISPLAY_PRICE_WITH_TAX == 'true') &amp;&amp; ($tax &gt; 0) ) {</td>
</tr>
<tr class="secAll">
<td class="LineNum">361</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <span class="ttSigDiff">tep_round(</span>$price<span class="ttSigDiff">, $currencies-&gt;currencies[DEFAULT_CURRENCY]['decimal_places'])</span> + tep_calculate_tax($price, $tax);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">359</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $price + tep_calculate_tax($price, $tax);</td>
</tr>
<tr class="secAll">
<td class="LineNum">362</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">360</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secAll">
<td class="LineNum">363</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <span class="ttSigDiff">tep_round(</span>$price<span class="ttSigDiff">, $currencies-&gt;currencies[DEFAULT_CURRENCY]['decimal_places'])</span>;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">361</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $price;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">364</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">362</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">365</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">363</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">366</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">364</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">367</td>
<td class="Normal">// Calculates Tax rounding the result</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">365</td>
<td class="Normal">// Calculates Tax rounding the result</td>
</tr>
<tr class="secEnd">
<td class="LineNum">368</td>
<td class="Normal">&nbsp; function tep_calculate_tax($price, $tax) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">366</td>
<td class="Normal">&nbsp; function tep_calculate_tax($price, $tax) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">369</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">global</span> $<span class="ttSigDiff">curr</span>e<span class="ttSigDiff">ncies</span>;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">367</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">return</span> $<span class="ttSigDiff">pric</span>e<span class="ttSigDiff"> * $tax </span><span class="ttSigDiff">/ 100</span>;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">370</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">371</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; return tep_round($price * $tax / 100, $currencies-&gt;currencies[DEFAULT_CURRENCY]['decimal_places']);</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">372</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">368</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">373</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">369</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">374</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">370</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">375</td>
<td class="Normal">// Return the number of products in a category</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">371</td>
<td class="Normal">// Return the number of products in a category</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">376</td>
<td class="Normal">// TABLES: products, products_to_categories, categories</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">372</td>
<td class="Normal">// TABLES: products, products_to_categories, categories</td>
</tr>
<tr class="secEnd">
<td class="LineNum">377</td>
<td class="Normal">&nbsp; function tep_count_products_in_category($category_id, $include_inactive = false) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">373</td>
<td class="Normal">&nbsp; function tep_count_products_in_category($category_id, $include_inactive = false) {</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/classes/currencies.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">49</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">49</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">50</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">50</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">51</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function get_value($code) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">51</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function get_value($code) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">52</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $this-&gt;currencies[$code]['value'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">52</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $this-&gt;currencies[$code]['value'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">53</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">53</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">54</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">54</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">55</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; function display_price($products_price, $products_tax, $quantity = 1) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">55</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; function display_price($products_price, $products_tax, $quantity = 1<span class="ttSigDiff">, $currency_type = DEFAULT_CURRENCY</span>) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">56</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $this-&gt;format(tep_add_tax($products_price, $products_tax) * $quantity);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">56</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $this-&gt;format(tep_<span class="ttSigDiff">round(tep_</span>add_tax($products_price, $products_tax<span class="ttSigDiff">), $this-&gt;currencies[$currency_type]['decimal_places']</span>) * $quantity);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">57</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">57</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">58</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">58</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">59</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">59</td>
<td class="Normal">?&gt;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/functions/general.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">1130</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return round($value, $precision);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">1130</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return round($value, $precision);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1131</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1131</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1132</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1132</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1133</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1133</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1134</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1134</td>
<td class="Normal">////</td>
</tr>
<tr class="secEnd">
<td class="LineNum">1135</td>
<td class="Normal">// Add tax to a products price</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1135</td>
<td class="Normal">// Add tax to a products price</td>
</tr>
<tr class="secBegin">
<td class="LineNum">1136</td>
<td class="HasMismatch">&nbsp; function tep_add_tax($price, $tax) {</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">1136</td>
<td class="HasMismatch">&nbsp; function tep_add_tax($price, $tax<span class="ttSigDiff">, $override = false</span>) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1137</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">global</span> <span class="ttSigDiff">$cur</span>re<span class="ttSigDiff">nc</span>ie<span class="ttSigDiff">s;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1137</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if ( (</span> <span class="ttSigDiff">(DISPLAY_PRICE_WITH_TAX =</span><span class="ttSigDiff">= 't</span>r<span class="ttSigDiff">ue') || ($ov</span>e<span class="ttSigDiff">rr</span>i<span class="ttSigDiff">d</span>e<span class="ttSigDiff"> =</span><span class="ttSigDiff">= true) ) &amp;&amp; ($tax &gt; 0) ) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1138</td>
<td class="HasMismatch">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1138</td>
<td class="HasMismatch"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $price + tep_calculate_tax($price, $tax);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1139</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; if (DISPLAY_PRICE_WITH_TAX == 'true') {</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">1140</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return tep_round($price, $currencies-&gt;currencies[DEFAULT_CURRENCY]['decimal_places']) + tep_calculate_tax($price, $tax);</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secAll">
<td class="LineNum">1141</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">1139</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secAll">
<td class="LineNum">1142</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <span class="ttSigDiff">tep_round(</span>$price<span class="ttSigDiff">, $currencies-&gt;currencies[DEFAULT_CURRENCY]['decimal_places'])</span>;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">1140</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $price;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">1143</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">1141</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1144</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1142</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1145</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1143</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1146</td>
<td class="Normal">// Calculates Tax rounding the result</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1144</td>
<td class="Normal">// Calculates Tax rounding the result</td>
</tr>
<tr class="secEnd">
<td class="LineNum">1147</td>
<td class="Normal">&nbsp; function tep_calculate_tax($price, $tax) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1145</td>
<td class="Normal">&nbsp; function tep_calculate_tax($price, $tax) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">1148</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">global</span> $<span class="ttSigDiff">curr</span>e<span class="ttSigDiff">ncies</span>;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">1146</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">return</span> $<span class="ttSigDiff">pric</span>e<span class="ttSigDiff"> * $tax </span><span class="ttSigDiff">/ 100</span>;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1149</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">1150</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; return tep_round($price * $tax / 100, $currencies-&gt;currencies[DEFAULT_CURRENCY]['decimal_places']);</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">1151</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">1147</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1152</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1148</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1153</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1149</td>
<td class="Normal">////</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1154</td>
<td class="Normal">// Returns the tax rate for a zone / class</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1150</td>
<td class="Normal">// Returns the tax rate for a zone / class</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1155</td>
<td class="Normal">// TABLES: tax_rates, zones_to_geo_zones</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1151</td>
<td class="Normal">// TABLES: tax_rates, zones_to_geo_zones</td>
</tr>
<tr class="secEnd">
<td class="LineNum">1156</td>
<td class="Normal">&nbsp; function tep_get_tax_rate($class_id, $country_id = -1, $zone_id = -1) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1152</td>
<td class="Normal">&nbsp; function tep_get_tax_rate($class_id, $country_id = -1, $zone_id = -1) {</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/orders.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">231</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">231</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">232</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">232</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">233</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;' . &quot;\n&quot; .</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">233</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;' . &quot;\n&quot; .</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">234</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; valign=&quot;top&quot;&gt;' . $order-&gt;products[$i]['model'] . '&lt;/td&gt;' . &quot;\n&quot; .</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">234</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; valign=&quot;top&quot;&gt;' . $order-&gt;products[$i]['model'] . '&lt;/td&gt;' . &quot;\n&quot; .</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">235</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;' . tep_display_tax_value($order-&gt;products[$i]['tax']) . '%&lt;/td&gt;' . &quot;\n&quot; .</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">235</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;' . tep_display_tax_value($order-&gt;products[$i]['tax']) . '%&lt;/td&gt;' . &quot;\n&quot; .</td>
</tr>
<tr class="secEnd">
<td class="LineNum">236</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format($order-&gt;products[$i]['final_price'], true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot; .</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">236</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format($order-&gt;products[$i]['final_price'], true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot; .</td>
</tr>
<tr class="secAll">
<td class="LineNum">237</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format(tep_add_tax($order-&gt;products[$i]['final_price'], $order-&gt;products[$i]['tax']), true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot; .</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">237</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format(tep_add_tax($order-&gt;products[$i]['final_price'], $order-&gt;products[$i]['tax']<span class="ttSigDiff">, true</span>), true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot; .</td>
</tr>
<tr class="secAll">
<td class="LineNum">238</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format($order-&gt;products[$i]['final_price'] * $order-&gt;products[$i]['qty'], true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot; .</td>
<td class="AlignCenter">=</td>
<td class="LineNum">238</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format($order-&gt;products[$i]['final_price'] * $order-&gt;products[$i]['qty'], true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot; .</td>
</tr>
<tr class="secAll">
<td class="LineNum">239</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format(tep_add_tax($order-&gt;products[$i]['final_price'], $order-&gt;products[$i]['tax']) * $order-&gt;products[$i]['qty'], true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot;;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">239</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format(tep_add_tax($order-&gt;products[$i]['final_price'], $order-&gt;products[$i]['tax']<span class="ttSigDiff">, true</span>) * $order-&gt;products[$i]['qty'], true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot;;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">240</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;' . &quot;\n&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">240</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;' . &quot;\n&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">241</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">241</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">242</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">242</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">243</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">243</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">244</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot; colspan=&quot;8&quot;&gt;&lt;table border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">244</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot; colspan=&quot;8&quot;&gt;&lt;table border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">245</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">245</td>
<td class="Normal">&lt;?php</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/invoice.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">114</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">114</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">115</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">115</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">116</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;' . &quot;\n&quot; .</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">116</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;' . &quot;\n&quot; .</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">117</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; valign=&quot;top&quot;&gt;' . $order-&gt;products[$i]['model'] . '&lt;/td&gt;' . &quot;\n&quot;;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">117</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; valign=&quot;top&quot;&gt;' . $order-&gt;products[$i]['model'] . '&lt;/td&gt;' . &quot;\n&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">118</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;' . tep_display_tax_value($order-&gt;products[$i]['tax']) . '%&lt;/td&gt;' . &quot;\n&quot; .</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">118</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;' . tep_display_tax_value($order-&gt;products[$i]['tax']) . '%&lt;/td&gt;' . &quot;\n&quot; .</td>
</tr>
<tr class="secEnd">
<td class="LineNum">119</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format($order-&gt;products[$i]['final_price'], true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot; .</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">119</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format($order-&gt;products[$i]['final_price'], true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot; .</td>
</tr>
<tr class="secAll">
<td class="LineNum">120</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format(tep_add_tax($order-&gt;products[$i]['final_price'], $order-&gt;products[$i]['tax']), true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot; .</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">120</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format(tep_add_tax($order-&gt;products[$i]['final_price'], $order-&gt;products[$i]['tax']<span class="ttSigDiff">, true</span>), true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot; .</td>
</tr>
<tr class="secAll">
<td class="LineNum">121</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format($order-&gt;products[$i]['final_price'] * $order-&gt;products[$i]['qty'], true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot; .</td>
<td class="AlignCenter">=</td>
<td class="LineNum">121</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format($order-&gt;products[$i]['final_price'] * $order-&gt;products[$i]['qty'], true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot; .</td>
</tr>
<tr class="secAll">
<td class="LineNum">122</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format(tep_add_tax($order-&gt;products[$i]['final_price'], $order-&gt;products[$i]['tax']) * $order-&gt;products[$i]['qty'], true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot;;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">122</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;dataTableContent&quot; align=&quot;right&quot; valign=&quot;top&quot;&gt;&lt;b&gt;' . $currencies-&gt;format(tep_add_tax($order-&gt;products[$i]['final_price'], $order-&gt;products[$i]['tax']<span class="ttSigDiff">, true</span>) * $order-&gt;products[$i]['qty'], true, $order-&gt;info['currency'], $order-&gt;info['currency_value']) . '&lt;/b&gt;&lt;/td&gt;' . &quot;\n&quot;;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">123</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;' . &quot;\n&quot;;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">123</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;' . &quot;\n&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">124</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">124</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">125</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">125</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">126</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">126</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">127</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot; colspan=&quot;8&quot;&gt;&lt;table border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">127</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot; colspan=&quot;8&quot;&gt;&lt;table border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">128</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">128</td>
<td class="Normal">&lt;?php</td>
</tr>
</table>

<h3>[BUGFIX] Country Name on the Order History Page</h3>

<p>Fix the display of the country name on the order history page.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/classes/order.php</p>

<span class="affectedFiles">File: catalog/includes/classes/order.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">68</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'company' =&gt; $order['customers_company'],</td>
<td class="AlignCenter">=</td>
<td class="LineNum">68</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'company' =&gt; $order['customers_company'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">69</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'street_address' =&gt; $order['customers_street_address'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">69</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'street_address' =&gt; $order['customers_street_address'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">70</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'suburb' =&gt; $order['customers_suburb'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">70</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'suburb' =&gt; $order['customers_suburb'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">71</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'city' =&gt; $order['customers_city'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">71</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'city' =&gt; $order['customers_city'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">72</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'postcode' =&gt; $order['customers_postcode'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">72</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'postcode' =&gt; $order['customers_postcode'],</td>
</tr>
<tr class="secEnd">
<td class="LineNum">73</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'state' =&gt; $order['customers_state'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">73</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'state' =&gt; $order['customers_state'],</td>
</tr>
<tr class="secAll">
<td class="LineNum">74</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'country' =&gt; $order['customers_country'],</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">74</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'country' =&gt; <span class="ttSigDiff">array('title' =&gt; </span>$order['customers_country']<span class="ttSigDiff">)</span>,</td>
</tr>
<tr class="secBegin">
<td class="LineNum">75</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'format_id' =&gt; $order['customers_address_format_id'],</td>
<td class="AlignCenter">=</td>
<td class="LineNum">75</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'format_id' =&gt; $order['customers_address_format_id'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">76</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'telephone' =&gt; $order['customers_telephone'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">76</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'telephone' =&gt; $order['customers_telephone'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">77</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'email_address' =&gt; $order['customers_email_address']);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">77</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'email_address' =&gt; $order['customers_email_address']);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">78</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">78</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">79</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;delivery = array('name' =&gt; $order['delivery_name'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">79</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;delivery = array('name' =&gt; $order['delivery_name'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">80</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'company' =&gt; $order['delivery_company'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">80</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'company' =&gt; $order['delivery_company'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">81</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'street_address' =&gt; $order['delivery_street_address'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">81</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'street_address' =&gt; $order['delivery_street_address'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">82</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'suburb' =&gt; $order['delivery_suburb'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">82</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'suburb' =&gt; $order['delivery_suburb'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">83</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'city' =&gt; $order['delivery_city'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">83</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'city' =&gt; $order['delivery_city'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">84</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'postcode' =&gt; $order['delivery_postcode'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">84</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'postcode' =&gt; $order['delivery_postcode'],</td>
</tr>
<tr class="secEnd">
<td class="LineNum">85</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'state' =&gt; $order['delivery_state'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">85</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'state' =&gt; $order['delivery_state'],</td>
</tr>
<tr class="secAll">
<td class="LineNum">86</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'country' =&gt; $order['delivery_country'],</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">86</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'country' =&gt; <span class="ttSigDiff">array('title' =&gt; </span>$order['delivery_country']<span class="ttSigDiff">)</span>,</td>
</tr>
<tr class="secBegin">
<td class="LineNum">87</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'format_id' =&gt; $order['delivery_address_format_id']);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">87</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'format_id' =&gt; $order['delivery_address_format_id']);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">88</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">88</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">89</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (empty($this-&gt;delivery['name']) &amp;&amp; empty($this-&gt;delivery['street_address'])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">89</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (empty($this-&gt;delivery['name']) &amp;&amp; empty($this-&gt;delivery['street_address'])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">90</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;delivery = false;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">90</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;delivery = false;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">91</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">91</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">92</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">92</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">94</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'company' =&gt; $order['billing_company'],</td>
<td class="AlignCenter">=</td>
<td class="LineNum">94</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'company' =&gt; $order['billing_company'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">95</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'street_address' =&gt; $order['billing_street_address'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">95</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'street_address' =&gt; $order['billing_street_address'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">96</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'suburb' =&gt; $order['billing_suburb'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">96</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'suburb' =&gt; $order['billing_suburb'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">97</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'city' =&gt; $order['billing_city'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">97</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'city' =&gt; $order['billing_city'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">98</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'postcode' =&gt; $order['billing_postcode'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">98</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'postcode' =&gt; $order['billing_postcode'],</td>
</tr>
<tr class="secEnd">
<td class="LineNum">99</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'state' =&gt; $order['billing_state'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">99</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'state' =&gt; $order['billing_state'],</td>
</tr>
<tr class="secAll">
<td class="LineNum">100</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'country' =&gt; $order['billing_country'],</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">100</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'country' =&gt; <span class="ttSigDiff">array('title' =&gt; </span>$order['billing_country']<span class="ttSigDiff">)</span>,</td>
</tr>
<tr class="secBegin">
<td class="LineNum">101</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'format_id' =&gt; $order['billing_address_format_id']);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">101</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'format_id' =&gt; $order['billing_address_format_id']);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">102</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">102</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">103</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $index = 0;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">103</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $index = 0;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">104</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $orders_products_query = tep_db_query(&quot;select orders_products_id, products_id, products_name, products_model, products_price, products_tax, products_quantity, final_price from &quot; . TABLE_ORDERS_PRODUCTS . &quot; where orders_id = '&quot; . (int)$order_id . &quot;'&quot;);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">104</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $orders_products_query = tep_db_query(&quot;select orders_products_id, products_id, products_name, products_model, products_price, products_tax, products_quantity, final_price from &quot; . TABLE_ORDERS_PRODUCTS . &quot; where orders_id = '&quot; . (int)$order_id . &quot;'&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">105</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while ($orders_products = tep_db_fetch_array($orders_products_query)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">105</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while ($orders_products = tep_db_fetch_array($orders_products_query)) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">106</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;products[$index] = array('qty' =&gt; $orders_products['products_quantity'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">106</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;products[$index] = array('qty' =&gt; $orders_products['products_quantity'],</td>
</tr>
</table>

<h3>[BUGFIX] Shopping Cart Product Quantity as Integer Value</h3>

<p>The product quantity is added to the database shopping cart table as an integer so the value in the shopping cart session should also be treated as an integer.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/classes/shopping_cart.php</p>

<span class="affectedFiles">File: catalog/includes/classes/shopping_cart.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">103</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_session_register('new_products_id_in_cart');</td>
<td class="AlignCenter">=</td>
<td class="LineNum">103</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_session_register('new_products_id_in_cart');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">104</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">104</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">105</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">105</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">106</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($this-&gt;in_cart($products_id_string)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">106</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($this-&gt;in_cart($products_id_string)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">107</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;update_quantity($products_id_string, $qty, $attributes);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">107</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;update_quantity($products_id_string, $qty, $attributes);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">108</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">108</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secAll">
<td class="LineNum">109</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;contents[$products_id_string] = array('qty' =&gt; $qty);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">109</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;contents[$products_id_string] = array('qty' =&gt; <span class="ttSigDiff">(int)</span>$qty);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">110</td>
<td class="Normal">// insert into database</td>
<td class="AlignCenter">=</td>
<td class="LineNum">110</td>
<td class="Normal">// insert into database</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">111</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_session_is_registered('customer_id')) tep_db_query(&quot;insert into &quot; . TABLE_CUSTOMERS_BASKET . &quot; (customers_id, products_id, customers_basket_quantity, customers_basket_date_added) values ('&quot; . (int)$customer_id . &quot;', '&quot; . tep_db_input($products_id_string) . &quot;', '&quot; . (int)$qty . &quot;', '&quot; . date('Ymd') . &quot;')&quot;);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">111</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_session_is_registered('customer_id')) tep_db_query(&quot;insert into &quot; . TABLE_CUSTOMERS_BASKET . &quot; (customers_id, products_id, customers_basket_quantity, customers_basket_date_added) values ('&quot; . (int)$customer_id . &quot;', '&quot; . tep_db_input($products_id_string) . &quot;', '&quot; . (int)$qty . &quot;', '&quot; . date('Ymd') . &quot;')&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">112</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">112</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">113</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($attributes)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">113</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($attributes)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">114</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($attributes);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">114</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($attributes);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">115</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($option, $value) = each($attributes)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">115</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($option, $value) = each($attributes)) {</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">144</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">144</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">145</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">145</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">146</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">146</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">147</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">147</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">148</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">148</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">149</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_numeric($products_id) &amp;&amp; isset($this-&gt;contents[$products_id_string]) &amp;&amp; is_numeric($quantity) &amp;&amp; ($attributes_pass_check == true)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">149</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_numeric($products_id) &amp;&amp; isset($this-&gt;contents[$products_id_string]) &amp;&amp; is_numeric($quantity) &amp;&amp; ($attributes_pass_check == true)) {</td>
</tr>
<tr class="secAll">
<td class="LineNum">150</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;contents[$products_id_string] = array('qty' =&gt; $quantity);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">150</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;contents[$products_id_string] = array('qty' =&gt; <span class="ttSigDiff">(int)</span>$quantity);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">151</td>
<td class="Normal">// update database</td>
<td class="AlignCenter">=</td>
<td class="LineNum">151</td>
<td class="Normal">// update database</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">152</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_session_is_registered('customer_id')) tep_db_query(&quot;update &quot; . TABLE_CUSTOMERS_BASKET . &quot; set customers_basket_quantity = '&quot; . (int)$quantity . &quot;' where customers_id = '&quot; . (int)$customer_id . &quot;' and products_id = '&quot; . tep_db_input($products_id_string) . &quot;'&quot;);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">152</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_session_is_registered('customer_id')) tep_db_query(&quot;update &quot; . TABLE_CUSTOMERS_BASKET . &quot; set customers_basket_quantity = '&quot; . (int)$quantity . &quot;' where customers_id = '&quot; . (int)$customer_id . &quot;' and products_id = '&quot; . tep_db_input($products_id_string) . &quot;'&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">153</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">153</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">154</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($attributes)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">154</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($attributes)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">155</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($attributes);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">155</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($attributes);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">156</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($option, $value) = each($attributes)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">156</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($option, $value) = each($attributes)) {</td>
</tr>
</table>

<h3>[IMPROVEMENT] Maximum Order Product Quantities [+SQL]</h3>

<p>Add a new configuration parameter to control the maximum quantity number a product can be ordered (default 99).</p>

<p class="sqlBox"><b>Database Changes to Perform:</b><br />
INSERT INTO configuration (configuration_title, configuration_key, configuration_value, configuration_description, configuration_group_id, sort_order, date_added) VALUES ('Product Quantities In Shopping Cart', 'MAX_QTY_IN_CART', '99', 'Maximum number of product quantities that can be added to the shopping cart (0 for no limit)', '3', '19', now());</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/classes/shopping_cart.php</p>

<span class="affectedFiles">File: catalog/includes/classes/shopping_cart.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">78</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function add_cart($products_id, $qty = '1', $attributes = '', $notify = true) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">78</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function add_cart($products_id, $qty = '1', $attributes = '', $notify = true) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">79</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $new_products_id_in_cart, $customer_id;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">79</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $new_products_id_in_cart, $customer_id;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">80</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">80</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">81</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_id_string = tep_get_uprid($products_id, $attributes);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">81</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_id_string = tep_get_uprid($products_id, $attributes);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">82</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_id = tep_get_prid($products_id_string);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">82</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_id = tep_get_prid($products_id_string);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">83</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">83</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">84</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (defined('MAX_QTY_IN_CART') &amp;&amp; (MAX_QTY_IN_CART &gt; 0) &amp;&amp; ((int)$qty &gt; MAX_QTY_IN_CART)) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">85</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $qty = MAX_QTY_IN_CART;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">86</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">87</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">84</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $attributes_pass_check = true;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">88</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $attributes_pass_check = true;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">85</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">89</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">86</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($attributes)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">90</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($attributes)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">87</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($attributes);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">91</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($attributes);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">88</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($option, $value) = each($attributes)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">92</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($option, $value) = each($attributes)) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">89</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!is_numeric($option) || !is_numeric($value)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">93</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!is_numeric($option) || !is_numeric($value)) {</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">130</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">134</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">131</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function update_quantity($products_id, $quantity = '', $attributes = '') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">135</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function update_quantity($products_id, $quantity = '', $attributes = '') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">132</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $customer_id;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">136</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $customer_id;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">133</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">137</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">134</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_id_string = tep_get_uprid($products_id, $attributes);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">138</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_id_string = tep_get_uprid($products_id, $attributes);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">135</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_id = tep_get_prid($products_id_string);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">139</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_id = tep_get_prid($products_id_string);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">140</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">141</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (defined('MAX_QTY_IN_CART') &amp;&amp; (MAX_QTY_IN_CART &gt; 0) &amp;&amp; ((int)$quantity &gt; MAX_QTY_IN_CART)) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">142</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $quantity = MAX_QTY_IN_CART;</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">143</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">136</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">144</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">137</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $attributes_pass_check = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">145</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $attributes_pass_check = true;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">138</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">146</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">139</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($attributes)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">147</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($attributes)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">140</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($attributes);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">148</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($attributes);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">141</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($option, $value) = each($attributes)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">149</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($option, $value) = each($attributes)) {</td>
</tr>
</table>

<h3>[IMPROVEMENT] Accepting State Names</h3>

<p>Improve the logic of accepting state names.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/address_book_process.php<br />
catalog/checkout_payment_address.php<br />
catalog/checkout_shipping_address.php<br />
catalog/create_account.php</p>

<span class="affectedFiles">File: catalog/address_book_process.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">99</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (ACCOUNT_STATE == 'true') {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">99</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (ACCOUNT_STATE == 'true') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">100</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = 0;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">100</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = 0;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">101</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check_query = tep_db_query(&quot;select count(*) as total from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;'&quot;);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">101</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check_query = tep_db_query(&quot;select count(*) as total from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;'&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">102</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check = tep_db_fetch_array($check_query);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">102</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check = tep_db_fetch_array($check_query);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">103</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $entry_state_has_zones = ($check['total'] &gt; 0);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">103</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $entry_state_has_zones = ($check['total'] &gt; 0);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">104</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($entry_state_has_zones == true) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">104</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($entry_state_has_zones == true) {</td>
</tr>
<tr class="secAll">
<td class="LineNum">105</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_query = tep_db_query(&quot;select distinct zone_id from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;' and (zone_name <span class="ttSigDiff">lik</span><span class="ttSigDiff">e</span> '&quot; . tep_db_input($state) . &quot;<span class="ttSigDiff">%</span>' or zone_code <span class="ttSigDiff">lik</span><span class="ttSigDiff">e</span> '<span class="ttSigDiff">%</span>&quot; . tep_db_input($state) . &quot;<span class="ttSigDiff">%</span>')&quot;);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">105</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_query = tep_db_query(&quot;select distinct zone_id from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;' and (zone_name <span class="ttSigDiff">=</span> '&quot; . tep_db_input($state) . &quot;' or zone_code <span class="ttSigDiff">=</span> '&quot; . tep_db_input($state) . &quot;')&quot;);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">106</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_db_num_rows($zone_query) == 1) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">106</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_db_num_rows($zone_query) == 1) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">107</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone = tep_db_fetch_array($zone_query);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">107</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone = tep_db_fetch_array($zone_query);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">108</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = $zone['zone_id'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">108</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = $zone['zone_id'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">109</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">109</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">110</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $error = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">110</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $error = true;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">111</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">111</td>
<td class="Normal">&nbsp;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/checkout_payment_address.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">92</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ACCOUNT_STATE == 'true') {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">92</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ACCOUNT_STATE == 'true') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">93</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = 0;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">93</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = 0;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">94</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check_query = tep_db_query(&quot;select count(*) as total from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;'&quot;);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">94</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check_query = tep_db_query(&quot;select count(*) as total from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;'&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">95</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check = tep_db_fetch_array($check_query);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">95</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check = tep_db_fetch_array($check_query);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">96</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $entry_state_has_zones = ($check['total'] &gt; 0);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">96</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $entry_state_has_zones = ($check['total'] &gt; 0);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">97</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($entry_state_has_zones == true) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">97</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($entry_state_has_zones == true) {</td>
</tr>
<tr class="secAll">
<td class="LineNum">98</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_query = tep_db_query(&quot;select distinct zone_id from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;' and (zone_name <span class="ttSigDiff">lik</span><span class="ttSigDiff">e</span> '&quot; . tep_db_input($state) . &quot;<span class="ttSigDiff">%</span>' or zone_code <span class="ttSigDiff">lik</span><span class="ttSigDiff">e</span> '<span class="ttSigDiff">%</span>&quot; . tep_db_input($state) . &quot;<span class="ttSigDiff">%</span>')&quot;);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">98</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_query = tep_db_query(&quot;select distinct zone_id from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;' and (zone_name <span class="ttSigDiff">=</span> '&quot; . tep_db_input($state) . &quot;' or zone_code <span class="ttSigDiff">=</span> '&quot; . tep_db_input($state) . &quot;')&quot;);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">99</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_db_num_rows($zone_query) == 1) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">99</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_db_num_rows($zone_query) == 1) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">100</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone = tep_db_fetch_array($zone_query);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">100</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone = tep_db_fetch_array($zone_query);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">101</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = $zone['zone_id'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">101</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = $zone['zone_id'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">102</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">102</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">103</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $error = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">103</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $error = true;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">104</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">104</td>
<td class="Normal">&nbsp;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/checkout_shipping_address.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">105</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ACCOUNT_STATE == 'true') {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">105</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ACCOUNT_STATE == 'true') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">106</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = 0;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">106</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = 0;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">107</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check_query = tep_db_query(&quot;select count(*) as total from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;'&quot;);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">107</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check_query = tep_db_query(&quot;select count(*) as total from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;'&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">108</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check = tep_db_fetch_array($check_query);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">108</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check = tep_db_fetch_array($check_query);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">109</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $entry_state_has_zones = ($check['total'] &gt; 0);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">109</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $entry_state_has_zones = ($check['total'] &gt; 0);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">110</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($entry_state_has_zones == true) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">110</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($entry_state_has_zones == true) {</td>
</tr>
<tr class="secAll">
<td class="LineNum">111</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_query = tep_db_query(&quot;select distinct zone_id from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;' and (zone_name <span class="ttSigDiff">lik</span><span class="ttSigDiff">e</span> '&quot; . tep_db_input($state) . &quot;<span class="ttSigDiff">%</span>' or zone_code <span class="ttSigDiff">lik</span><span class="ttSigDiff">e</span> '<span class="ttSigDiff">%</span>&quot; . tep_db_input($state) . &quot;<span class="ttSigDiff">%</span>')&quot;);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">111</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_query = tep_db_query(&quot;select distinct zone_id from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;' and (zone_name <span class="ttSigDiff">=</span> '&quot; . tep_db_input($state) . &quot;' or zone_code <span class="ttSigDiff">=</span> '&quot; . tep_db_input($state) . &quot;')&quot;);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">112</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_db_num_rows($zone_query) == 1) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">112</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_db_num_rows($zone_query) == 1) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">113</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone = tep_db_fetch_array($zone_query);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">113</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone = tep_db_fetch_array($zone_query);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">114</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = $zone['zone_id'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">114</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = $zone['zone_id'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">115</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">115</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">116</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $error = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">116</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $error = true;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">117</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">117</td>
<td class="Normal">&nbsp;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/create_account.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">129</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (ACCOUNT_STATE == 'true') {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">129</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (ACCOUNT_STATE == 'true') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">130</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = 0;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">130</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = 0;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">131</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check_query = tep_db_query(&quot;select count(*) as total from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;'&quot;);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">131</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check_query = tep_db_query(&quot;select count(*) as total from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;'&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">132</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check = tep_db_fetch_array($check_query);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">132</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check = tep_db_fetch_array($check_query);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">133</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $entry_state_has_zones = ($check['total'] &gt; 0);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">133</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $entry_state_has_zones = ($check['total'] &gt; 0);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">134</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($entry_state_has_zones == true) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">134</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($entry_state_has_zones == true) {</td>
</tr>
<tr class="secAll">
<td class="LineNum">135</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_query = tep_db_query(&quot;select distinct zone_id from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;' and (zone_name <span class="ttSigDiff">lik</span><span class="ttSigDiff">e</span> '&quot; . tep_db_input($state) . &quot;<span class="ttSigDiff">%</span>' or zone_code <span class="ttSigDiff">lik</span><span class="ttSigDiff">e</span> '<span class="ttSigDiff">%</span>&quot; . tep_db_input($state) . &quot;<span class="ttSigDiff">%</span>')&quot;);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">135</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_query = tep_db_query(&quot;select distinct zone_id from &quot; . TABLE_ZONES . &quot; where zone_country_id = '&quot; . (int)$country . &quot;' and (zone_name <span class="ttSigDiff">=</span> '&quot; . tep_db_input($state) . &quot;' or zone_code <span class="ttSigDiff">=</span> '&quot; . tep_db_input($state) . &quot;')&quot;);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">136</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_db_num_rows($zone_query) == 1) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">136</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_db_num_rows($zone_query) == 1) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">137</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone = tep_db_fetch_array($zone_query);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">137</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone = tep_db_fetch_array($zone_query);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">138</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = $zone['zone_id'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">138</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $zone_id = $zone['zone_id'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">139</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">139</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">140</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $error = true;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">140</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $error = true;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">141</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">141</td>
<td class="Normal">&nbsp;</td>
</tr>
</table>

<h3>[BUGFIX] Load the Order Total Modules Before Loading the Payment Modules</h3>

<p>The order total modules should be loaded before the payment modules so the payment modules have access to the order total values.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/checkout_process.php</p>

<span class="affectedFiles">File: catalog/checkout_process.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">43</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'shipping.php');</td>
<td class="AlignCenter">=</td>
<td class="LineNum">43</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'shipping.php');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">44</td>
<td class="Normal">&nbsp; $shipping_modules = new shipping($shipping);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">44</td>
<td class="Normal">&nbsp; $shipping_modules = new shipping($shipping);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">45</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">45</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">46</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'order.php');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">46</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'order.php');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">47</td>
<td class="Normal">&nbsp; $order = new order;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">47</td>
<td class="Normal">&nbsp; $order = new order;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">48</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">48</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">49</td>
<td class="HasOrphan"><span class="ttSigDiff">// load the before_process function from the payment modules</span></td>
<td class="AlignCenter">+-</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">50</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; $payment_modules-&gt;before_process();</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">51</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">52</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'order_total.php');</td>
<td class="AlignCenter">=</td>
<td class="LineNum">49</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'order_total.php');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">53</td>
<td class="Normal">&nbsp; $order_total_modules = new order_total;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">50</td>
<td class="Normal">&nbsp; $order_total_modules = new order_total;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">54</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">51</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">55</td>
<td class="Normal">&nbsp; $order_totals = $order_total_modules-&gt;process();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">52</td>
<td class="Normal">&nbsp; $order_totals = $order_total_modules-&gt;process();</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">53</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">54</td>
<td class="HasOrphan"><span class="ttSigDiff">// load the before_process function from the payment modules</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">55</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; $payment_modules-&gt;before_process();</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">56</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">56</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">57</td>
<td class="Normal">&nbsp; $sql_data_array = array('customers_id' =&gt; $customer_id,</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">57</td>
<td class="Normal">&nbsp; $sql_data_array = array('customers_id' =&gt; $customer_id,</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">58</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'customers_name' =&gt; $order-&gt;customer['firstname'] . ' ' . $order-&gt;customer['lastname'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">58</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'customers_name' =&gt; $order-&gt;customer['firstname'] . ' ' . $order-&gt;customer['lastname'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">59</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'customers_company' =&gt; $order-&gt;customer['company'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">59</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'customers_company' =&gt; $order-&gt;customer['company'],</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">60</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'customers_street_address' =&gt; $order-&gt;customer['street_address'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">60</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'customers_street_address' =&gt; $order-&gt;customer['street_address'],</td>
</tr>
<tr class="secEnd">
<td class="LineNum">61</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'customers_suburb' =&gt; $order-&gt;customer['suburb'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">61</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'customers_suburb' =&gt; $order-&gt;customer['suburb'],</td>
</tr>
</table>

<h3>[BUGFIX] Payment Module Selection</h3>

<p>Pass the selected module code to its radio button to have it selected by default if a payment method has already been selected.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/checkout_payment.php</p>

<span class="affectedFiles">File: catalog/checkout_payment.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">255</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">255</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">256</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td width=&quot;10&quot;&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '10', '1'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">256</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td width=&quot;10&quot;&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '10', '1'); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">257</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot; colspan=&quot;3&quot;&gt;&lt;b&gt;&lt;?php echo $selection[$i]['module']; ?&gt;&lt;/b&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">257</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot; colspan=&quot;3&quot;&gt;&lt;b&gt;&lt;?php echo $selection[$i]['module']; ?&gt;&lt;/b&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">258</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot; align=&quot;right&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">258</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot; align=&quot;right&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">259</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">259</td>
<td class="Normal">&lt;?php</td>
</tr>
<tr class="secEnd">
<td class="LineNum">260</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (sizeof($selection) &gt; 1) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">260</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (sizeof($selection) &gt; 1) {</td>
</tr>
<tr class="secAll">
<td class="LineNum">261</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo tep_draw_radio_field('payment', $selection[$i]['id']);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">261</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo tep_draw_radio_field('payment', $selection[$i]['id']<span class="ttSigDiff">, ($selection[$i]['id'] == $payment)</span>);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">262</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">262</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">263</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo tep_draw_hidden_field('payment', $selection[$i]['id']);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">263</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo tep_draw_hidden_field('payment', $selection[$i]['id']);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">264</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">264</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">265</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">265</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">266</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">266</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">267</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td width=&quot;10&quot;&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '10', '1'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">267</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td width=&quot;10&quot;&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '10', '1'); ?&gt;&lt;/td&gt;</td>
</tr>
</table>

<h3>[BUGFIX] Category Image Removal</h3>

<p>Don't delete the category image when editing its values without uploading a new image.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/categories.php</p>

<span class="affectedFiles">File: catalog/admin/categories.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">74</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_perform(TABLE_CATEGORIES_DESCRIPTION, $sql_data_array);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">74</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_perform(TABLE_CATEGORIES_DESCRIPTION, $sql_data_array);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">75</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif ($action == 'update_category') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">75</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif ($action == 'update_category') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">76</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_perform(TABLE_CATEGORIES_DESCRIPTION, $sql_data_array, 'update', &quot;categories_id = '&quot; . (int)$categories_id . &quot;' and language_id = '&quot; . (int)$languages[$i]['id'] . &quot;'&quot;);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">76</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_perform(TABLE_CATEGORIES_DESCRIPTION, $sql_data_array, 'update', &quot;categories_id = '&quot; . (int)$categories_id . &quot;' and language_id = '&quot; . (int)$languages[$i]['id'] . &quot;'&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">77</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">77</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">78</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">78</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">79</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">79</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">80</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">if (</span>$categories_image = new upload('categories_image'<span class="ttSigDiff">, DIR_FS_CATALOG_IMAGES</span>)<span class="ttSigDiff">)</span><span class="ttSigDiff"> {</span></td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">80</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $categories_image = new upload('categories_image')<span class="ttSigDiff">;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">81</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $categories_image-&gt;set_destination(DIR_FS_CATALOG_IMAGES);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">82</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">83</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($categories_image-&gt;parse() &amp;&amp; $categories_image-&gt;save()) {</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">81</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;update &quot; . TABLE_CATEGORIES . &quot; set categories_image = '&quot; . tep_db_input($categories_image-&gt;filename) . &quot;' where categories_id = '&quot; . (int)$categories_id . &quot;'&quot;);</td>
<td class="AlignCenter">=</td>
<td class="LineNum">84</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&quot;update &quot; . TABLE_CATEGORIES . &quot; set categories_image = '&quot; . tep_db_input($categories_image-&gt;filename) . &quot;' where categories_id = '&quot; . (int)$categories_id . &quot;'&quot;);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">82</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">85</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">83</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">86</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">84</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (USE_CACHE == 'true') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">87</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (USE_CACHE == 'true') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">85</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_reset_cache_block('categories');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">88</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_reset_cache_block('categories');</td>
</tr>
<tr class="secEnd">
<td class="LineNum">86</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_reset_cache_block('also_purchased');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">89</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_reset_cache_block('also_purchased');</td>
</tr>
</table>

<h3>[BUGFIX] Add the Session ID to GET Based Forms</h3>

<p>Add the session ID to GET based forms incase the browser has cookies disabled.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/index.php<br />
catalog/admin/includes/classes/split_page_results.php<br />
catalog/admin/includes/functions/html_output.php<br />
catalog/admin/banner_statistics.php<br />
catalog/admin/categories.php<br />
catalog/admin/customers.php<br />
catalog/admin/define_language.php<br />
catalog/admin/file_manager.php<br />
catalog/admin/index.php<br />
catalog/admin/orders.php</p>

<span class="affectedFiles">File: catalog/index.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">250</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">250</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">251</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo tep_draw_hidden_field('sort', $HTTP_GET_VARS['sort']);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">251</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo tep_draw_hidden_field('sort', $HTTP_GET_VARS['sort']);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">252</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while ($filterlist = tep_db_fetch_array($filterlist_query)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">252</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while ($filterlist = tep_db_fetch_array($filterlist_query)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">253</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $options[] = array('id' =&gt; $filterlist['id'], 'text' =&gt; $filterlist['name']);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">253</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $options[] = array('id' =&gt; $filterlist['id'], 'text' =&gt; $filterlist['name']);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">254</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">254</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">255</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo tep_draw_pull_down_menu('filter_id', $options, (isset($HTTP_GET_VARS['filter_id']) ? $HTTP_GET_VARS['filter_id'] : ''), 'onchange=&quot;this.form.submit()&quot;');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">255</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo tep_draw_pull_down_menu('filter_id', $options, (isset($HTTP_GET_VARS['filter_id']) ? $HTTP_GET_VARS['filter_id'] : ''), 'onchange=&quot;this.form.submit()&quot;');</td>
</tr>
<tr class="secAll">
<td class="LineNum">256</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo '&lt;/form&gt;&lt;/td&gt;' . &quot;\n&quot;;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">256</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo <span class="ttSigDiff">tep_hide_session_id() . </span>'&lt;/form&gt;&lt;/td&gt;' . &quot;\n&quot;;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">257</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">257</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">258</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">258</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">259</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">259</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">260</td>
<td class="Normal">// Get the right image for the top-right</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">260</td>
<td class="Normal">// Get the right image for the top-right</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">261</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $image = DIR_WS_IMAGES . 'table_background_list.gif';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">261</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $image = DIR_WS_IMAGES . 'table_background_list.gif';</td>
</tr>
<tr class="secEnd">
<td class="LineNum">262</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (isset($HTTP_GET_VARS['manufacturers_id'])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">262</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (isset($HTTP_GET_VARS['manufacturers_id'])) {</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/classes/split_page_results.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">74</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list(, $pair) = each($pairs)) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">74</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list(, $pair) = each($pairs)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">75</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; list($key,$value) = explode('=', $pair);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">75</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; list($key,$value) = explode('=', $pair);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">76</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $display_links .= tep_draw_hidden_field(rawurldecode($key), rawurldecode($value));</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">76</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $display_links .= tep_draw_hidden_field(rawurldecode($key), rawurldecode($value));</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">77</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">77</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">78</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">78</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">79</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">79</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">80</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (SID) $display_links .= tep_draw_hidden_field(tep_session_name(), tep_session_id());</span></td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">81</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">82</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $display_links .= '&lt;/form&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">80</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $display_links .= <span class="ttSigDiff">tep_hide_session_id() . </span>'&lt;/form&gt;';</td>
</tr>
<tr class="secBegin">
<td class="LineNum">83</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">81</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">84</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $display_links = sprintf(TEXT_RESULT_PAGE, $num_pages, $num_pages);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">82</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $display_links = sprintf(TEXT_RESULT_PAGE, $num_pages, $num_pages);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">85</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">83</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">86</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">84</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">87</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $display_links;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">85</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $display_links;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">88</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">86</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/functions/html_output.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">289</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">289</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field .= '&gt;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">290</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">290</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">291</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $field;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">291</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; return $field;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">292</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">292</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">293</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">293</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">294</td>
<td class="Normal">////</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">294</td>
<td class="Normal">////</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">295</td>
<td class="HasOrphan"><span class="ttSigDiff">// Hide form elements</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">296</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; function tep_hide_session_id() {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">297</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $string = '';</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">298</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">299</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; if (defined('SID') &amp;&amp; tep_not_null(SID)) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">300</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $string = tep_draw_hidden_field(tep_session_name(), tep_session_id());</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">301</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">302</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">303</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; return $string;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">304</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">305</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">306</td>
<td class="HasOrphan"><span class="ttSigDiff">////</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">295</td>
<td class="Normal">// Output a form pull down menu</td>
<td class="AlignCenter">=</td>
<td class="LineNum">307</td>
<td class="Normal">// Output a form pull down menu</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">296</td>
<td class="Normal">&nbsp; function tep_draw_pull_down_menu($name, $values, $default = '', $parameters = '', $required = false) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">308</td>
<td class="Normal">&nbsp; function tep_draw_pull_down_menu($name, $values, $default = '', $parameters = '', $required = false) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">297</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $HTTP_POST_VARS;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">309</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; global $HTTP_GET_VARS, $HTTP_POST_VARS;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">298</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">310</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">299</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;select name=&quot;' . tep_output_string($name) . '&quot;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">311</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $field = '&lt;select name=&quot;' . tep_output_string($name) . '&quot;';</td>
</tr>
<tr class="secEnd">
<td class="LineNum">300</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">312</td>
<td class="Normal">&nbsp;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/banner_statistics.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">91</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; case 'daily':</td>
<td class="AlignCenter">=</td>
<td class="LineNum">91</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; case 'daily':</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">92</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo TITLE_MONTH . ' ' . tep_draw_pull_down_menu('month', $months_array, (isset($HTTP_GET_VARS['month']) ? $HTTP_GET_VARS['month'] : date('n')), 'onChange=&quot;this.form.submit();&quot;') . '&lt;noscript&gt;&lt;input type=&quot;submit&quot; value=&quot;GO&quot;&gt;&lt;/noscript&gt;&lt;br&gt;' . TITLE_YEAR . ' ' . tep_draw_pull_down_menu('year', $years_array, (isset($HTTP_GET_VARS['year']) ? $HTTP_GET_VARS['year'] : date('Y')), 'onChange=&quot;this.form.submit();&quot;') . '&lt;noscript&gt;&lt;input type=&quot;submit&quot; value=&quot;GO&quot;&gt;&lt;/noscript&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">92</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo TITLE_MONTH . ' ' . tep_draw_pull_down_menu('month', $months_array, (isset($HTTP_GET_VARS['month']) ? $HTTP_GET_VARS['month'] : date('n')), 'onChange=&quot;this.form.submit();&quot;') . '&lt;noscript&gt;&lt;input type=&quot;submit&quot; value=&quot;GO&quot;&gt;&lt;/noscript&gt;&lt;br&gt;' . TITLE_YEAR . ' ' . tep_draw_pull_down_menu('year', $years_array, (isset($HTTP_GET_VARS['year']) ? $HTTP_GET_VARS['year'] : date('Y')), 'onChange=&quot;this.form.submit();&quot;') . '&lt;noscript&gt;&lt;input type=&quot;submit&quot; value=&quot;GO&quot;&gt;&lt;/noscript&gt;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">93</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">93</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">94</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">94</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">95</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">95</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">96</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">96</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;</td>
</tr>
<tr class="secAll">
<td class="LineNum">97</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;?php echo tep_draw_hidden_field('page', $HTTP_GET_VARS['page']) . tep_draw_hidden_field('bID', $HTTP_GET_VARS['bID']); ?&gt;&lt;/form&gt;&lt;/tr&gt;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">97</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;?php echo tep_draw_hidden_field('page', $HTTP_GET_VARS['page']) . tep_draw_hidden_field('bID', $HTTP_GET_VARS['bID'])<span class="ttSigDiff"> . tep_hide_session_id()</span>; ?&gt;&lt;/form&gt;&lt;/tr&gt;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">98</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">98</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">99</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">99</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">100</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">100</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">101</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '1', '10'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">101</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '1', '10'); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">102</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">102</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">103</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">103</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/categories.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">740</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">740</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">741</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">741</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">742</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;smallText&quot; align=&quot;right&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">742</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;smallText&quot; align=&quot;right&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">743</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">743</td>
<td class="Normal">&lt;?php</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">744</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; echo tep_draw_form('search', FILENAME_CATEGORIES, '', 'get');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">744</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; echo tep_draw_form('search', FILENAME_CATEGORIES, '', 'get');</td>
</tr>
<tr class="secEnd">
<td class="LineNum">745</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; echo HEADING_TITLE_SEARCH . ' ' . tep_draw_input_field('search');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">745</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; echo HEADING_TITLE_SEARCH . ' ' . tep_draw_input_field('search');</td>
</tr>
<tr class="secAll">
<td class="LineNum">746</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; echo '&lt;/form&gt;';</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">746</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; echo <span class="ttSigDiff">tep_hide_session_id() . </span>'&lt;/form&gt;';</td>
</tr>
<tr class="secBegin">
<td class="LineNum">747</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">747</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">748</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">748</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">749</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">749</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">750</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">750</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">751</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;smallText&quot; align=&quot;right&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">751</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;smallText&quot; align=&quot;right&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">752</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">752</td>
<td class="Normal">&lt;?php</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">753</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; echo tep_draw_form('goto', FILENAME_CATEGORIES, '', 'get');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">753</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; echo tep_draw_form('goto', FILENAME_CATEGORIES, '', 'get');</td>
</tr>
<tr class="secEnd">
<td class="LineNum">754</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; echo HEADING_TITLE_GOTO . ' ' . tep_draw_pull_down_menu('cPath', tep_get_category_tree(), $current_category_id, 'onChange=&quot;this.form.submit();&quot;');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">754</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; echo HEADING_TITLE_GOTO . ' ' . tep_draw_pull_down_menu('cPath', tep_get_category_tree(), $current_category_id, 'onChange=&quot;this.form.submit();&quot;');</td>
</tr>
<tr class="secAll">
<td class="LineNum">755</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; echo '&lt;/form&gt;';</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">755</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; echo <span class="ttSigDiff">tep_hide_session_id() . </span>'&lt;/form&gt;';</td>
</tr>
<tr class="secBegin">
<td class="LineNum">756</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">756</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">757</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">757</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">758</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">758</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">759</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">759</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">760</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">760</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">761</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">761</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/customers.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">694</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">694</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">695</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">695</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">696</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;&lt;?php echo tep_draw_form('search', FILENAME_CUSTOMERS, '', 'get'); ?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">696</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;&lt;?php echo tep_draw_form('search', FILENAME_CUSTOMERS, '', 'get'); ?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">697</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot;&gt;&lt;?php echo HEADING_TITLE; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">697</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot;&gt;&lt;?php echo HEADING_TITLE; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">698</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot; align=&quot;right&quot;&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', 1, HEADING_IMAGE_HEIGHT); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">698</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot; align=&quot;right&quot;&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', 1, HEADING_IMAGE_HEIGHT); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">699</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;smallText&quot; align=&quot;right&quot;&gt;&lt;?php echo HEADING_TITLE_SEARCH . ' ' . tep_draw_input_field('search'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">699</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;smallText&quot; align=&quot;right&quot;&gt;&lt;?php echo HEADING_TITLE_SEARCH . ' ' . tep_draw_input_field('search'); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secAll">
<td class="LineNum">700</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/form&gt;&lt;/tr&gt;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">700</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span class="ttSigDiff">?php echo tep_hide_session_id(); ?&gt;&lt;</span>/form&gt;&lt;/tr&gt;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">701</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">701</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">702</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">702</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">703</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">703</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">704</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">704</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">705</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">705</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">706</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td valign=&quot;top&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">706</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td valign=&quot;top&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/define_language.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">81</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">81</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">82</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">82</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">83</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;&lt;?php echo tep_draw_form('lng', FILENAME_DEFINE_LANGUAGE, '', 'get'); ?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">83</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;&lt;?php echo tep_draw_form('lng', FILENAME_DEFINE_LANGUAGE, '', 'get'); ?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">84</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot;&gt;&lt;?php echo HEADING_TITLE; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">84</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot;&gt;&lt;?php echo HEADING_TITLE; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">85</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot; align=&quot;right&quot;&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '1', HEADING_IMAGE_HEIGHT); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">85</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot; align=&quot;right&quot;&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '1', HEADING_IMAGE_HEIGHT); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">86</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot; align=&quot;right&quot;&gt;&lt;?php echo tep_draw_pull_down_menu('lngdir', $languages_array, $language, 'onChange=&quot;this.form.submit();&quot;'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">86</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot; align=&quot;right&quot;&gt;&lt;?php echo tep_draw_pull_down_menu('lngdir', $languages_array, $language, 'onChange=&quot;this.form.submit();&quot;'); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secAll">
<td class="LineNum">87</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/form&gt;&lt;/tr&gt;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">87</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span class="ttSigDiff">?php echo tep_hide_session_id(); ?&gt;&lt;</span>/form&gt;&lt;/tr&gt;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">88</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">88</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">89</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">89</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">90</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">90</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">91</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">91</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">92</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">92</td>
<td class="Normal">&lt;?php</td>
</tr>
<tr class="secEnd">
<td class="LineNum">93</td>
<td class="Normal">&nbsp; if (isset($HTTP_GET_VARS['lngdir']) &amp;&amp; isset($HTTP_GET_VARS['filename'])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">93</td>
<td class="Normal">&nbsp; if (isset($HTTP_GET_VARS['lngdir']) &amp;&amp; isset($HTTP_GET_VARS['filename'])) {</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/file_manager.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">129</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">129</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">130</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td width=&quot;100%&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">130</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td width=&quot;100%&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">131</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;&lt;?php echo tep_draw_form('goto', FILENAME_FILE_MANAGER, '', 'get'); ?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">131</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;&lt;?php echo tep_draw_form('goto', FILENAME_FILE_MANAGER, '', 'get'); ?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">132</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot;&gt;&lt;?php echo HEADING_TITLE . '&lt;br&gt;&lt;span class=&quot;smallText&quot;&gt;' . $current_path . '&lt;/span&gt;'; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">132</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot;&gt;&lt;?php echo HEADING_TITLE . '&lt;br&gt;&lt;span class=&quot;smallText&quot;&gt;' . $current_path . '&lt;/span&gt;'; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">133</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot; align=&quot;right&quot;&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '1', HEADING_IMAGE_HEIGHT); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">133</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot; align=&quot;right&quot;&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '1', HEADING_IMAGE_HEIGHT); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">134</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot; align=&quot;right&quot;&gt;&lt;?php echo tep_draw_pull_down_menu('goto', $goto_array, $current_path, 'onChange=&quot;this.form.submit();&quot;'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">134</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot; align=&quot;right&quot;&gt;&lt;?php echo tep_draw_pull_down_menu('goto', $goto_array, $current_path, 'onChange=&quot;this.form.submit();&quot;'); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secAll">
<td class="LineNum">135</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/form&gt;&lt;/tr&gt;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">135</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span class="ttSigDiff">?php echo tep_hide_session_id(); ?&gt;&lt;</span>/form&gt;&lt;/tr&gt;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">136</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">136</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">137</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">137</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">138</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">138</td>
<td class="Normal">&lt;?php</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">139</td>
<td class="Normal">&nbsp; if ( (($action == 'new_file') &amp;&amp; ($directory_writeable == true)) || ($action == 'edit') ) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">139</td>
<td class="Normal">&nbsp; if ( (($action == 'new_file') &amp;&amp; ($directory_writeable == true)) || ($action == 'edit') ) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">140</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (isset($HTTP_GET_VARS['info']) &amp;&amp; strstr($HTTP_GET_VARS['info'], '..')) tep_redirect(tep_href_link(FILENAME_FILE_MANAGER));</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">140</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (isset($HTTP_GET_VARS['info']) &amp;&amp; strstr($HTTP_GET_VARS['info'], '..')) tep_redirect(tep_href_link(FILENAME_FILE_MANAGER));</td>
</tr>
<tr class="secEnd">
<td class="LineNum">141</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">141</td>
<td class="Normal">&nbsp;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/index.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">189</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td width=&quot;460&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;460&quot; height=&quot;390&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">189</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td width=&quot;460&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;460&quot; height=&quot;390&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">190</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">190</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">191</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&quot;2&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">191</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&quot;2&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">192</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;&lt;?php echo tep_draw_form('languages', 'index.php', '', 'get'); ?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">192</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;&lt;?php echo tep_draw_form('languages', 'index.php', '', 'get'); ?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">193</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;heading&quot;&gt;&lt;?php echo HEADING_TITLE; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">193</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;heading&quot;&gt;&lt;?php echo HEADING_TITLE; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">194</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot;&gt;&lt;?php echo tep_draw_pull_down_menu('language', $languages_array, $languages_selected, 'onChange=&quot;this.form.submit();&quot;'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">194</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot;&gt;&lt;?php echo tep_draw_pull_down_menu('language', $languages_array, $languages_selected, 'onChange=&quot;this.form.submit();&quot;'); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secAll">
<td class="LineNum">195</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/form&gt;&lt;/tr&gt;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">195</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span class="ttSigDiff">?php echo tep_hide_session_id(); ?&gt;&lt;</span>/form&gt;&lt;/tr&gt;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">196</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">196</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">197</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">197</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">198</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">198</td>
<td class="Normal">&lt;?php</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">199</td>
<td class="Normal">&nbsp; $col = 2;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">199</td>
<td class="Normal">&nbsp; $col = 2;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">200</td>
<td class="Normal">&nbsp; $counter = 0;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">200</td>
<td class="Normal">&nbsp; $counter = 0;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">201</td>
<td class="Normal">&nbsp; for ($i = 0, $n = sizeof($cat); $i &lt; $n; $i++) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">201</td>
<td class="Normal">&nbsp; for ($i = 0, $n = sizeof($cat); $i &lt; $n; $i++) {</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/orders.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">328</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">328</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">329</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot;&gt;&lt;?php echo HEADING_TITLE; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">329</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot;&gt;&lt;?php echo HEADING_TITLE; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">330</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot; align=&quot;right&quot;&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', 1, HEADING_IMAGE_HEIGHT); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">330</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;pageHeading&quot; align=&quot;right&quot;&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', 1, HEADING_IMAGE_HEIGHT); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">331</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">331</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot;&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">332</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;&lt;?php echo tep_draw_form('orders', FILENAME_ORDERS, '', 'get'); ?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">332</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;&lt;?php echo tep_draw_form('orders', FILENAME_ORDERS, '', 'get'); ?&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">333</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;smallText&quot; align=&quot;right&quot;&gt;&lt;?php echo HEADING_TITLE_SEARCH . ' ' . tep_draw_input_field('oID', '', 'size=&quot;12&quot;') . tep_draw_hidden_field('action', 'edit'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">333</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;smallText&quot; align=&quot;right&quot;&gt;&lt;?php echo HEADING_TITLE_SEARCH . ' ' . tep_draw_input_field('oID', '', 'size=&quot;12&quot;') . tep_draw_hidden_field('action', 'edit'); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secAll">
<td class="LineNum">334</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/form&gt;&lt;/tr&gt;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">334</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span class="ttSigDiff">?php echo tep_hide_session_id(); ?&gt;&lt;</span>/form&gt;&lt;/tr&gt;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">335</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;&lt;?php echo tep_draw_form('status', FILENAME_ORDERS, '', 'get'); ?&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">335</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;&lt;?php echo tep_draw_form('status', FILENAME_ORDERS, '', 'get'); ?&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">336</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;smallText&quot; align=&quot;right&quot;&gt;&lt;?php echo HEADING_TITLE_STATUS . ' ' . tep_draw_pull_down_menu('status', array_merge(array(array('id' =&gt; '', 'text' =&gt; TEXT_ALL_ORDERS)), $orders_statuses), '', 'onChange=&quot;this.form.submit();&quot;'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">336</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;smallText&quot; align=&quot;right&quot;&gt;&lt;?php echo HEADING_TITLE_STATUS . ' ' . tep_draw_pull_down_menu('status', array_merge(array(array('id' =&gt; '', 'text' =&gt; TEXT_ALL_ORDERS)), $orders_statuses), '', 'onChange=&quot;this.form.submit();&quot;'); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secAll">
<td class="LineNum">337</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/form&gt;&lt;/tr&gt;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">337</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span class="ttSigDiff">?php echo tep_hide_session_id(); ?&gt;&lt;</span>/form&gt;&lt;/tr&gt;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">338</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">338</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">339</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">339</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">340</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">340</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">341</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">341</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">342</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">342</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">343</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">343</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</td>
</tr>
</table>

<h3>[BUGFIX] Fix Typo on the Products New Page</h3>

<p>Fix typo on the products new page.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/products_new.php</p>

<span class="affectedFiles">File: catalog/products_new.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">87</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">87</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">88</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td width=&quot;&lt;?php echo SMALL_IMAGE_WIDTH + 10; ?&gt;&quot; valign=&quot;top&quot; class=&quot;main&quot;&gt;&lt;?php echo '&lt;a href=&quot;' . tep_href_link(FILENAME_PRODUCT_INFO, 'products_id=' . $products_new['products_id']) . '&quot;&gt;' . tep_image(DIR_WS_IMAGES . $products_new['products_image'], $products_new['products_name'], SMALL_IMAGE_WIDTH, SMALL_IMAGE_HEIGHT) . '&lt;/a&gt;'; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">88</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td width=&quot;&lt;?php echo SMALL_IMAGE_WIDTH + 10; ?&gt;&quot; valign=&quot;top&quot; class=&quot;main&quot;&gt;&lt;?php echo '&lt;a href=&quot;' . tep_href_link(FILENAME_PRODUCT_INFO, 'products_id=' . $products_new['products_id']) . '&quot;&gt;' . tep_image(DIR_WS_IMAGES . $products_new['products_image'], $products_new['products_name'], SMALL_IMAGE_WIDTH, SMALL_IMAGE_HEIGHT) . '&lt;/a&gt;'; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">89</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td valign=&quot;top&quot; class=&quot;main&quot;&gt;&lt;?php echo '&lt;a href=&quot;' . tep_href_link(FILENAME_PRODUCT_INFO, 'products_id=' . $products_new['products_id']) . '&quot;&gt;&lt;b&gt;&lt;u&gt;' . $products_new['products_name'] . '&lt;/u&gt;&lt;/b&gt;&lt;/a&gt;&lt;br&gt;' . TEXT_DATE_ADDED . ' ' . tep_date_long($products_new['products_date_added']) . '&lt;br&gt;' . TEXT_MANUFACTURER . ' ' . $products_new['manufacturers_name'] . '&lt;br&gt;&lt;br&gt;' . TEXT_PRICE . ' ' . $products_price; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">89</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td valign=&quot;top&quot; class=&quot;main&quot;&gt;&lt;?php echo '&lt;a href=&quot;' . tep_href_link(FILENAME_PRODUCT_INFO, 'products_id=' . $products_new['products_id']) . '&quot;&gt;&lt;b&gt;&lt;u&gt;' . $products_new['products_name'] . '&lt;/u&gt;&lt;/b&gt;&lt;/a&gt;&lt;br&gt;' . TEXT_DATE_ADDED . ' ' . tep_date_long($products_new['products_date_added']) . '&lt;br&gt;' . TEXT_MANUFACTURER . ' ' . $products_new['manufacturers_name'] . '&lt;br&gt;&lt;br&gt;' . TEXT_PRICE . ' ' . $products_price; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">90</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot; valign=&quot;middle&quot; class=&quot;main&quot;&gt;&lt;?php echo '&lt;a href=&quot;' . tep_href_link(FILENAME_PRODUCTS_NEW, tep_get_all_get_params(array('action')) . 'action=buy_now&amp;products_id=' . $products_new['products_id']) . '&quot;&gt;' . tep_image_button('button_in_cart.gif', IMAGE_BUTTON_IN_CART) . '&lt;/a&gt;'; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">90</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot; valign=&quot;middle&quot; class=&quot;main&quot;&gt;&lt;?php echo '&lt;a href=&quot;' . tep_href_link(FILENAME_PRODUCTS_NEW, tep_get_all_get_params(array('action')) . 'action=buy_now&amp;products_id=' . $products_new['products_id']) . '&quot;&gt;' . tep_image_button('button_in_cart.gif', IMAGE_BUTTON_IN_CART) . '&lt;/a&gt;'; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">91</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">91</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">92</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">92</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secAll">
<td class="LineNum">93</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colsp<span class="ttSigDiff">ü</span>an=&quot;3&quot;&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '100%', '10'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">93</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&quot;3&quot;&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '100%', '10'); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">94</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">94</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">95</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">95</td>
<td class="Normal">&lt;?php</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">96</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">96</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">97</td>
<td class="Normal">&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">97</td>
<td class="Normal">&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">98</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">98</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">99</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">99</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
</table>


<h3>[BUGFIX] Process the Order Total Modules Earlier on the Checkout Confirmation Page</h3>

<p>Process the order total modules on the checkout confirmation page.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/checkout_confirmation.php</p>

<span class="affectedFiles">File: catalog/checkout_confirmation.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">63</td>
<td class="Normal">// load the selected shipping module</td>
<td class="AlignCenter">=</td>
<td class="LineNum">63</td>
<td class="Normal">// load the selected shipping module</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">64</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'shipping.php');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">64</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'shipping.php');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">65</td>
<td class="Normal">&nbsp; $shipping_modules = new shipping($shipping);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">65</td>
<td class="Normal">&nbsp; $shipping_modules = new shipping($shipping);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">66</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">66</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">67</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'order_total.php');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">67</td>
<td class="Normal">&nbsp; require(DIR_WS_CLASSES . 'order_total.php');</td>
</tr>
<tr class="secEnd">
<td class="LineNum">68</td>
<td class="Normal">&nbsp; $order_total_modules = new order_total;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">68</td>
<td class="Normal">&nbsp; $order_total_modules = new order_total;</td>
</tr>
<tr class="secAll">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">69</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp; $order_total_modules-&gt;process();</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">69</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">70</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">70</td>
<td class="Normal">// Stock Check</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">71</td>
<td class="Normal">// Stock Check</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">71</td>
<td class="Normal">&nbsp; $any_out_of_stock = false;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">72</td>
<td class="Normal">&nbsp; $any_out_of_stock = false;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">72</td>
<td class="Normal">&nbsp; if (STOCK_CHECK == 'true') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">73</td>
<td class="Normal">&nbsp; if (STOCK_CHECK == 'true') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">73</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($order-&gt;products); $i&lt;$n; $i++) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">74</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($order-&gt;products); $i&lt;$n; $i++) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">74</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_check_stock($order-&gt;products[$i]['id'], $order-&gt;products[$i]['qty'])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">75</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_check_stock($order-&gt;products[$i]['id'], $order-&gt;products[$i]['qty'])) {</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">234</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;?php echo $order-&gt;info['payment_method']; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">235</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&quot;main&quot;&gt;&lt;?php echo $order-&gt;info['payment_method']; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">235</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">236</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">236</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">237</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">237</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td width=&quot;70%&quot; valign=&quot;top&quot; align=&quot;right&quot;&gt;&lt;table border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">238</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td width=&quot;70%&quot; valign=&quot;top&quot; align=&quot;right&quot;&gt;&lt;table border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;2&quot;&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">238</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">239</td>
<td class="Normal">&lt;?php</td>
</tr>
<tr class="secEnd">
<td class="LineNum">239</td>
<td class="Normal">&nbsp; if (MODULE_ORDER_TOTAL_INSTALLED) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">240</td>
<td class="Normal">&nbsp; if (MODULE_ORDER_TOTAL_INSTALLED) {</td>
</tr>
<tr class="secAll">
<td class="LineNum">240</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; $order_total_modules-&gt;process();</span></td>
<td class="AlignCenter">+-</td>
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">241</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; echo $order_total_modules-&gt;output();</td>
<td class="AlignCenter">=</td>
<td class="LineNum">241</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; echo $order_total_modules-&gt;output();</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">242</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">242</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">243</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">243</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">244</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">244</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">245</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">245</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">246</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">246</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
</tr>
</table>


<h3>[BUGFIX] PHP &lt; 4.1 Compatibility Update</h3>

<p>Use $HTTP_SERVER_VARS instead of $_SERVER.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/functions/general.php</p>

<span class="affectedFiles">File: catalog/includes/functions/general.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">1221</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">1221</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1222</td>
<td class="Normal">&nbsp; function tep_setcookie($name, $value = '', $expire = 0, $path = '/', $domain = '', $secure = 0) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1222</td>
<td class="Normal">&nbsp; function tep_setcookie($name, $value = '', $expire = 0, $path = '/', $domain = '', $secure = 0) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1223</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; setcookie($name, $value, $expire, $path, (tep_not_null($domain) ? $domain : ''), $secure);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1223</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; setcookie($name, $value, $expire, $path, (tep_not_null($domain) ? $domain : ''), $secure);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1224</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1224</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1225</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1225</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">1226</td>
<td class="Normal">&nbsp; function tep_get_ip_address() {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1226</td>
<td class="Normal">&nbsp; function tep_get_ip_address() {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">1227</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; global $HTTP_SERVER_VARS;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1228</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1227</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (isset($_SERVER)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1229</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; if (isset($<span class="ttSigDiff">HTTP</span>_SERVER<span class="ttSigDiff">_VARS</span>)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1228</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($_SERVER['HTTP_X_FORWARDED_FOR'])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1230</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($<span class="ttSigDiff">HTTP</span>_SERVER<span class="ttSigDiff">_VARS</span>['HTTP_X_FORWARDED_FOR'])) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1229</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ip = $_SERVER['HTTP_X_FORWARDED_FOR'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1231</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ip = $<span class="ttSigDiff">HTTP</span>_SERVER<span class="ttSigDiff">_VARS</span>['HTTP_X_FORWARDED_FOR'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1230</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (isset($_SERVER['HTTP_CLIENT_IP'])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1232</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (isset($<span class="ttSigDiff">HTTP</span>_SERVER<span class="ttSigDiff">_VARS</span>['HTTP_CLIENT_IP'])) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">1231</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ip = $_SERVER['HTTP_CLIENT_IP'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1233</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ip = $<span class="ttSigDiff">HTTP</span>_SERVER<span class="ttSigDiff">_VARS</span>['HTTP_CLIENT_IP'];</td>
</tr>
<tr class="secAll">
<td class="LineNum">1232</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">1234</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secAll">
<td class="LineNum">1233</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ip = $_SERVER['REMOTE_ADDR'];</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">1235</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ip = $<span class="ttSigDiff">HTTP</span>_SERVER<span class="ttSigDiff">_VARS</span>['REMOTE_ADDR'];</td>
</tr>
<tr class="secBegin">
<td class="LineNum">1234</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">1236</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1235</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1237</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1236</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (getenv('HTTP_X_FORWARDED_FOR')) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1238</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (getenv('HTTP_X_FORWARDED_FOR')) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1237</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ip = getenv('HTTP_X_FORWARDED_FOR');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1239</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ip = getenv('HTTP_X_FORWARDED_FOR');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">1238</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (getenv('HTTP_CLIENT_IP')) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1240</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (getenv('HTTP_CLIENT_IP')) {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">1239</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ip = getenv('HTTP_CLIENT_IP');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">1241</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ip = getenv('HTTP_CLIENT_IP');</td>
</tr>
</table>

<h3>[BUGFIX] Strip Additional Slashes When Editing Reviews</h3>

<p>Strip additional slashes when editing reviews.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/reviews.php</p>

<span class="affectedFiles">File: catalog/admin/reviews.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">159</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '1', '10'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">159</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '1', '10'); ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">160</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">160</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">161</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">161</td>
<td class="Normal">&lt;?php</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">162</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($HTTP_POST_VARS)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">162</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (tep_not_null($HTTP_POST_VARS)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">163</td>
<td class="Normal">/* Re-Post all POST'ed variables */</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">163</td>
<td class="Normal">/* Re-Post all POST'ed variables */</td>
</tr>
<tr class="secEnd">
<td class="LineNum">164</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($HTTP_POST_VARS);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">164</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($HTTP_POST_VARS);</td>
</tr>
<tr class="secAll">
<td class="LineNum">165</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while(list($key, $value) = each($HTTP_POST_VARS)) echo tep_draw_hidden_field($key, $value);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">165</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while<span class="ttSigDiff"> </span>(list($key, $value) = each($HTTP_POST_VARS)) echo tep_draw_hidden_field($key, <span class="ttSigDiff">htmlspecialchars(stripslashes(</span>$value<span class="ttSigDiff">))</span>);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">166</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">166</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">167</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">167</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">168</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot; class=&quot;smallText&quot;&gt;&lt;?php echo '&lt;a href=&quot;' . tep_href_link(FILENAME_REVIEWS, 'page=' . $HTTP_GET_VARS['page'] . '&amp;rID=' . $rInfo-&gt;reviews_id . '&amp;action=edit') . '&quot;&gt;' . tep_image_button('button_back.gif', IMAGE_BACK) . '&lt;/a&gt; ' . tep_image_submit('button_update.gif', IMAGE_UPDATE) . ' &lt;a href=&quot;' . tep_href_link(FILENAME_REVIEWS, 'page=' . $HTTP_GET_VARS['page'] . '&amp;rID=' . $rInfo-&gt;reviews_id) . '&quot;&gt;' . tep_image_button('button_cancel.gif', IMAGE_CANCEL) . '&lt;/a&gt;'; ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">168</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&quot;right&quot; class=&quot;smallText&quot;&gt;&lt;?php echo '&lt;a href=&quot;' . tep_href_link(FILENAME_REVIEWS, 'page=' . $HTTP_GET_VARS['page'] . '&amp;rID=' . $rInfo-&gt;reviews_id . '&amp;action=edit') . '&quot;&gt;' . tep_image_button('button_back.gif', IMAGE_BACK) . '&lt;/a&gt; ' . tep_image_submit('button_update.gif', IMAGE_UPDATE) . ' &lt;a href=&quot;' . tep_href_link(FILENAME_REVIEWS, 'page=' . $HTTP_GET_VARS['page'] . '&amp;rID=' . $rInfo-&gt;reviews_id) . '&quot;&gt;' . tep_image_button('button_cancel.gif', IMAGE_CANCEL) . '&lt;/a&gt;'; ?&gt;&lt;/td&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">169</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/form&gt;&lt;/tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">169</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/form&gt;&lt;/tr&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">170</td>
<td class="Normal">&lt;?php</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">170</td>
<td class="Normal">&lt;?php</td>
</tr>
<tr class="secEnd">
<td class="LineNum">171</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">171</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
</table>

<h3>[IMPROVEMENT] New Public Title for Payment Modules</h3>

<p>Add a public title for the payment modules to show "Credit Card" instead of the name of the payment servicer provider.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/classes/order.php<br />
catalog/checkout_process.php</p>

<span class="affectedFiles">File: catalog/includes/classes/order.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">160</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'subtotal' =&gt; 0,</td>
<td class="AlignCenter">=</td>
<td class="LineNum">160</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'subtotal' =&gt; 0,</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">161</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'tax' =&gt; 0,</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">161</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'tax' =&gt; 0,</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">162</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'tax_groups' =&gt; array(),</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">162</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'tax_groups' =&gt; array(),</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">163</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'comments' =&gt; (tep_session_is_registered('comments') &amp;&amp; !empty($comments) ? $comments : ''));</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">163</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'comments' =&gt; (tep_session_is_registered('comments') &amp;&amp; !empty($comments) ? $comments : ''));</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">164</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">164</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">165</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($GLOBALS[$payment]) &amp;&amp; is_object($GLOBALS[$payment])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">165</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($GLOBALS[$payment]) &amp;&amp; is_object($GLOBALS[$payment])) {</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">166</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($GLOBALS[$payment]-&gt;public_title)) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">167</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info['payment_method'] = $GLOBALS[$payment]-&gt;public_title;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">168</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">166</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info['payment_method'] = $GLOBALS[$payment]-&gt;title;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">169</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ttSigDiff">&nbsp; </span>$this-&gt;info['payment_method'] = $GLOBALS[$payment]-&gt;title;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">170</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secBegin">
<td class="LineNum">167</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">171</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">168</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( isset($GLOBALS[$payment]-&gt;order_status) &amp;&amp; is_numeric($GLOBALS[$payment]-&gt;order_status) &amp;&amp; ($GLOBALS[$payment]-&gt;order_status &gt; 0) ) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">172</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( isset($GLOBALS[$payment]-&gt;order_status) &amp;&amp; is_numeric($GLOBALS[$payment]-&gt;order_status) &amp;&amp; ($GLOBALS[$payment]-&gt;order_status &gt; 0) ) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">169</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info['order_status'] = $GLOBALS[$payment]-&gt;order_status;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">173</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info['order_status'] = $GLOBALS[$payment]-&gt;order_status;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">170</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">174</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">171</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">175</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">172</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">176</td>
<td class="Normal">&nbsp;</td>
</tr>
</table>

<br />

<span class="affectedFiles">File: catalog/checkout_process.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">247</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EMAIL_SEPARATOR . &quot;\n&quot; .</td>
<td class="AlignCenter">=</td>
<td class="LineNum">247</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EMAIL_SEPARATOR . &quot;\n&quot; .</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">248</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_address_label($customer_id, $billto, 0, '', &quot;\n&quot;) . &quot;\n\n&quot;;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">248</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_address_label($customer_id, $billto, 0, '', &quot;\n&quot;) . &quot;\n\n&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">249</td>
<td class="Normal">&nbsp; if (is_object($$payment)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">249</td>
<td class="Normal">&nbsp; if (is_object($$payment)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">250</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $email_order .= EMAIL_TEXT_PAYMENT_METHOD . &quot;\n&quot; . </td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">250</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $email_order .= EMAIL_TEXT_PAYMENT_METHOD . &quot;\n&quot; . </td>
</tr>
<tr class="secMiddle">
<td class="LineNum">251</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EMAIL_SEPARATOR . &quot;\n&quot;;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">251</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EMAIL_SEPARATOR . &quot;\n&quot;;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">252</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $payment_class = $$payment;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">252</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $payment_class = $$payment;</td>
</tr>
<tr class="secAll">
<td class="LineNum">253</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; $email_order .= $payment_<span class="ttSigDiff">clas</span><span class="ttSigDiff">s-&gt;title</span> . &quot;\n\n&quot;;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">253</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp; $email_order .= $<span class="ttSigDiff">order-&gt;info['</span>payment_<span class="ttSigDiff">method']</span> . &quot;\n\n&quot;;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">254</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if ($payment_class-&gt;email_footer) { </td>
<td class="AlignCenter">=</td>
<td class="LineNum">254</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if ($payment_class-&gt;email_footer) { </td>
</tr>
<tr class="secMiddle">
<td class="LineNum">255</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $email_order .= $payment_class-&gt;email_footer . &quot;\n\n&quot;;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">255</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $email_order .= $payment_class-&gt;email_footer . &quot;\n\n&quot;;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">256</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">256</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">257</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">257</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">258</td>
<td class="Normal">&nbsp; tep_mail($order-&gt;customer['firstname'] . ' ' . $order-&gt;customer['lastname'], $order-&gt;customer['email_address'], EMAIL_TEXT_SUBJECT, $email_order, STORE_OWNER, STORE_OWNER_EMAIL_ADDRESS);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">258</td>
<td class="Normal">&nbsp; tep_mail($order-&gt;customer['firstname'] . ' ' . $order-&gt;customer['lastname'], $order-&gt;customer['email_address'], EMAIL_TEXT_SUBJECT, $email_order, STORE_OWNER, STORE_OWNER_EMAIL_ADDRESS);</td>
</tr>
<tr class="secEnd">
<td class="LineNum">259</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">259</td>
<td class="Normal">&nbsp;</td>
</tr>
</table>

<h3>[IMPROVEMENT] Navigation History Parameter Filter</h3>

<p>Filter parameter names containing "_nh_dns" out of the navigation history session data.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/classes/navigation_history.php</p>

<span class="affectedFiles">File: catalog/includes/classes/navigation_history.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">57</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">57</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">58</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">58</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">59</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">59</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">60</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($set == 'true') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">60</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($set == 'true') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">61</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;path[] = array('page' =&gt; basename($PHP_SELF),</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">61</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;path[] = array('page' =&gt; basename($PHP_SELF),</td>
</tr>
<tr class="secEnd">
<td class="LineNum">62</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'mode' =&gt; $request_type,</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">62</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'mode' =&gt; $request_type,</td>
</tr>
<tr class="secBegin">
<td class="LineNum">63</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'get' =&gt; $HTTP_GET_VARS,</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">63</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'get' =&gt; $<span class="ttSigDiff">this-&gt;filter_parameters($</span>HTTP_GET_VARS<span class="ttSigDiff">)</span>,</td>
</tr>
<tr class="secEnd">
<td class="LineNum">64</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'post' =&gt; $HTTP_POST_VARS);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">64</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'post' =&gt; $<span class="ttSigDiff">this-&gt;filter_parameters($</span>HTTP_POST_VARS<span class="ttSigDiff">)</span>);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">65</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">65</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">66</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">66</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">67</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">67</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">68</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function remove_current_page() {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">68</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function remove_current_page() {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">69</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $PHP_SELF;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">69</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $PHP_SELF;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">70</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">70</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">77</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function set_snapshot($page = '') {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">77</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function set_snapshot($page = '') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">78</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $PHP_SELF, $HTTP_GET_VARS, $HTTP_POST_VARS, $request_type;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">78</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $PHP_SELF, $HTTP_GET_VARS, $HTTP_POST_VARS, $request_type;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">79</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">79</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">80</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($page)) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">80</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($page)) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">81</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;snapshot = array('page' =&gt; $page['page'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">81</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;snapshot = array('page' =&gt; $page['page'],</td>
</tr>
<tr class="secEnd">
<td class="LineNum">82</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'mode' =&gt; $page['mode'],</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">82</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'mode' =&gt; $page['mode'],</td>
</tr>
<tr class="secBegin">
<td class="LineNum">83</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'get' =&gt; $page['get'],</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">83</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'get' =&gt; $<span class="ttSigDiff">this-&gt;filter_parameters($</span>page['get']<span class="ttSigDiff">)</span>,</td>
</tr>
<tr class="secEnd">
<td class="LineNum">84</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'post' =&gt; $page['post']);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">84</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'post' =&gt; $<span class="ttSigDiff">this-&gt;filter_parameters($</span>page['post']<span class="ttSigDiff">)</span>);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">85</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">85</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">86</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;snapshot = array('page' =&gt; basename($PHP_SELF),</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">86</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;snapshot = array('page' =&gt; basename($PHP_SELF),</td>
</tr>
<tr class="secEnd">
<td class="LineNum">87</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'mode' =&gt; $request_type,</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">87</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'mode' =&gt; $request_type,</td>
</tr>
<tr class="secBegin">
<td class="LineNum">88</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'get' =&gt; $HTTP_GET_VARS,</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">88</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'get' =&gt; $<span class="ttSigDiff">this-&gt;filter_parameters($</span>HTTP_GET_VARS<span class="ttSigDiff">)</span>,</td>
</tr>
<tr class="secEnd">
<td class="LineNum">89</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'post' =&gt; $HTTP_POST_VARS);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">89</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'post' =&gt; $<span class="ttSigDiff">this-&gt;filter_parameters($</span>HTTP_POST_VARS<span class="ttSigDiff">)</span>);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">90</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">90</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">91</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">91</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">92</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">92</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">93</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function clear_snapshot() {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">93</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function clear_snapshot() {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">94</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;snapshot = array();</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">94</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;snapshot = array();</td>
</tr>
<tr class="secEnd">
<td class="LineNum">95</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">95</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secGap"><td colspan="5">&nbsp;</td></tr>
<tr class="secBegin">
<td class="LineNum">121</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo '&lt;br&gt;&lt;br&gt;';</td>
<td class="AlignCenter">=</td>
<td class="LineNum">121</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo '&lt;br&gt;&lt;br&gt;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">122</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">122</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">123</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo $this-&gt;snapshot['mode'] . ' ' . $this-&gt;snapshot['page'] . '?' . tep_array_to_string($this-&gt;snapshot['get'], array(tep_session_name())) . '&lt;br&gt;';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">123</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo $this-&gt;snapshot['mode'] . ' ' . $this-&gt;snapshot['page'] . '?' . tep_array_to_string($this-&gt;snapshot['get'], array(tep_session_name())) . '&lt;br&gt;';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">124</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">124</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">125</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">125</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">126</td>
<td class="Normal">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">126</td>
<td class="Normal">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="LineNum">127</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; function filter_parameters($parameters) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">128</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $clean = array();</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">129</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">130</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($parameters);</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">131</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($key, $value) = each($parameters)) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">132</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (strpos($key, '_nh-dns') &lt; 1) {</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">133</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $clean[$key] = $value;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">134</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">135</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">136</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">137</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $clean;</span></td>
</tr>
<tr class="secMiddle">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">138</td>
<td class="HasOrphan"><span class="ttSigDiff">&nbsp;&nbsp;&nbsp; }</span></td>
</tr>
<tr class="secEnd">
<td class="LineNum">&nbsp;</td>
<td class="HasOrphan">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">139</td>
<td class="HasOrphan">&nbsp;</td>
</tr>
<tr class="secBegin">
<td class="LineNum">127</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function unserialize($broken) {</td>
<td class="AlignCenter">=</td>
<td class="LineNum">140</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; function unserialize($broken) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">128</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(reset($broken);$kv=each($broken);) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">141</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(reset($broken);$kv=each($broken);) {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">129</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $key=$kv['key'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">142</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $key=$kv['key'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">130</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (gettype($this-&gt;$key)!=&quot;user function&quot;)</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">143</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (gettype($this-&gt;$key)!=&quot;user function&quot;)</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">131</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;$key=$kv['value'];</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">144</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;$key=$kv['value'];</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">132</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">145</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">133</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">146</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">134</td>
<td class="Normal">&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">147</td>
<td class="Normal">&nbsp; }</td>
</tr>
<tr class="secEnd">
<td class="LineNum">135</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">148</td>
<td class="Normal">?&gt;</td>
</tr>
</table>

<h3>[IMPROVEMENT] Increase Configuration Key and Title Database Field Sizes [SQL]</h3>

<p>Increase the sizes of the configuration key and configuration title database fields.</p>

<p class="sqlBox"><b>Database Changes to Perform:</b><br />
alter table configuration modify configuration_title varchar(255) NOT NULL;<br />
alter table configuration modify configuration_key varchar(255) NOT NULL;</p>

<h3>[BUGFIX] Strip Additional Slashes When Editing Files Through the File Manager</h3>

<p>Strip additional slashes when editing files through the Administration Tool -> Tools -> File Manager section.</p>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/file_manager.php</p>

<span class="affectedFiles">File: catalog/admin/file_manager.php</span>

<table class="fc" cellspacing="0" cellpadding="0">
<tr class="secBegin">
<td class="LineNum">142</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (!isset($file_writeable)) $file_writeable = true;</td>
<td class="AlignCenter">=</td>
<td class="LineNum">142</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if (!isset($file_writeable)) $file_writeable = true;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">143</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $file_contents = '';</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">143</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; $file_contents = '';</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">144</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if ($action == 'new_file') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">144</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; if ($action == 'new_file') {</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">145</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $filename_input_field = tep_draw_input_field('filename');</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">145</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $filename_input_field = tep_draw_input_field('filename');</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">146</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } elseif ($action == 'edit') {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">146</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; } elseif ($action == 'edit') {</td>
</tr>
<tr class="secEnd">
<td class="LineNum">147</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($file_array = file($current_path . '/' . $HTTP_GET_VARS['info'])) {</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">147</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($file_array = file($current_path . '/' . $HTTP_GET_VARS['info'])) {</td>
</tr>
<tr class="secAll">
<td class="LineNum">148</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $file_contents = <span class="ttSigDiff">addslashes(</span>implode('', $file_array<span class="ttSigDiff">)</span>);</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="LineNum">148</td>
<td class="HasMismatch">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $file_contents = implode('', $file_array);</td>
</tr>
<tr class="secBegin">
<td class="LineNum">149</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">=</td>
<td class="LineNum">149</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">150</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $filename_input_field = $HTTP_GET_VARS['info'] . tep_draw_hidden_field('filename', $HTTP_GET_VARS['info']);</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">150</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $filename_input_field = $HTTP_GET_VARS['info'] . tep_draw_hidden_field('filename', $HTTP_GET_VARS['info']);</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">151</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">151</td>
<td class="Normal">&nbsp;&nbsp;&nbsp; }</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">152</td>
<td class="Normal">?&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">152</td>
<td class="Normal">?&gt;</td>
</tr>
<tr class="secMiddle">
<td class="LineNum">153</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">153</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
</tr>
<tr class="secEnd">
<td class="LineNum">154</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '1', '10'); ?&gt;&lt;/td&gt;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="LineNum">154</td>
<td class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;?php echo tep_draw_separator('pixel_trans.gif', '1', '10'); ?&gt;&lt;/td&gt;</td>
</tr>
</table>

</body>
</html>
