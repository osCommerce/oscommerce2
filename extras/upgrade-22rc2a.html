<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>osCommerce Online Merchant v2.2 RC2 Upgrade Notes</title>
<style>
/* HTML tag styles */
body{ font-family:Verdana,Arial,sans-serif; line-height:1.166; margin:0px; padding:10px; background-color:#fafafa; font-size: 13px; }
a:link, a:visited, a:hover { text-decoration:none; }
a:link, a:hover { color: #036; }
a:visited { color:#158; }
a:hover { text-decoration: underline; }
/**** Global Box Colours & Icons ****/
/* INTERNAL BORDER COLOUR */
.genericPane .dirPane .welcomePane, #fileTable, .ftFileRow td, .ftFileRowDeleted td, .history,
.searchItemDirectory, .searchItemRevision, .searchItemFile, .searchTabResults td, .changesetList
  { border-top:1px #ccc solid }
.searchTabResults tr.startOfGroup td   { border-top:2px #777 solid }
/* ITEM TYPE ICONS */
.searchItemDirectory{ background: url(images/directoryIcon.gif) top left no-repeat }
.searchItemRevision{ background: url(images/revisionIcon.gif) top left no-repeat }
.searchItemRevision, .history{ background: url(images/revisionIcon.gif) top left no-repeat }
.changesetDetail, .changesetList{ background: url(images/changesetIcon.gif) top left no-repeat }
/* FILE TYPE ICONS */
.searchItemFile, .ftIconCol{ background: url(images/fileIconGeneric.gif) top left no-repeat }
.ftFileRowDeleted td.ftIconCol{ background:#f0f0f0 url(images/fileIconDeleted.gif) top left no-repeat }
/* SUBDIRECTORY TREE ICONS */
.folder{ padding-left:20px; /* background:url(images/folderIcon.gif) top left no-repeat; */}
/* SUBDIRECTORY TREE filename styles */
.folderPlain{}
.folderEmpty{ color: #777; }
.folderHidden{ font-style: italic; }
.folderHiddenEmpty{ font-style: italic; color: #777 }
/* Basic Box Styles */
.box{ padding: 0px; margin: 0 0 7px 0; background-color:#fff; }
.box h3
  { color:#0a0a0a; font-size:.7em; font-family:Tahoma, Arial, Helvetica, sans-serif; border-width:0 0 1px 0;
    background-color: #f9f9ff; padding:2px 0 2px 10px; margin:0px; }
.boxMessage
  { background:#fff; font-size:.75em; font-style:italic; color:#000000; margin:0px; padding:5px 5px 5px 30px; }
.boxBody{ font-size:0.75em; padding: 0 15px 0 15px;}
.boxIcon{ float:right;font-weight:normal;font-size:0.9em; margin:0; padding:0; }
.boxIcon img{ border-width:0px; margin-right:5px; }
.boxIconText{ vertical-align:top; margin-right:5px; }
/* Pane with Centred Text */
.centrePane{ text-align:center; font-size:0.75em;padding:10px; }
.centrePane p{ margin:0; }
/* tour */
#tourTop{background:url(tour/t_top.gif) top left no-repeat; padding-top:10px;}
#tourRight{ background:url(tour/t_right.gif) top right no-repeat; padding-right:21px; }
#tourBody{ background:url(tour/t_body.gif) top left repeat; padding:0px 10px; }
#tourCorner{ background:url(tour/t_corner.gif) top right no-repeat; padding-right:21px; }
#tourBottom{ background:url(tour/t_bottom.gif) top left no-repeat;padding-top:23px }
.tourTitle{ font-size:0.7em; position:absolute; left:15px; top:12px; font-weight:bold;}
.tourControls{ font-size:0.7em; position:absolute; right:18px; top:12px; font-weight:bold;}
.tourDescription{ font-size:0.8em; padding:20px 15px 0px 15px; }
.tourDescription p{ margin:0; padding-bottom:3px;}
.tourDescription a{ font-weight:bold;}
.tourDescription code{ font-size:120%; }
table.tourEg td { font-size:0.8em; }
table.tourEg { margin-left: 2px; border:1px solid #999;}
.bubbleLeft, .bubbleRight, .bubbleBelow, .bubbleAbove, .bubbleBelowRight {  z-index:99; position:absolute; }
.bubbleBelow { margin: 20px 5px 0 15px; width:436px; background:url(tour/uparrow.gif) no-repeat top left; padding-top:37px; }
.bubbleBelowRight { margin-top:16px; width:436px; right:16px; background:url(tour/uparrowRight.gif) no-repeat top left; padding-top:37px; }
.bubbleBelow .bubbleText, .bubbleBelowRight .bubbleText { background:url(tour/upbottom.gif) bottom left no-repeat; padding:0px 25px 30px 25px; }
.bubbleAbove { margin-top: -70px; margin-left:15px; width:436px; background:url(tour/downarrow.gif) no-repeat bottom left; padding-bottom:37px; }
.bubbleAbove .bubbleText { background:url(tour/belowtop.gif) top left no-repeat; padding:15px 7px 0px 19px; }
.bubbleRight { left: 310px; margin-top:10px; width:292px; background:url(tour/leftarrow.gif) no-repeat top right; padding-top:19px; }
.bubbleLeft { left:30px; margin-top:10px; width:292px; background:url(tour/rightarrow.gif) no-repeat top right; padding-top:19px }
.bubbleLeft .bubbleText, .bubbleRight .bubbleText { background:url(tour/rightbottom.gif) bottom right no-repeat; padding:0px 25px 30px 25px; }
.bubbleText { font-family: Tahoma, Helvetica, sans-serif; font-size:11px; color:#000; font-weight:bold;  text-align:center; }
/* file history styles */
.history{ display:block; color:#000000; font-size:.75em; padding:5px 5px 5px 30px; }
.history pre{ font-size:1em; margin:3px 0 3px 0; }
.history p{ margin:0; }
/* changeset styles  */
.changesetDetail, .changesetList { display:block; color:#000000; font-size:.7em; }
.changesetDetail{ margin-top:10px; padding:5px 5px 10px 35px; }
.changesetDetail ul{ padding:0;margin:0; }
.changesetList{ padding:5px 5px 5px 30px; }
.changesetDetail pre, .changesetList pre{ font-size:105% }
.changesetList pre{ margin:3px 0 3px 0; }
.changesetDetail p{ margin:3px 0 3px 0; }
.changesetList p{ margin:0; }
.csId, .csAuthor{ font-weight:bold; }
.csAge{ display:inline; }
.csComment
  { padding:3px; margin-top:2px; font-size:1.08em; font-family:Monaco, "Lucida Console", "Courier New", Courier, monospace;
    display:block; background-color:#fcfefe; }
.changesetDetail .csComment {
    margin-top:8px;
}
li.csFilename{ list-style-type:none; padding-top:4px; white-space:nowrap; }
.changesetDetail li.csFilename { margin-top: 0px; }
.diffPaneChangset{ margin:10px; }
.controls{ padding-top:10px; }
.controls a, .controls a:link, .controls a:hover, .controls a:visited{ color:green; cursor:pointer; }
.csMore{ font-style:italic; }
/* linehistory style */
.linehistory{padding:5px 3px 5px 3px; font-size:small; text-align:center;}
.linehistory img{ width:300px; border:0;}
/* file table styles */
#fileTable{ border-width:0; width:100%;}
#ftTitle{ font-size:.7em; font-weight:bold;}
#ftTitle td{ padding:4px 0 4px 0; }
.ftIconCol{width:35px;vertical-align:top;}
.ftIconCol img{ margin:2px 0 0 6px; }
.ftFileRow td, .ftFileRowDeleted td{ font-size:.7em; border-width:1px 0 0 0; padding: 4px 0 0 0;}
.ftFileRowDeleted, .ftFileRowDeletedComment{ background-color:#f0f0f0 }
.ftFileName{ font-weight:bold; }
.ftRev{}
.ftAuthor{}
.ftComment{ font-size:.65em; padding:0 0 4px 0; }
/* form styles */
.formPane{ padding:5px; margin:0; white-space:nowrap; }
.formPane table{ font-size:0.7em; }
.formPane input, .formPane select, .formPane td{ font-size:100%; vertical-align:middle }
.formPane form{ margin:0; padding:0; }
.formPane td{ padding-left:10px; white-space:nowrap; vertical-align:middle; }
/* Admin Stuff #TODO: Fix this shite!! */
.label, .verb, .errorLabel { font-weight:bold; text-align:right; }
.checkboxLabel {font-size:140%;}
.verbDisabled {color:#a0a0a0; }
.errorLabel, .errorMessage, .checkboxErrorLabel { color:#cc3300; }
.statusMessage { color:#22aa00;}
.verb a:link, .verb a:hover, .verb a:visited { text-decoration:underline }
.adminTable { margin:5px; border:1px solid #ddd }
.adminTable th { background-color:#eee; }
.adminTable td, .adminTable th { padding:3px 6px; white-space:normal; }
.confirm
  { font-size:.7em; background:#ffffe1 url(images/infoIcon.gif) top left no-repeat; border:#ddd 1px solid;
    text-align:center; line-height:2em; padding: 10px; margin: 6px }
.formPane h4 { font-size:0.8em; margin:10px 0 5px 5px; }
.description { font-style:italic }
.adminSubHeading { text-decoration:underline;font-weight:bold; }
/* search styles */
.searchCriteria{ padding:5px; }
.searchCriteria .formPane td { vertical-align:top; padding:5px 0 5px 0; }
.searchResults{ padding:0 0 5px 0; }
.searchItemDirectory, .searchItemRevision, .searchItemFile
  { display:block; font-size:.7em; padding:5px 5px 5px 30px; }
.searchItemDirectory pre, .searchItemRevision pre, .searchItemFile pre
  { font-size:100%; margin:3px 0 3px 0; }
.searchItemDirectory p, .searchItemRevision p, .searchItemFile p{ margin:0; }
.searchResultsSubItem { font-size:100%;margin-top:3px; padding-left:20px; }
.searchResultsSubItem pre{ font-size:100%; margin:0 0 3px 0; }
table.searchTabResults {font-size:.7em; margin:0; padding:0; }
.searchTabResults th, .searchTabResults td {text-align: left; margin:0; padding-right: 3px; vertical-align: top}
.searchTabResults td.numberTabCell {text-align: right;}
.pagination { font-size:.68em; padding:5px 10px 5px 10px; text-align:right; margin:0 }
/* quicksearch results */
.qsResult{ display:block; font-size:.7em; padding:0px 5px 0px 15px; margin:0; }
.qsSummary{ float:right; text-transform:none; font-weight:normal; padding-right:3px; }
.qsResult h4{ font-size:100%; margin:10px 0 0 0; }
.qsResult dt{ margin-top:5px; }
.qsResult dd{ padding-left:0; margin-left:15px; }
.qsResult p{ padding-left:15px; margin: 3px 0 0 0;}
.qsKeyword, .qsNumber{ font-weight:bold; }
.qsFileDir{ display:block; margin-top:3px; }
.qsFiles{ padding-left:15px; display:block; }
/* subdir tree styles */
.toolBar
  { text-align:right; font-size:0.65em; padding:0px 3px 0 3px; font-family:Tahoma, Arial, Helvetica, sans-serif;
    /*border-bottom:1px solid #ccc;*/ }
.toolBarHidden, .toolBarEmpty, .toolBarSort
  { float:right; padding:2px 3px 2px 3px; background-color:#eee; border:1px solid #ccc; margin-top:4px }
.warningToolBar{ font-size:100%; padding:2px 3px; margin-top:4px; }
.prop .dirPane {padding-left:10px}
.dirPane{ padding:10px 10px 10px 0px; font-size:0.7em; font-family:Tahoma, Arial, Helvetica, sans-serif; }
.dirPane a:link, .dirPane a:hover, .dirPane a:visited{ color:#000; }
.dirPane ul, .dirPane ul ul{ margin:0; padding:0; }
.dirPane ul li, .dirPane ul ul li{ margin:0; padding:0; list-style-type:none; list-style-position:inside; }
.dirPane ul li{ margin-top:4px; }
.dirPane ul ul li{ margin-top:4px; margin-left:17px; }
/* subdir tree styles */
.helpPane{ padding:0px 10px 10px 10px;font-size:0.7em; font-family:Verdana, Arial, Helvetica, sans-serif;width:190px; }
.helpPane ul{ margin:0;padding:0; }
.helpPane ul li{ margin-top:5px; list-style-type:none;font-weight:bold; }
.helpPane ul ul li{ margin-left:10px; list-style-position:inside; list-style-type:square; font-weight:normal; }
.helpPaneContents{ color:#111; padding:10px 10px 10px 15px; font-size:0.75em; }
.helpPaneContents h4{ color:#222; margin:0; }
.helpPaneContents p{ margin:0 0 7px 0; }
code { font-size:120% }
.helpPaneContents dt{ font-size:.95em; margin-left:10px; font-weight:bold; font-style:italic; color:#444 }
.helpPaneContents dd{ margin:4px 0 7px 20px; }

/* Diff Sytles */
.diffPane{ padding: 10px 20px; }
.diff{ font-size:100%; white-space:nowrap; margin:0; padding:0; border:1px solid #ccc; }
.diffFile, .diffFileA, .diffFileB, .diffCS{ font-size:.9em; text-align:right; font-weight:bold; }
.diffCS{ font-weight:normal }
.diffWarning td.diffContent, .diffSkipped td.diffContent{ vertical-align:middle; padding:0 5px 0 5px; font-size:.9em; }
.diffWarning td.diffContent{ background:#ffffe1; }
.diffSkipped td.diffContent{ background:#fafafa; color:#444; }
.diffSection{ }
.diffPre { font-size:100%; margin:0; padding:0; }
.diffNav{ vertical-align:top; white-space:nowrap; }
/* Note A=Deleted B=Added */
.diffLineNumbers, .diffLineNumbersA, .diffLineNumbersB{ text-align:right; vertical-align:top; }
.diffMarkerCol, .diffMarkerColA, .diffMarkerColB, .diffWarning td.diffMarkerCol, .diffSkipped td.diffMarkerCol
  { padding-right:5px; text-align:center; vertical-align:middle; }
.diffMarkerCol{ border-right:1px solid #ccc }
.diffMarkerColA{ border-right:1px solid red; }
.diffMarkerColB{ border-right:1px solid green; }
.diffWarning td.diffMarkerCol{ border-right:1px solid yellow; }
.diffSkipped td.diffMarkerCol{ border-right:1px solid orange; }
.diffSkipped td.diffLineNumbers{ font-size:.9em; font-style:italic; }
.diffSkipped td.diffLineNumbers a:link, .diffSkipped td.diffLineNumbers a:visited{ color:orange; }
.diffContent, .diffContentA, .diffContentB, .ediffContentA, .ediffContentB{ padding-left:4px; text-align:left; vertical-align:top; }
/*
.diffContentA, .ediffContentA{ border-top:1px solid yellow; }
.diffContentB, .ediffContentB{ border-bottom:1px solid #dcfadc; }
*/
.diffLineNumbersA, .diffContentA, a.diffFileA:link, a.diffFileA:hover, a.diffFileA:visited, .ediffChangedA
  { color:red; background-color:#ffc; }
.diffLineNumbersB, .diffContentB, a.diffFileB:link, a.diffFileB:hover, a.diffFileB:visited, .ediffChangedB
  { color:green; background-color:#f0fff0 }
.ediffChangedA{  }
.ediffChangedB{  }
.ediffContentA{ background-color:#ffffed; }
.ediffContentB{ background-color:#fafffa; }
/* annotation styles */
.annPaneLegend{ font-size:.7em; padding:9px 5px 9px 9px; }
.annLegend{ font-size:0.9em; padding:0px; margin:8px 0 0 0; }
.annLegend td{ border:1px solid #ccc; padding:2px; margin-right:2px; text-align:center; }
.annPane{ font-size:.75em; padding:5px 10px 5px 10px; }
.annPane table{ font-size:100%; white-space:nowrap; margin:0; padding:0; border:1px solid #ccc;  }
.annPane td{ text-align:right; vertical-align:top; padding:0 3px 0 5px; }
.annPane pre {margin: 0px; padding-bottom: 0px;}
.annPane span.annLine {font-family: monospace;}
td.annWarning, span.annWarning {text-align:left; font-size:.75em; border-right:1px solid yellow; background:#ffffe1; }
/**** changelog styles  ****/
.chJoggerPane{ padding:5px 0 5px 1px; }
.chJogger{ font-size:.65em; padding:0; margin:0; white-space:nowrap }
.chJogger td{ text-align:center; vertical-align:top; padding:0; margin:0;}
td.chJoggerFrom{ text-align:left; padding-left:1px; }
td.chJoggerTo{ text-align:right; }
/* calendar */
.calPane{ text-align:center; padding:0 10px 5px 10px; margin:0; white-space:nowrap; }
.calPane a:link, .calPane a:hover, .calPane a:visited{ color:#000; text-decoration:none; }
.calPane a:hover{ text-decoration:underline; }
.calPane table{ font-size:.7em; margin:5px auto 0 auto;}
.calPane input, .calPane select, .calPane td{ font-size:100%; vertical-align:middle; white-space:nowrap; }
.calPane td{ font-size:100%; text-align:center}
.calDays{  }
.calDays td, .calMonths td{ border:1px solid #eee; }
.caldays td{ width:14%;  background-color:#fbfff9; }
.calDays td.calDayCell{ border-bottom:1px solid #999; background-color:#fff; }
.calMonths td{ width:14%; background-color:#fbfff9; }
.calPane form{ margin:0; padding:0; }
.changelogMatching{  }
.caldays td.changelogShowing{ background-color:#ccffaa; color: #000 }
.caldays td.changelogShowing:hover{ background-color:#66FF00; }
.changelogMatchingCount{ font-size:.72em ; vertical-align:super }

/* "commandline" output */
.cmdlineHelpPane { margin:15px auto 0 auto; }
.cmdlineHelpPane { padding: 0 0px 0 15px;}
.cmdlineHelpPane a:link, .cmdlineHelpPane a:hover, .cmdlineHelpPane a:visited { text-decoration:underline }

.prefsTable {border: 1px solid #ccc; border-collapse:collapse;}
.prefsHeaderRow {padding: 3px 5px; background:#eee; font-weight:bold; border-top: 1px solid #ccc; border-bottom: 1px solid #ccc;}

.loading {font-family: Tahoma, Helvetica, Arial, sans-serif; font-size:0.9em; color:#666}

/* new diff styling */
/*
 * Source Styles
 */
table.diff {
    font-size:100%;
}
.diff td {
  font-family:monospace;
  font-size:small;
}
.unifiedDiff td.lineContent {
  width:99%;
}
.sidebysideDiff td.lineContent {
  width:49%;
}
.hardDiff td.lineContent {
  white-space:pre;
}
.softDiff td.lineContent {
  white-space:normal;
  vertical-align:top;
}
.diff .commentForm {
  /*border:1px solid orange;*/
  background-color:#FFE7C6;
  margin:0;
  padding:5px 10px;
}
.diff td.lineNumber,
.diff td.diffLineNumbers {
  text-align:right;
  padding-right:9px;
  padding-left:5px;
  color:#999;
}
.diffNav{
  vertical-align:top;
  white-space:nowrap;
}

/* Note A=Deleted B=Added */
.diffLineNumbers,
.diffLineNumbersA,
.diffLineNumbersB {
  text-align:right;
  vertical-align:middle;
  padding-right:9px;
}

.diffMarkerCol,
.diffMarkerColA,
.diffMarkerColB,
.diffWarning td.diffMarkerCol,
.diffSkipped td.diffMarkerCol {
  padding-right: 5px;
  text-align: center;
  vertical-align: middle;
}

.diffMarkerCol {
  border-right: 1px solid #ccc
}
.diffMarkerColA {
  border-right: 1px solid red;
}
.diffMarkerColB {
  border-right: 1px solid green;
}
.diffWarning td.diffMarkerCol {
  border-right: 1px solid yellow;
}
.diffSkipped td.diffMarkerCol {
  border-right: 1px solid orange;
}
.diffSkipped td.diffLineNumbers {
  font-style: italic;
}
.diffSkipped td.diffLineNumbers a:link,
.diffSkipped td.diffLineNumbers a:visited {
  color: orange;
}
.diffContent,
.diffContentA,
.diffContentB,
.ediffContentA,
.ediffContentB {
  padding-left: 4px;
  text-align: left;
  vertical-align:middle;
}

td.diffContentA,
a.diffFileA:link,
a.diffFileA:hover,
a.diffFileA:visited,
.ediffChangedA{
  color:red;
  background-color:#ffc;
}
td.diffContentB,
a.diffFileB:link,
a.diffFileB:hover,
a.diffFileB:visited,
.ediffChangedB {
  color:green; background-color:#f0fff0
}
.ediffChangedA{  }

.ediffChangedB{  }

.ediffContentA {
  background-color: #ffffed;
}

.ediffContentB {
  background-color: #fafffa;
}

.diff tr.sourceLine,
.diff tr.lineHighlighted {
  cursor:default;
}

.diff .lineHighlighted,
.diff .lineHighlighted .diffLineNumbersA,
.diff .lineHighlighted .diffLineNumbersB,
.diff .lineHighlighted .diffContentA,
.diff .lineHighlighted .diffContentB,
.diff .lineHighlighted .ediffContentA,
.diff .lineHighlighted .ediffContentB,
.diff .lineHighlighted .ediffChangedA,
.diff .lineHighlighted .ediffChangedB {
  background-color:#FFE7C6;
}
.textDelMarker, .textAddMarker {
  font-weight:bold;
}
td.diffLineNumbersA,
.textDelMarker {
  color:red;
}
td.diffLineNumbersB,
.textAddMarker {
  color:green;
}
#quickSearch {
    color:#333;
    font-size:x-small;
}
input.qsInput {
    height:12px;
}

.help {
    background:transparent url(images/icn_12_help.gif) no-repeat right;
    padding-right:14px;
}
.adminHelp {
    background:transparent url(images/icn_12_help.gif) no-repeat left;
    padding-right:10px;
}
a.adminHelp:hover {
    text-decoration:none;
}
a.navPrevious {
    background:transparent url(images/icn_12_arrowleft.gif) no-repeat left;
    padding-left:16px;
}
a.navNext {
    background:transparent url(images/icn_12_arrowright.gif) no-repeat right;
    padding-right:16px;
}


/* Browser Specific Styles */



/*
ua=safari




*/
.uaIndicator{ color:




 pink
} /* grey is default */
table.diff td, .annPane{


 font-size:0.95em;
}



 .diffPaneChangset{ font-size:140% }
 pre.csComment{ font-size:135%; }

.affectedFiles { border: 1px #cccccc dotted; background-color: #eeeeee; font-style: italic; }
</style>
</head>
<body>

<h1>osCommerce Online Merchant v2.2 RC2 Upgrade Notes</h1>

<p>The following upgrade guide is based on the osCommerce 2.2 Release Candidate 1 release. If you have not yet updated to this release please review its upgrade guide in the extras directory (<a href="extras/upgrade-22rc1.html">upgrade-22rc1.html</a>) before applying these changes.</p>

<p>The following changes should be performed in order to upgrade an existing osCommerce Online Merchant v2.2 RC1 store to v2.2 RC2.</p>

<p><small><i>Legend: [SQL] Database Changes; [A] Administration Tool; [C] Catalog</i></small></p>

<ul>
  <li>[SQL] Database changes</li>
  <li>[A] Allow Administration Tool elements to be dynamically controlled</li>
  <li>[C] Update download delivery routine</li>
  <li>[C] Remove redundant currencies</li>
  <li>[C] Update the navigation history class</li>
  <li>[C] Update the order totals class</li>
  <li>[C] Checkout procedure update</li>
  <li>[C] Update product notifications</li>
  <li>[AC] Improve register_globals compatibility layer</li>
  <li>[AC] Introduce public orders and downloads status flags</li>
  <li>[C] Update the free shipping method title</li>
  <li>[C] Update credit card error messages</li>
  <li>[A] Update File Manager</li>
  <li>[A] Update the table block class</li>
  <li>[A] MySQL 5.0 Strict Mode compatibility updates</li>
  <li>[A] Update http_build_query() compatibility function</li>
  <li>[A] Update Newsletter Manager</li>
  <li>[AC] Update database session storage handler</li>
  <li>[A] Update administration of categories</li>
  <li>[C] Update processing of Address Book entries</li>
  <li>[A] Update administration of product attributes</li>
  <li>[A] Protect includes directory from direct HTTP requests</li>
  <li>[A] Display module version if available</li>
  <li>[A] Update database backup and restoration</li>
  <li>[C] Update new products module</li>
</ul>

<h3>[SQL] Database changes</h3>

<ul>
  <li>Add indexes to increase performance</li>
  <li>Add public and download status flag fields to the orders_status table</li>
  <li>Increase payment_method field size on the orders table</li>
  <li>Increase the last_page_url field size on the whos_online table</li>
</ul>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
  <tr>
    <td class="lineContent diffContent">alter table banners add index idx_banners_group (banners_group);
alter table banners_history add index idx_banners_history_banners_id (banners_id);
alter table currencies add index idx_currencies_code (code);
alter table customers add index idx_customers_email_address (customers_email_address);
alter table customers_basket add index idx_customers_basket_customers_id (customers_id);
alter table customers_basket_attributes add index idx_customers_basket_att_customers_id (customers_id);
alter table orders add index idx_orders_customers_id (customers_id);
alter table orders_products add index idx_orders_products_orders_id (orders_id);
alter table orders_products add index idx_orders_products_products_id (products_id);
alter table orders_status_history add index idx_orders_status_history_orders_id (orders_id);
alter table orders_products_attributes add index idx_orders_products_att_orders_id (orders_id);
alter table orders_products_download add index idx_orders_products_download_orders_id (orders_id);
alter table products add index idx_products_model (products_model);
alter table products_attributes add index idx_products_attributes_products_id (products_id);
alter table reviews add index idx_reviews_products_id (products_id);
alter table reviews add index idx_reviews_customers_id (customers_id);
alter table specials add index idx_specials_products_id (products_id);
alter table zones add index idx_zones_to_geo_zones_country_id (zone_country_id);

alter table orders_status add public_flag int DEFAULT '1';
alter table orders_status add downloads_flag int DEFAULT '0';

alter table orders modify payment_method varchar(255) NOT NULL;

alter table whos_online modify last_page_url text NOT NULL;</td>
  </tr>
</table>

<h3>[A] Allow Administration Tool elements to be dynamically controlled</h3>

<ul>
  <li>Add toggleDivBlock() Javascript function to admin/includes/general.js to allow elements on the Administration Tool to be dynamically controlled.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/includes/general.js</p>

<span class="affectedFiles">File: catalog/admin/includes/general.js (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/general.js?r1=1635&r2=1663">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/general.js?r1=1635&r2=1663">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">31</td><td class="diffLineNumbers">31</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">function rowOutEffect(object) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">32</td><td class="diffLineNumbers">32</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; if (object.className == &#039;dataTableRowOver&#039;) object.className = &#039;dataTableRow&#039;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">33</td><td class="diffLineNumbers">33</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">}</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">34</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">35</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">function toggleDivBlock(id) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">36</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; if (document.getElementById) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">37</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; itm = document.getElementById(id);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">38</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; } else if (document.all){</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">39</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; itm = document.all[id];</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">40</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; } else if (document.layers){</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">41</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; itm = document.layers[id];</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">42</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">43</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">44</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; if (itm) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">45</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; if (itm.style.display != &#034;none&#034;) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">46</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; itm.style.display = &#034;none&#034;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">47</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">48</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; itm.style.display = &#034;block&#034;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">49</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">50</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">51</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">}</td>
        </tr>
</table>

<h3>[C] Update download delivery routine</h3>

<ul>
  <li>Fix downloads when "Download by redirect" and "SEFU" are both enabled.</li>
  <li>Fallback to readfile() download delivery mechanism if direct download files.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/download.php</p>

<span class="affectedFiles">File: catalog/download.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/download.php?r1=477&r2=1720">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/download.php?r1=477&r2=1720">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">90</td><td class="diffLineNumbers">90</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; umask(0000);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">91</td><td class="diffLineNumbers">91</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; mkdir(DIR_FS_DOWNLOAD_PUBLIC . $tempdir, 0777);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">92</td><td class="diffLineNumbers">92</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; symlink(DIR_FS_DOWNLOAD . $downloads[&#039;orders_products_filename&#039;], DIR_FS_DOWNLOAD_PUBLIC . $tempdir . &#039;/&#039; . $downloads[&#039;orders_products_filename&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">93</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">tep</span>_<span class="ediffChangedA">redirect</span>(DIR_<span class="ediffChangedA">WS</span>_DOWNLOAD_PUBLIC . $tempdir . &#039;/&#039; . $downloads[&#039;orders_products_filename&#039;])<span class="ediffChangedA">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">94</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp; <span class="ediffChangedA">}</span> <span class="ediffChangedA">else</span> {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">95</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA"><span class="ediffChangedA">/</span><span class="ediffChangedA">/</span> <span class="ediffChangedA">This</span> <span class="ediffChangedA">will</span> <span class="ediffChangedA">work</span> <span class="ediffChangedA">on</span> <span class="ediffChangedA">all</span> <span class="ediffChangedA">systems</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">but</span> <span class="ediffChangedA">will</span> <span class="ediffChangedA">need</span> <span class="ediffChangedA">considerable</span> <span class="ediffChangedA">resources</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">96</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA"><span class="ediffChangedA">/</span><span class="ediffChangedA">/</span> <span class="ediffChangedA">We</span> <span class="ediffChangedA">could</span> <span class="ediffChangedA">also</span> <span class="ediffChangedA">loop</span> <span class="ediffChangedA">with</span> <span class="ediffChangedA">fread</span>(<span class="ediffChangedA">$</span><span class="ediffChangedA">fp</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">4096</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">to</span> <span class="ediffChangedA">save</span> <span class="ediffChangedA">memory</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">97</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">readfile</span>(DIR_<span class="ediffChangedA">FS</span>_DOWNLOAD . $downloads[&#039;orders_products_filename&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">93</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">if</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">file</span>_<span class="ediffChangedB">exists</span>(DIR_<span class="ediffChangedB">FS</span>_DOWNLOAD_PUBLIC . $tempdir . &#039;/&#039; . $downloads[&#039;orders_products_filename&#039;])<span class="ediffChangedB">)</span> {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">94</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">tep</span><span class="ediffChangedB">_</span><span class="ediffChangedB">redirect</span>(<span class="ediffChangedB">tep</span><span class="ediffChangedB">_</span><span class="ediffChangedB">href</span><span class="ediffChangedB">_</span><span class="ediffChangedB">link</span>(DIR_<span class="ediffChangedB">WS</span>_DOWNLOAD<span class="ediffChangedB">_</span><span class="ediffChangedB">PUBLIC</span> . $<span class="ediffChangedB">tempdir</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">/</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">$</span>downloads[&#039;orders_products_filename&#039;])<span class="ediffChangedB">)</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">95</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">}</span></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">98</td><td class="diffLineNumbers">96</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">97</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">98</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">// Fallback to readfile() delivery method. This will work on all systems, but will need considerable resources</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">99</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; readfile(DIR_FS_DOWNLOAD . $downloads[&#039;orders_products_filename&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">99</td><td class="diffLineNumbers">100</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
</table>

<h3>[C] Remove redundant currencies</h3>

<ul>
  <li>Remove the secondary ex-euro currencies from display.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/classes/currencies.php</p>

<span class="affectedFiles">File: catalog/includes/classes/currencies.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/classes/currencies.php?r1=1592&r2=1803">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/classes/currencies.php?r1=1592&r2=1803">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">40</td><td class="diffLineNumbers">40</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($calculate_currency_value == true) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">41</td><td class="diffLineNumbers">41</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $rate = (tep_not_null($currency_value)) ? $currency_value : $this-&gt;currencies[$currency_type][&#039;value&#039;];</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">42</td><td class="diffLineNumbers">42</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $format_string = $this-&gt;currencies[$currency_type][&#039;symbol_left&#039;] . number_format(tep_round($number * $rate, $this-&gt;currencies[$currency_type][&#039;decimal_places&#039;]), $this-&gt;currencies[$currency_type][&#039;decimal_places&#039;], $this-&gt;currencies[$currency_type][&#039;decimal_point&#039;], $this-&gt;currencies[$currency_type][&#039;thousands_point&#039;]) . $this-&gt;currencies[$currency_type][&#039;symbol_right&#039;];</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">43</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">// if the selected currency is in the european euro-conversion and the default currency is euro,</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">44</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">// the currency will displayed in the national currency and euro currency</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">45</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( (DEFAULT_CURRENCY == &#039;EUR&#039;) &amp;&amp; ($currency_type == &#039;DEM&#039; || $currency_type == &#039;BEF&#039; || $currency_type == &#039;LUF&#039; || $currency_type == &#039;ESP&#039; || $currency_type == &#039;FRF&#039; || $currency_type == &#039;IEP&#039; || $currency_type == &#039;ITL&#039; || $currency_type == &#039;NLG&#039; || $currency_type == &#039;ATS&#039; || $currency_type == &#039;PTE&#039; || $currency_type == &#039;FIM&#039; || $currency_type == &#039;GRD&#039;) ) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">46</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $format_string .= &#039; &lt;small&gt;[&#039; . $this-&gt;format($number, true, &#039;EUR&#039;) . &#039;]&lt;/small&gt;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">47</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">48</td><td class="diffLineNumbers">43</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">49</td><td class="diffLineNumbers">44</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $format_string = $this-&gt;currencies[$currency_type][&#039;symbol_left&#039;] . number_format(tep_round($number, $this-&gt;currencies[$currency_type][&#039;decimal_places&#039;]), $this-&gt;currencies[$currency_type][&#039;decimal_places&#039;], $this-&gt;currencies[$currency_type][&#039;decimal_point&#039;], $this-&gt;currencies[$currency_type][&#039;thousands_point&#039;]) . $this-&gt;currencies[$currency_type][&#039;symbol_right&#039;];</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">50</td><td class="diffLineNumbers">45</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
</table>

<h3>[C] Update navigation history class</h3>

<ul>
  <li>Make sure $parameters is an array in the navigation history class.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/classes/navigation_history.php</p>

<span class="affectedFiles">File: catalog/includes/classes/navigation_history.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/classes/navigation_history.php?r1=1619&r2=1696">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/classes/navigation_history.php?r1=1619&r2=1696">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">127</td><td class="diffLineNumbers">127</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; function filter_parameters($parameters) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">128</td><td class="diffLineNumbers">128</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $clean = array();</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">129</td><td class="diffLineNumbers">129</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">130</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($parameters);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">131</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($key, $value) = each($parameters)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">132</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (strpos($key, &#039;_nh-dns&#039;) &lt; 1) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">133</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $clean[$key] = $value;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">130</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">if</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">is</span><span class="ediffChangedB">_</span><span class="ediffChangedB">array</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">parameters</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">{</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">131</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($parameters);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">132</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list($key, $value) = each($parameters)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">133</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (strpos($key, &#039;_nh-dns&#039;) &lt; 1) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">134</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $clean[$key] = $value;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">135</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">}</span></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">134</td><td class="diffLineNumbers">136</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">135</td><td class="diffLineNumbers">137</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">136</td><td class="diffLineNumbers">138</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
</table>

<h3>[C] Update order totals class</h3>

<ul>
  <li>Calling $order_total_modules->process() multiple times would duplicate the output data due to the modules already being instantiated.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/classes/order_total.php</p>

<span class="affectedFiles">File: catalog/includes/classes/order_total.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/classes/order_total.php?r1=477&r2=1698">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/classes/order_total.php?r1=477&r2=1698">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">38</td><td class="diffLineNumbers">38</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list(, $value) = each($this-&gt;modules)) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">39</td><td class="diffLineNumbers">39</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $class = substr($value, 0, strrpos($value, &#039;.&#039;));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">40</td><td class="diffLineNumbers">40</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($GLOBALS[$class]-&gt;enabled) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">41</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $GLOBALS[$class]-&gt;output = array();</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">41</td><td class="diffLineNumbers">42</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $GLOBALS[$class]-&gt;process();</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">42</td><td class="diffLineNumbers">43</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">43</td><td class="diffLineNumbers">44</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($GLOBALS[$class]-&gt;output); $i&lt;$n; $i++) {</td>
        </tr>
</table>

<h3>Checkout procedure update</h3>

<ul>
  <li>Introduce the ability to show additional checkout buttons on the shopping cart page for certain payment methods (eg, PayPal Express Checkout).</li>
  <li>Introduce the ability to define foreign shipping and billing addresses during the checkout procedure (eg, the shipping address provided by PayPal Express Checkout).</li>
  <li>Move the logic of storing the credit card number in the database from the order class to the payment module level.</li>
  <li>Add extra checks to the checkout process file.</li>
  <li>Don't query for a shipping address if the order only contains virtual products.</li>
  <li>Update the shipping address when a mixed (virtual+physical) order is being made.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/checkout_payment.php<br />
catalog/checkout_process.php<br />
catalog/checkout_shipping.php<br />
catalog/shopping_cart.php<br />
catalog/includes/header.php<br />
catalog/includes/classes/order.php<br />
catalog/includes/classes/payment.php<br />
catalog/includes/functions/general.php<br />
catalog/includes/modules/payment/cc.php<br />
catalog/includes/languages/english/shopping_cart.php<br />
catalog/includes/languages/espanol/shopping_cart.php<br />
catalog/includes/languages/german/shopping_cart.php</p>

<span class="affectedFiles">File: catalog/checkout_payment.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/checkout_payment.php?r1=1601&r2=1699">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/checkout_payment.php?r1=1601&r2=1699">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">52</td><td class="diffLineNumbers">52</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; $billto = $customer_default_address_id;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">53</td><td class="diffLineNumbers">53</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; } else {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">54</td><td class="diffLineNumbers">54</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">// verify the selected billing address</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">55</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; $check_address_query = tep_db_query(&#034;select count(*) as total from &#034; . TABLE_ADDRESS_BOOK . &#034; where customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and address_book_id = &#039;&#034; . (int)$billto . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">56</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; $check_address = tep_db_fetch_array($check_address_query);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">55</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">if</span> <span class="ediffChangedB">(</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">is</span><span class="ediffChangedB">_</span><span class="ediffChangedB">array</span><span class="ediffChangedB">(</span>$<span class="ediffChangedB">billto</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&amp;</span> <span class="ediffChangedB">empty</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">billto</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">|</span><span class="ediffChangedB">|</span> <span class="ediffChangedB">is</span><span class="ediffChangedB">_</span><span class="ediffChangedB">numeric</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">billto</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">)</span> <span class="ediffChangedB">{</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">56</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">$</span>check_address_query = tep_db_query(&#034;select count(*) as total from &#034; . TABLE_ADDRESS_BOOK . &#034; where customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and address_book_id = &#039;&#034; . (int)$billto . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">57</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check_address = tep_db_fetch_array($check_address_query);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">57</td><td class="diffLineNumbers">58</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">58</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; if ($check_address[&#039;total&#039;] != &#039;1&#039;) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">59</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $billto = $customer_default_address_id;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">60</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_session_is_registered(&#039;payment&#039;)) tep_session_unregister(&#039;payment&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">59</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($check_address[&#039;total&#039;] != &#039;1&#039;) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">60</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $billto = $customer_default_address_id;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">61</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_session_is_registered(&#039;payment&#039;)) tep_session_unregister(&#039;payment&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">62</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">}</span></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">61</td><td class="diffLineNumbers">63</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">62</td><td class="diffLineNumbers">64</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">63</td><td class="diffLineNumbers">65</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/checkout_process.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/checkout_process.php?r1=1621&r2=1750">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/checkout_process.php?r1=1621&r2=1750">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">17</td><td class="diffLineNumbers">17</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; $navigation-&gt;set_snapshot(array(&#039;mode&#039; =&gt; &#039;SSL&#039;, &#039;page&#039; =&gt; FILENAME_CHECKOUT_PAYMENT));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">18</td><td class="diffLineNumbers">18</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_LOGIN, &#039;&#039;, &#039;SSL&#039;));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">19</td><td class="diffLineNumbers">19</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">20</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp; </td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">21</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp; if (<span class="ediffChangedA">!</span><span class="ediffChangedA">tep</span>_<span class="ediffChangedA">session</span><span class="ediffChangedA">_</span><span class="ediffChangedA">is</span><span class="ediffChangedA">_</span><span class="ediffChangedA">registered</span>(<span class="ediffChangedA">&#039;</span><span class="ediffChangedA">sendto</span><span class="ediffChangedA">&#039;</span>)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">22</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_<span class="ediffChangedA">CHECKOUT</span>_<span class="ediffChangedA">PAYMENT</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">SSL</span><span class="ediffChangedA">&#039;</span>));</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">20</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">21</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB"><span class="ediffChangedB">/</span><span class="ediffChangedB">/</span> if <span class="ediffChangedB">there</span> <span class="ediffChangedB">is</span> <span class="ediffChangedB">nothing</span> <span class="ediffChangedB">in</span> <span class="ediffChangedB">the</span> <span class="ediffChangedB">customers</span> <span class="ediffChangedB">cart</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">redirect</span> <span class="ediffChangedB">them</span> <span class="ediffChangedB">to</span> <span class="ediffChangedB">the</span> <span class="ediffChangedB">shopping</span> <span class="ediffChangedB">cart</span> <span class="ediffChangedB">page</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">22</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp; <span class="ediffChangedB">if</span> (<span class="ediffChangedB">$</span><span class="ediffChangedB">cart</span><span class="ediffChangedB">-</span><span class="ediffChangedB">&gt;</span><span class="ediffChangedB">count</span>_<span class="ediffChangedB">contents</span>() <span class="ediffChangedB">&lt;</span> <span class="ediffChangedB">1</span>) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">23</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_<span class="ediffChangedB">SHOPPING</span>_<span class="ediffChangedB">CART</span>));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">23</td><td class="diffLineNumbers">24</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">24</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">26</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">// if no shipping method has been selected, redirect the customer to the shipping method selection page</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">27</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; if (!tep_session_is_registered(&#039;shipping&#039;) || !tep_session_is_registered(&#039;sendto&#039;)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">28</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_CHECKOUT_SHIPPING, &#039;&#039;, &#039;SSL&#039;));</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">29</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">30</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">25</td><td class="diffLineNumbers">31</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; if ( (tep_not_null(MODULE_PAYMENT_INSTALLED)) &amp;&amp; (!tep_session_is_registered(&#039;payment&#039;)) ) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">32</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_CHECKOUT_PAYMENT, &#039;&#039;, &#039;SSL&#039;));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">27</td><td class="diffLineNumbers">33</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;}</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">46</td><td class="diffLineNumbers">52</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; require(DIR_WS_CLASSES . &#039;order.php&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">47</td><td class="diffLineNumbers">53</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; $order = new order;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">48</td><td class="diffLineNumbers">54</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">55</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">// Stock Check</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">56</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; $any_out_of_stock = false;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">57</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; if (STOCK_CHECK == &#039;true&#039;) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">58</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($order-&gt;products); $i&lt;$n; $i++) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">59</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_check_stock($order-&gt;products[$i][&#039;id&#039;], $order-&gt;products[$i][&#039;qty&#039;])) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">60</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $any_out_of_stock = true;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">61</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">62</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">63</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; // Out of Stock</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">64</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; if ( (STOCK_ALLOW_CHECKOUT != &#039;true&#039;) &amp;&amp; ($any_out_of_stock == true) ) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">65</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_SHOPPING_CART));</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">66</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">67</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">68</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">69</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; $payment_modules-&gt;update_status();</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">70</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">71</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; if ( ( is_array($payment_modules-&gt;modules) &amp;&amp; (sizeof($payment_modules-&gt;modules) &gt; 1) &amp;&amp; !is_object($$payment) ) || (is_object($$payment) &amp;&amp; ($$payment-&gt;enabled == false)) ) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">72</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_CHECKOUT_PAYMENT, &#039;error_message=&#039; . urlencode(ERROR_NO_PAYMENT_MODULE_SELECTED), &#039;SSL&#039;));</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">73</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">74</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">49</td><td class="diffLineNumbers">75</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; require(DIR_WS_CLASSES . &#039;order_total.php&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">50</td><td class="diffLineNumbers">76</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; $order_total_modules = new order_total;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">51</td><td class="diffLineNumbers">77</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">66</td><td class="diffLineNumbers">92</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;customers_telephone&#039; =&gt; $order-&gt;customer[&#039;telephone&#039;], </td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">67</td><td class="diffLineNumbers">93</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;customers_email_address&#039; =&gt; $order-&gt;customer[&#039;email_address&#039;],</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">68</td><td class="diffLineNumbers">94</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;customers_address_format_id&#039; =&gt; $order-&gt;customer[&#039;format_id&#039;], </td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">69</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;delivery_name&#039; =&gt; $order-&gt;delivery[&#039;firstname&#039;] . &#039; &#039; . $order-&gt;delivery[&#039;lastname&#039;], </td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">95</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;delivery_name&#039; =&gt; <span class="ediffChangedB">trim</span><span class="ediffChangedB">(</span>$order-&gt;delivery[&#039;firstname&#039;] . &#039; &#039; . $order-&gt;delivery[&#039;lastname&#039;]<span class="ediffChangedB">)</span>,</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">70</td><td class="diffLineNumbers">96</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;delivery_company&#039; =&gt; $order-&gt;delivery[&#039;company&#039;],</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">71</td><td class="diffLineNumbers">97</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;delivery_street_address&#039; =&gt; $order-&gt;delivery[&#039;street_address&#039;], </td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">72</td><td class="diffLineNumbers">98</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;delivery_suburb&#039; =&gt; $order-&gt;delivery[&#039;suburb&#039;], </td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/checkout_shipping.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/checkout_shipping.php?r1=477&r2=1699">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/checkout_shipping.php?r1=477&r2=1699">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">30</td><td class="diffLineNumbers">30</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; $sendto = $customer_default_address_id;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">31</td><td class="diffLineNumbers">31</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; } else {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">32</td><td class="diffLineNumbers">32</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">// verify the selected shipping address</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">33</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; $check_address_query = tep_db_query(&#034;select count(*) as total from &#034; . TABLE_ADDRESS_BOOK . &#034; where customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and address_book_id = &#039;&#034; . (int)$sendto . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">34</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; $check_address = tep_db_fetch_array($check_address_query);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">33</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">if</span> <span class="ediffChangedB">(</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">is</span><span class="ediffChangedB">_</span><span class="ediffChangedB">array</span><span class="ediffChangedB">(</span>$<span class="ediffChangedB">sendto</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&amp;</span> <span class="ediffChangedB">empty</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">sendto</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">|</span><span class="ediffChangedB">|</span> <span class="ediffChangedB">is</span><span class="ediffChangedB">_</span><span class="ediffChangedB">numeric</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">sendto</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">)</span> <span class="ediffChangedB">{</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">34</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">$</span>check_address_query = tep_db_query(&#034;select count(*) as total from &#034; . TABLE_ADDRESS_BOOK . &#034; where customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and address_book_id = &#039;&#034; . (int)$sendto . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">35</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $check_address = tep_db_fetch_array($check_address_query);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">35</td><td class="diffLineNumbers">36</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">36</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; if ($check_address[&#039;total&#039;] != &#039;1&#039;) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">37</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sendto = $customer_default_address_id;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">38</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_session_is_registered(&#039;shipping&#039;)) tep_session_unregister(&#039;shipping&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">37</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($check_address[&#039;total&#039;] != &#039;1&#039;) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">38</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sendto = $customer_default_address_id;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">39</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_session_is_registered(&#039;shipping&#039;)) tep_session_unregister(&#039;shipping&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">40</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">}</span></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">39</td><td class="diffLineNumbers">41</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">40</td><td class="diffLineNumbers">42</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">41</td><td class="diffLineNumbers">43</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/shopping_cart.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/shopping_cart.php?r1=703&r2=1699">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/shopping_cart.php?r1=703&r2=1699">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">12</td><td class="diffLineNumbers">12</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">13</td><td class="diffLineNumbers">13</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; require(&#034;includes/application_top.php&#034;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">14</td><td class="diffLineNumbers">14</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">15</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; if ($cart-&gt;count_contents() &gt; 0) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">16</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; include(DIR_WS_CLASSES . &#039;payment.php&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">17</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; $payment_modules = new payment;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">18</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">19</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">15</td><td class="diffLineNumbers">20</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; require(DIR_WS_LANGUAGES . $language . &#039;/&#039; . FILENAME_SHOPPING_CART);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">16</td><td class="diffLineNumbers">21</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">17</td><td class="diffLineNumbers">22</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; $breadcrumb-&gt;add(NAVBAR_TITLE, tep_href_link(FILENAME_SHOPPING_CART));</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">202</td><td class="diffLineNumbers">207</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">203</td><td class="diffLineNumbers">208</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">204</td><td class="diffLineNumbers">209</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">210</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; $initialize_checkout_methods = $payment_modules-&gt;checkout_initialization_method();</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">211</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">212</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; if (!empty($initialize_checkout_methods)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">213</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">?&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">214</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">215</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;?php echo tep_draw_separator(&#039;pixel_trans.gif&#039;, &#039;100%&#039;, &#039;10&#039;); ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">216</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">217</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">218</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;right&#034; class=&#034;main&#034; style=&#034;padding-right: 50px;&#034;&gt;&lt;?php echo TEXT_ALTERNATIVE_CHECKOUT_METHODS; ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">219</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">220</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&lt;?php</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">221</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($initialize_checkout_methods);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">222</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list(, $value) = each($initialize_checkout_methods)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">223</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">?&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">224</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">225</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;?php echo tep_draw_separator(&#039;pixel_trans.gif&#039;, &#039;100%&#039;, &#039;10&#039;); ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">226</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">227</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">228</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;right&#034; class=&#034;main&#034;&gt;&lt;?php echo $value; ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">229</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">230</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&lt;?php</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">231</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">232</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">205</td><td class="diffLineNumbers">233</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; } else {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">206</td><td class="diffLineNumbers">234</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">207</td><td class="diffLineNumbers">235</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/header.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/header.php?r1=1626&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/header.php?r1=1626&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">69</td><td class="diffLineNumbers">69</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">70</td><td class="diffLineNumbers">70</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;table border=&#034;0&#034; width=&#034;100%&#034; cellspacing=&#034;0&#034; cellpadding=&#034;2&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">71</td><td class="diffLineNumbers">71</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; &lt;tr class=&#034;headerError&#034;&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">72</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; &lt;td class=&#034;headerError&#034;&gt;&lt;?php echo htmlspecialchars(urldecode($HTTP_GET_VARS[&#039;error_message&#039;])); ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">72</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; &lt;td class=&#034;headerError&#034;&gt;&lt;?php echo htmlspecialchars(<span class="ediffChangedB">stripslashes</span><span class="ediffChangedB">(</span>urldecode($HTTP_GET_VARS[&#039;error_message&#039;]))<span class="ediffChangedB">)</span>; ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">73</td><td class="diffLineNumbers">73</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">74</td><td class="diffLineNumbers">74</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;/table&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">75</td><td class="diffLineNumbers">75</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">79</td><td class="diffLineNumbers">79</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">80</td><td class="diffLineNumbers">80</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;table border=&#034;0&#034; width=&#034;100%&#034; cellspacing=&#034;0&#034; cellpadding=&#034;2&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">81</td><td class="diffLineNumbers">81</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; &lt;tr class=&#034;headerInfo&#034;&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">82</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; &lt;td class=&#034;headerInfo&#034;&gt;&lt;?php echo htmlspecialchars($HTTP_GET_VARS[&#039;info_message&#039;]); ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">82</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; &lt;td class=&#034;headerInfo&#034;&gt;&lt;?php echo htmlspecialchars(<span class="ediffChangedB">stripslashes</span><span class="ediffChangedB">(</span><span class="ediffChangedB">urldecode</span><span class="ediffChangedB">(</span>$HTTP_GET_VARS[&#039;info_message&#039;])<span class="ediffChangedB">)</span><span class="ediffChangedB">)</span>; ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">83</td><td class="diffLineNumbers">83</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">84</td><td class="diffLineNumbers">84</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;/table&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">85</td><td class="diffLineNumbers">85</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/classes/order.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/classes/order.php?r1=1620&r2=1750">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/classes/order.php?r1=1620&r2=1750">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">76</td><td class="diffLineNumbers">76</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;telephone&#039; =&gt; $order[&#039;customers_telephone&#039;],</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">77</td><td class="diffLineNumbers">77</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;email_address&#039; =&gt; $order[&#039;customers_email_address&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">78</td><td class="diffLineNumbers">78</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">79</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;delivery = array(&#039;name&#039; =&gt; $order[&#039;delivery_name&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">79</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;delivery = array(&#039;name&#039; =&gt; <span class="ediffChangedB">trim</span><span class="ediffChangedB">(</span>$order[&#039;delivery_name&#039;]<span class="ediffChangedB">)</span>,</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">80</td><td class="diffLineNumbers">80</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;company&#039; =&gt; $order[&#039;delivery_company&#039;],</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">81</td><td class="diffLineNumbers">81</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;street_address&#039; =&gt; $order[&#039;delivery_street_address&#039;],</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">82</td><td class="diffLineNumbers">82</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;suburb&#039; =&gt; $order[&#039;delivery_suburb&#039;],</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">131</td><td class="diffLineNumbers">131</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">132</td><td class="diffLineNumbers">132</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">133</td><td class="diffLineNumbers">133</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; function cart() {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">134</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $HTTP_POST_VARS, $customer_id, $sendto, $billto, $cart, $languages_id, $currency, $currencies, $shipping, $payment, $comments;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">134</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; global $HTTP_POST_VARS, $customer_id, $sendto, $billto, $cart, $languages_id, $currency, $currencies, $shipping, $payment, $comments<span class="ediffChangedB">,</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">customer</span><span class="ediffChangedB">_</span><span class="ediffChangedB">default</span><span class="ediffChangedB">_</span><span class="ediffChangedB">address</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">135</td><td class="diffLineNumbers">135</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">136</td><td class="diffLineNumbers">136</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;content_type = $cart-&gt;get_content_type();</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">137</td><td class="diffLineNumbers">137</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">138</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( ($this-&gt;content_type != &#039;virtual&#039;) &amp;&amp; ($sendto == false) ) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">139</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sendto = $customer_default_address_id;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">140</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">141</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">138</td><td class="diffLineNumbers">142</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_address_query = tep_db_query(&#034;select c.customers_firstname, c.customers_lastname, c.customers_telephone, c.customers_email_address, ab.entry_company, ab.entry_street_address, ab.entry_suburb, ab.entry_postcode, ab.entry_city, ab.entry_zone_id, z.zone_name, co.countries_id, co.countries_name, co.countries_iso_code_2, co.countries_iso_code_3, co.address_format_id, ab.entry_state from &#034; . TABLE_CUSTOMERS . &#034; c, &#034; . TABLE_ADDRESS_BOOK . &#034; ab left join &#034; . TABLE_ZONES . &#034; z on (ab.entry_zone_id = z.zone_id) left join &#034; . TABLE_COUNTRIES . &#034; co on (ab.entry_country_id = co.countries_id) where c.customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and ab.customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and c.customers_default_address_id = ab.address_book_id&#034;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">139</td><td class="diffLineNumbers">143</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_address = tep_db_fetch_array($customer_address_query);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">140</td><td class="diffLineNumbers">144</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">141</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $shipping_address_query = tep_db_query(&#034;select ab.entry_firstname, ab.entry_lastname, ab.entry_company, ab.entry_street_address, ab.entry_suburb, ab.entry_postcode, ab.entry_city, ab.entry_zone_id, z.zone_name, ab.entry_country_id, c.countries_id, c.countries_name, c.countries_iso_code_2, c.countries_iso_code_3, c.address_format_id, ab.entry_state from &#034; . TABLE_ADDRESS_BOOK . &#034; ab left join &#034; . TABLE_ZONES . &#034; z on (ab.entry_zone_id = z.zone_id) left join &#034; . TABLE_COUNTRIES . &#034; c on (ab.entry_country_id = c.countries_id) where ab.customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and ab.address_book_id = &#039;&#034; . (int)$sendto . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">142</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $shipping_address = tep_db_fetch_array($shipping_address_query);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">143</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">144</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $billing_address_query = tep_db_query(&#034;select ab.entry_firstname, ab.entry_lastname, ab.entry_company, ab.entry_street_address, ab.entry_suburb, ab.entry_postcode, ab.entry_city, ab.entry_zone_id, z.zone_name, ab.entry_country_id, c.countries_id, c.countries_name, c.countries_iso_code_2, c.countries_iso_code_3, c.address_format_id, ab.entry_state from &#034; . TABLE_ADDRESS_BOOK . &#034; ab left join &#034; . TABLE_ZONES . &#034; z on (ab.entry_zone_id = z.zone_id) left join &#034; . TABLE_COUNTRIES . &#034; c on (ab.entry_country_id = c.countries_id) where ab.customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and ab.address_book_id = &#039;&#034; . (int)$billto . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">145</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $billing_address = tep_db_fetch_array($billing_address_query);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">145</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($sendto) &amp;&amp; !empty($sendto)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">146</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $shipping_address = array(&#039;entry_firstname&#039; =&gt; $sendto[&#039;firstname&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">147</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_lastname&#039; =&gt; $sendto[&#039;lastname&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">148</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_company&#039; =&gt; $sendto[&#039;company&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">149</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_street_address&#039; =&gt; $sendto[&#039;street_address&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">150</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_suburb&#039; =&gt; $sendto[&#039;suburb&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">151</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_postcode&#039; =&gt; $sendto[&#039;postcode&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">152</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_city&#039; =&gt; $sendto[&#039;city&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">153</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_zone_id&#039; =&gt; $sendto[&#039;zone_id&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">154</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;zone_name&#039; =&gt; $sendto[&#039;zone_name&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">155</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_country_id&#039; =&gt; $sendto[&#039;country_id&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">156</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;countries_id&#039; =&gt; $sendto[&#039;country_id&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">157</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;countries_name&#039; =&gt; $sendto[&#039;country_name&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">158</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;countries_iso_code_2&#039; =&gt; $sendto[&#039;country_iso_code_2&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">159</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;countries_iso_code_3&#039; =&gt; $sendto[&#039;country_iso_code_3&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">160</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;address_format_id&#039; =&gt; $sendto[&#039;address_format_id&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">161</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_state&#039; =&gt; $sendto[&#039;zone_name&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">162</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (is_numeric($sendto)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">163</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $shipping_address_query = tep_db_query(&#034;select ab.entry_firstname, ab.entry_lastname, ab.entry_company, ab.entry_street_address, ab.entry_suburb, ab.entry_postcode, ab.entry_city, ab.entry_zone_id, z.zone_name, ab.entry_country_id, c.countries_id, c.countries_name, c.countries_iso_code_2, c.countries_iso_code_3, c.address_format_id, ab.entry_state from &#034; . TABLE_ADDRESS_BOOK . &#034; ab left join &#034; . TABLE_ZONES . &#034; z on (ab.entry_zone_id = z.zone_id) left join &#034; . TABLE_COUNTRIES . &#034; c on (ab.entry_country_id = c.countries_id) where ab.customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and ab.address_book_id = &#039;&#034; . (int)$sendto . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">164</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $shipping_address = tep_db_fetch_array($shipping_address_query);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">165</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">166</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $shipping_address = array(&#039;entry_firstname&#039; =&gt; null,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">167</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_lastname&#039; =&gt; null,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">168</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_company&#039; =&gt; null,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">169</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_street_address&#039; =&gt; null,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">170</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_suburb&#039; =&gt; null,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">171</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_postcode&#039; =&gt; null,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">172</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_city&#039; =&gt; null,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">173</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_zone_id&#039; =&gt; null,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">174</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;zone_name&#039; =&gt; null,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">175</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_country_id&#039; =&gt; null,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">176</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;countries_id&#039; =&gt; null,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">177</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;countries_name&#039; =&gt; null,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">178</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;countries_iso_code_2&#039; =&gt; null,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">179</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;countries_iso_code_3&#039; =&gt; null,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">180</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;address_format_id&#039; =&gt; 0,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">181</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_state&#039; =&gt; null);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">182</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">146</td><td class="diffLineNumbers">183</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">147</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tax_address_query = tep_db_query(&#034;select ab.entry_country_id, ab.entry_zone_id from &#034; . TABLE_ADDRESS_BOOK . &#034; ab left join &#034; . TABLE_ZONES . &#034; z on (ab.entry_zone_id = z.zone_id) where ab.customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and ab.address_book_id = &#039;&#034; . (int)($this-&gt;content_type == &#039;virtual&#039; ? $billto : $sendto) . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">148</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tax_address = tep_db_fetch_array($tax_address_query);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">184</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($billto) &amp;&amp; !empty($billto)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">185</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $billing_address = array(&#039;entry_firstname&#039; =&gt; $billto[&#039;firstname&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">186</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_lastname&#039; =&gt; $billto[&#039;lastname&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">187</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_company&#039; =&gt; $billto[&#039;company&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">188</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_street_address&#039; =&gt; $billto[&#039;street_address&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">189</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_suburb&#039; =&gt; $billto[&#039;suburb&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">190</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_postcode&#039; =&gt; $billto[&#039;postcode&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">191</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_city&#039; =&gt; $billto[&#039;city&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">192</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_zone_id&#039; =&gt; $billto[&#039;zone_id&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">193</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;zone_name&#039; =&gt; $billto[&#039;zone_name&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">194</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_country_id&#039; =&gt; $billto[&#039;country_id&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">195</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;countries_id&#039; =&gt; $billto[&#039;country_id&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">196</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;countries_name&#039; =&gt; $billto[&#039;country_name&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">197</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;countries_iso_code_2&#039; =&gt; $billto[&#039;country_iso_code_2&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">198</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;countries_iso_code_3&#039; =&gt; $billto[&#039;country_iso_code_3&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">199</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;address_format_id&#039; =&gt; $billto[&#039;address_format_id&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">200</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_state&#039; =&gt; $billto[&#039;zone_name&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">201</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">202</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $billing_address_query = tep_db_query(&#034;select ab.entry_firstname, ab.entry_lastname, ab.entry_company, ab.entry_street_address, ab.entry_suburb, ab.entry_postcode, ab.entry_city, ab.entry_zone_id, z.zone_name, ab.entry_country_id, c.countries_id, c.countries_name, c.countries_iso_code_2, c.countries_iso_code_3, c.address_format_id, ab.entry_state from &#034; . TABLE_ADDRESS_BOOK . &#034; ab left join &#034; . TABLE_ZONES . &#034; z on (ab.entry_zone_id = z.zone_id) left join &#034; . TABLE_COUNTRIES . &#034; c on (ab.entry_country_id = c.countries_id) where ab.customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and ab.address_book_id = &#039;&#034; . (int)$billto . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">203</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $billing_address = tep_db_fetch_array($billing_address_query);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">204</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">149</td><td class="diffLineNumbers">205</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">206</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($this-&gt;content_type == &#039;virtual&#039;) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">207</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tax_address = array(&#039;entry_country_id&#039; =&gt; $billing_address[&#039;entry_country_id&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">208</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_zone_id&#039; =&gt; $billing_address[&#039;entry_zone_id&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">209</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">210</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tax_address = array(&#039;entry_country_id&#039; =&gt; $shipping_address[&#039;entry_country_id&#039;],</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">211</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;entry_zone_id&#039; =&gt; $shipping_address[&#039;entry_zone_id&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">212</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">213</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">150</td><td class="diffLineNumbers">214</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;info = array(&#039;order_status&#039; =&gt; DEFAULT_ORDERS_STATUS_ID,</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">151</td><td class="diffLineNumbers">215</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;currency&#039; =&gt; $currency,</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">152</td><td class="diffLineNumbers">216</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;currency_value&#039; =&gt; $currencies-&gt;currencies[$currency][&#039;value&#039;],</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">153</td><td class="diffLineNumbers">217</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;payment_method&#039; =&gt; $payment,</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">154</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;cc_type&#039; =&gt; <span class="ediffChangedA">(</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span><span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">POST</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span>&#039;<span class="ediffChangedA">cc</span><span class="ediffChangedA">_</span><span class="ediffChangedA">type</span>&#039;<span class="ediffChangedA">]</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">?</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">POST</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">cc</span><span class="ediffChangedA">_</span><span class="ediffChangedA">type</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span> <span class="ediffChangedA">:</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span>,</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">155</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;cc_owner&#039; =&gt; <span class="ediffChangedA">(</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span><span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">POST</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span>&#039;<span class="ediffChangedA">cc</span><span class="ediffChangedA">_</span><span class="ediffChangedA">owner</span>&#039;<span class="ediffChangedA">]</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">?</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">POST</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">cc</span><span class="ediffChangedA">_</span><span class="ediffChangedA">owner</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span> <span class="ediffChangedA">:</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span>,</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">156</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;cc_number&#039; =&gt; <span class="ediffChangedA">(</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span><span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">POST</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span>&#039;<span class="ediffChangedA">cc</span><span class="ediffChangedA">_</span><span class="ediffChangedA">number</span><span class="ediffChangedA">_</span><span class="ediffChangedA">nh</span><span class="ediffChangedA">-</span><span class="ediffChangedA">dns</span>&#039;<span class="ediffChangedA">]</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">?</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">POST</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">cc</span><span class="ediffChangedA">_</span><span class="ediffChangedA">number</span><span class="ediffChangedA">_</span><span class="ediffChangedA">nh</span><span class="ediffChangedA">-</span><span class="ediffChangedA">dns</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span> <span class="ediffChangedA">:</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span>,</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">157</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;cc_expires&#039; =&gt; <span class="ediffChangedA">(</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span><span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">POST</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span>&#039;<span class="ediffChangedA">cc</span><span class="ediffChangedA">_</span><span class="ediffChangedA">expires</span>&#039;<span class="ediffChangedA">]</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">?</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">POST</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">cc</span><span class="ediffChangedA">_</span><span class="ediffChangedA">expires</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span> <span class="ediffChangedA">:</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span>,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">218</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;cc_type&#039; =&gt; &#039;&#039;,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">219</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;cc_owner&#039; =&gt; &#039;&#039;,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">220</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;cc_number&#039; =&gt; &#039;&#039;,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">221</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;cc_expires&#039; =&gt; &#039;&#039;,</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">158</td><td class="diffLineNumbers">222</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;shipping_method&#039; =&gt; $shipping[&#039;title&#039;],</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">159</td><td class="diffLineNumbers">223</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;shipping_cost&#039; =&gt; $shipping[&#039;cost&#039;],</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">160</td><td class="diffLineNumbers">224</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;subtotal&#039; =&gt; 0,</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/classes/payment.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/classes/payment.php?r1=477&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/classes/payment.php?r1=477&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">122</td><td class="diffLineNumbers">122</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $js;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">123</td><td class="diffLineNumbers">123</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">124</td><td class="diffLineNumbers">124</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">125</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; function checkout_initialization_method() {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">126</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $initialize_array = array();</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">127</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">128</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_array($this-&gt;modules)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">129</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reset($this-&gt;modules);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">130</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (list(, $value) = each($this-&gt;modules)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">131</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $class = substr($value, 0, strrpos($value, &#039;.&#039;));</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">132</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($GLOBALS[$class]-&gt;enabled &amp;&amp; method_exists($GLOBALS[$class], &#039;checkout_initialization_method&#039;)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">133</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $initialize_array[] = $GLOBALS[$class]-&gt;checkout_initialization_method();</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">134</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">135</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">136</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">137</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">138</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $initialize_array;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">139</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">140</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">125</td><td class="diffLineNumbers">141</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; function selection() {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">126</td><td class="diffLineNumbers">142</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $selection_array = array();</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">127</td><td class="diffLineNumbers">143</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/functions/general.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/functions/general.php?r1=1612&r2=1699">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/functions/general.php?r1=1612&r2=1699">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">492</td><td class="diffLineNumbers">492</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">// Return a formatted address</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">493</td><td class="diffLineNumbers">493</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">// TABLES: customers, address_book</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">494</td><td class="diffLineNumbers">494</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; function tep_address_label($customers_id, $address_id = 1, $html = false, $boln = &#039;&#039;, $eoln = &#034;\n&#034;) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">495</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; if (is_array($address_id) &amp;&amp; !empty($address_id)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">496</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return tep_address_format($address_id[&#039;address_format_id&#039;], $address_id, $html, $boln, $eoln);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">497</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">498</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">495</td><td class="diffLineNumbers">499</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; $address_query = tep_db_query(&#034;select entry_firstname as firstname, entry_lastname as lastname, entry_company as company, entry_street_address as street_address, entry_suburb as suburb, entry_city as city, entry_postcode as postcode, entry_state as state, entry_zone_id as zone_id, entry_country_id as country_id from &#034; . TABLE_ADDRESS_BOOK . &#034; where customers_id = &#039;&#034; . (int)$customers_id . &#034;&#039; and address_book_id = &#039;&#034; . (int)$address_id . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">496</td><td class="diffLineNumbers">500</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; $address = tep_db_fetch_array($address_query);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">497</td><td class="diffLineNumbers">501</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/modules/payment/cc.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/modules/payment/cc.php?r1=1622&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/modules/payment/cc.php?r1=1622&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">122</td><td class="diffLineNumbers">122</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_CHECKOUT_PAYMENT, $payment_error_return, &#039;SSL&#039;, true, false));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">123</td><td class="diffLineNumbers">123</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">124</td><td class="diffLineNumbers">124</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">125</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $order-&gt;info[&#039;cc_owner&#039;] = $HTTP_POST_VARS[&#039;cc_owner&#039;];</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">125</td><td class="diffLineNumbers">126</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $order-&gt;info[&#039;cc_type&#039;] = $cc_validation-&gt;cc_type;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">127</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $order-&gt;info[&#039;cc_number&#039;] = $HTTP_POST_VARS[&#039;cc_number_nh-dns&#039;];</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">126</td><td class="diffLineNumbers">128</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $order-&gt;info[&#039;cc_expires&#039;] = $HTTP_POST_VARS[&#039;cc_expires_month&#039;] . $HTTP_POST_VARS[&#039;cc_expires_year&#039;];</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">127</td><td class="diffLineNumbers">129</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">128</td><td class="diffLineNumbers">130</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( (defined(&#039;MODULE_PAYMENT_CC_EMAIL&#039;)) &amp;&amp; (tep_validate_email(MODULE_PAYMENT_CC_EMAIL)) ) {</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/languages/english/shopping_cart.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/languages/english/shopping_cart.php?r1=477&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/languages/english/shopping_cart.php?r1=477&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">23</td><td class="diffLineNumbers">23</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">24</td><td class="diffLineNumbers">24</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;OUT_OF_STOCK_CANT_CHECKOUT&#039;, &#039;Products marked with &#039; . STOCK_MARK_PRODUCT_OUT_OF_STOCK . &#039; dont exist in desired quantity in our stock.&lt;br&gt;Please alter the quantity of products marked with (&#039; . STOCK_MARK_PRODUCT_OUT_OF_STOCK . &#039;), Thank you&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">25</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;OUT_OF_STOCK_CAN_CHECKOUT&#039;, &#039;Products marked with &#039; . STOCK_MARK_PRODUCT_OUT_OF_STOCK . &#039; dont exist in desired quantity in our stock.&lt;br&gt;You can buy them anyway and check the quantity we have in stock for immediate deliver in the checkout process.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">26</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">27</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_ALTERNATIVE_CHECKOUT_METHODS&#039;, &#039;- OR -&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">28</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/languages/espanol/shopping_cart.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/languages/espanol/shopping_cart.php?r1=477&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/languages/espanol/shopping_cart.php?r1=477&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">23</td><td class="diffLineNumbers">23</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">24</td><td class="diffLineNumbers">24</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;OUT_OF_STOCK_CANT_CHECKOUT&#039;, &#039;Los productos marcados con &#039; . STOCK_MARK_PRODUCT_OUT_OF_STOCK . &#039; no estan disponibles en la cantidad que requiere.&lt;br&gt;Modifique la cantidad de productos marcados con &#039; . STOCK_MARK_PRODUCT_OUT_OF_STOCK . &#039;, Gracias&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">25</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;OUT_OF_STOCK_CAN_CHECKOUT&#039;, &#039;Los productos marcados con &#039; . STOCK_MARK_PRODUCT_OUT_OF_STOCK . &#039; no estan disponibles en cantidad que requiere.&lt;br&gt;De todas formas, puede comprar los que hay disponibles y el resto se lo enviamos mas tarde o esperar a que la cantidad requerida este disponible.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">26</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">27</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_ALTERNATIVE_CHECKOUT_METHODS&#039;, &#039;- O -&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">28</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/languages/german/shopping_cart.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/languages/german/shopping_cart.php?r1=477&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/languages/german/shopping_cart.php?r1=477&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">23</td><td class="diffLineNumbers">23</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">24</td><td class="diffLineNumbers">24</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;OUT_OF_STOCK_CANT_CHECKOUT&#039;, &#039;Die mit &#039; . STOCK_MARK_PRODUCT_OUT_OF_STOCK . &#039; markierten Produkte, sind leider nicht in der von Ihnen gew&amp;uuml;nschten Menge auf Lager.&lt;br&gt;Bitte reduzieren Sie Ihre Bestellmenge f&amp;uuml;r die gekennzeichneten Produkte, vielen Dank&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">25</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;OUT_OF_STOCK_CAN_CHECKOUT&#039;, &#039;Die mit &#039; . STOCK_MARK_PRODUCT_OUT_OF_STOCK . &#039; markierten Produkte, sind leider nicht in der von Ihnen gew&amp;uuml;nschten Menge auf Lager.&lt;br&gt;Die bestellte Menge wird kurzfristig von uns geliefert, wenn Sie es w&amp;uuml;nschen nehmen wir auch eine Teillieferung vor.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">26</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">27</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_ALTERNATIVE_CHECKOUT_METHODS&#039;, &#039;- ODER -&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">28</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
</table>

<h3>[C] Update product notifications</h3>

<ul>
  <li>Correctly parse the products to remove from the product notifications list.</li>
  <li>Improve the product nofitication logic on the checkout success page.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/account_notifications.php<br />
catalog/checkout_success.php</p>

<span class="affectedFiles">File: catalog/account_notifications.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/account_notifications.php?r1=477&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/account_notifications.php?r1=477&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">38</td><td class="diffLineNumbers">38</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&#034;update &#034; . TABLE_CUSTOMERS_INFO . &#034; set global_product_notifications = &#039;&#034; . (int)$product_global . &#034;&#039; where customers_info_id = &#039;&#034; . (int)$customer_id . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">39</td><td class="diffLineNumbers">39</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; } elseif (sizeof($products) &gt; 0) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">40</td><td class="diffLineNumbers">40</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_parsed = array();</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">41</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">for</span> ($<span class="ediffChangedA">i</span><span class="ediffChangedA">=</span><span class="ediffChangedA">0</span>, $<span class="ediffChangedA">n</span>=<span class="ediffChangedA">sizeof</span>($products)<span class="ediffChangedA">;</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">i</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">$</span><span class="ediffChangedA">n</span><span class="ediffChangedA">;</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">i</span><span class="ediffChangedA">+</span><span class="ediffChangedA">+</span>) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">42</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_numeric($<span class="ediffChangedA">products</span><span class="ediffChangedA">[</span><span class="ediffChangedA">$</span><span class="ediffChangedA">i</span><span class="ediffChangedA">]</span>)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">43</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_parsed[] = $<span class="ediffChangedA">products</span><span class="ediffChangedA">[</span><span class="ediffChangedA">$</span><span class="ediffChangedA">i</span><span class="ediffChangedA">]</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">41</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">reset</span>($<span class="ediffChangedB">products</span><span class="ediffChangedB">)</span><span class="ediffChangedB">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">42</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">while</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">list</span><span class="ediffChangedB">(</span>, $<span class="ediffChangedB">value</span><span class="ediffChangedB">)</span> = <span class="ediffChangedB">each</span>($products)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">43</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_numeric($<span class="ediffChangedB">value</span>)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">44</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_parsed[] = $<span class="ediffChangedB">value</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">44</td><td class="diffLineNumbers">45</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">45</td><td class="diffLineNumbers">46</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">46</td><td class="diffLineNumbers">47</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/checkout_success.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/checkout_success.php?r1=477&r2=1749">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/checkout_success.php?r1=477&r2=1749">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">18</td><td class="diffLineNumbers">18</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">19</td><td class="diffLineNumbers">19</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">20</td><td class="diffLineNumbers">20</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; if (isset($HTTP_GET_VARS[&#039;action&#039;]) &amp;&amp; ($HTTP_GET_VARS[&#039;action&#039;] == &#039;update&#039;)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">21</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $notify_string = &#039;action=notify&amp;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">22</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $notify = $HTTP_POST_VARS[&#039;notify&#039;];</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">23</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; if (!is_array($notify)) $notify = array($notify);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">24</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($notify); $i&lt;$n; $i++) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">25</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $notify_string .= &#039;notify[]=&#039; . $notify[$i] . &#039;&amp;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">21</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; $notify_string = &#039;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">22</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">23</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; if (isset($HTTP_POST_VARS[&#039;notify&#039;]) &amp;&amp; !empty($HTTP_POST_VARS[&#039;notify&#039;])) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">24</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $notify = $HTTP_POST_VARS[&#039;notify&#039;];</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">25</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">26</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!is_array($notify)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">27</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $notify = array($notify);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">28</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">29</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">30</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($notify); $i&lt;$n; $i++) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">31</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (is_numeric($notify[$i])) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">32</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $notify_string .= &#039;notify[]=&#039; . $notify[$i] . &#039;&amp;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">33</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">34</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">35</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">36</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!empty($notify_string)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">37</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $notify_string = &#039;action=notify&amp;&#039; . substr($notify_string, 0, -1);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">38</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">39</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">27</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; if (strlen($notify_string) &gt; 0) $notify_string = substr($notify_string, 0, -1);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">28</td><td class="diffLineNumbers">40</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">29</td><td class="diffLineNumbers">41</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_DEFAULT, $notify_string));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">30</td><td class="diffLineNumbers">42</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
</table>

<h3>[AC] Improve register_globals compatibility layer</h3>

<ul>
  <li>Improve register_globals compatibility layer when registering session variables.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/includes/functions/sessions.php<br />
catalog/includes/functions/sessions.php</p>

<span class="affectedFiles">File: catalog/admin/includes/functions/sessions.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/functions/sessions.php?r1=1583&r2=1830">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/functions/sessions.php?r1=1583&r2=1830">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">10</td><td class="diffLineNumbers">10</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; Released under the GNU General Public License</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">11</td><td class="diffLineNumbers">11</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">*/</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">12</td><td class="diffLineNumbers">12</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">13</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; if ( (PHP_VERSION &gt;= 4.3) &amp;&amp; ((bool)ini_get(&#039;register_globals&#039;) == false) ) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">14</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; @ini_set(&#039;session.bug_compat_42&#039;, 1);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">15</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; @ini_set(&#039;session.bug_compat_warn&#039;, 0);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">16</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">17</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">13</td><td class="diffLineNumbers">18</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; if (STORE_SESSIONS == &#039;mysql&#039;) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">14</td><td class="diffLineNumbers">19</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; if (!$SESS_LIFE = get_cfg_var(&#039;session.gc_maxlifetime&#039;)) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">15</td><td class="diffLineNumbers">20</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $SESS_LIFE = 1440;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">106</td><td class="diffLineNumbers">111</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">107</td><td class="diffLineNumbers">112</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $_SESSION[$variable] = null;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">108</td><td class="diffLineNumbers">113</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">109</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $GLOBALS[$variable] =&amp; $_SESSION[$variable];</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">110</td><td class="diffLineNumbers">114</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">111</td><td class="diffLineNumbers">115</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">112</td><td class="diffLineNumbers">116</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; return false;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">116</td><td class="diffLineNumbers">120</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; if (PHP_VERSION &lt; 4.3) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">117</td><td class="diffLineNumbers">121</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return session_is_registered($variable);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">118</td><td class="diffLineNumbers">122</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">119</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return isset($_SESSION<span class="ediffChangedA">[</span>$variable<span class="ediffChangedA">]</span>);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">123</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return isset($_SESSION<span class="ediffChangedB">)</span> <span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&amp;</span> <span class="ediffChangedB">array</span><span class="ediffChangedB">_</span><span class="ediffChangedB">key</span><span class="ediffChangedB">_</span><span class="ediffChangedB">exists</span><span class="ediffChangedB">(</span>$variable<span class="ediffChangedB">,</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">_</span><span class="ediffChangedB">SESSION</span>);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">120</td><td class="diffLineNumbers">124</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">121</td><td class="diffLineNumbers">125</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">122</td><td class="diffLineNumbers">126</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/functions/sessions.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/functions/sessions.php?r1=1647&r2=1830">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/functions/sessions.php?r1=1647&r2=1830">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">10</td><td class="diffLineNumbers">10</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; Released under the GNU General Public License</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">11</td><td class="diffLineNumbers">11</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">*/</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">12</td><td class="diffLineNumbers">12</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">13</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; if ( (PHP_VERSION &gt;= 4.3) &amp;&amp; ((bool)ini_get(&#039;register_globals&#039;) == false) ) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">14</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; @ini_set(&#039;session.bug_compat_42&#039;, 1);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">15</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; @ini_set(&#039;session.bug_compat_warn&#039;, 0);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">16</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">17</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">13</td><td class="diffLineNumbers">18</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; if (STORE_SESSIONS == &#039;mysql&#039;) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">14</td><td class="diffLineNumbers">19</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; if (!$SESS_LIFE = get_cfg_var(&#039;session.gc_maxlifetime&#039;)) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">15</td><td class="diffLineNumbers">20</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $SESS_LIFE = 1440;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">104</td><td class="diffLineNumbers">109</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (PHP_VERSION &lt; 4.3) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">105</td><td class="diffLineNumbers">110</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return session_register($variable);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">106</td><td class="diffLineNumbers">111</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">107</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">$</span><span class="ediffChangedA">_</span><span class="ediffChangedA">SESSION</span><span class="ediffChangedA">[</span><span class="ediffChangedA">$</span><span class="ediffChangedA">variable</span><span class="ediffChangedA">]</span> <span class="ediffChangedA">=</span> (isset($GLOBALS[$variable])) <span class="ediffChangedA">?</span> $<span class="ediffChangedA">GLOBALS</span>[$variable] <span class="ediffChangedA">:</span> <span class="ediffChangedA">null</span><span class="ediffChangedA">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">108</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">109</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $GLOBALS[$variable] <span class="ediffChangedA">=</span><span class="ediffChangedA">&amp;</span> $_SESSION[$variable];</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">112</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">if</span> (isset($GLOBALS[$variable])) <span class="ediffChangedB">{</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">113</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $<span class="ediffChangedB">_</span><span class="ediffChangedB">SESSION</span>[$variable] <span class="ediffChangedB">=</span><span class="ediffChangedB">&amp;</span> $GLOBALS[$variable]<span class="ediffChangedB">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">114</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">}</span> <span class="ediffChangedB">else</span> <span class="ediffChangedB">{</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">115</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $_SESSION[$variable] <span class="ediffChangedB">=</span> <span class="ediffChangedB">null</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">116</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">}</span></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">110</td><td class="diffLineNumbers">117</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">111</td><td class="diffLineNumbers">118</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">112</td><td class="diffLineNumbers">119</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">117</td><td class="diffLineNumbers">124</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; if (PHP_VERSION &lt; 4.3) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">118</td><td class="diffLineNumbers">125</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return session_is_registered($variable);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">119</td><td class="diffLineNumbers">126</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">120</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return isset($_SESSION<span class="ediffChangedA">[</span>$variable<span class="ediffChangedA">]</span>);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">127</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return isset($_SESSION<span class="ediffChangedB">)</span> <span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&amp;</span> <span class="ediffChangedB">array</span><span class="ediffChangedB">_</span><span class="ediffChangedB">key</span><span class="ediffChangedB">_</span><span class="ediffChangedB">exists</span><span class="ediffChangedB">(</span>$variable<span class="ediffChangedB">,</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">_</span><span class="ediffChangedB">SESSION</span>);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">121</td><td class="diffLineNumbers">128</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">122</td><td class="diffLineNumbers">129</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">123</td><td class="diffLineNumbers">130</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
</table>

<h3>[AC] Introduce public orders and downloads status flags</h3>

<ul>
  <li>Introduce public order status flags to show or hide orders from customers depending on the order status level.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/orders_status.php<br />
catalog/admin/includes/languages/english/orders_status.php<br />
catalog/admin/includes/languages/espanol/orders_status.php<br />
catalog/admin/includes/languages/german/orders_status.php<br />
catalog/account.php<br />
catalog/account_history.php<br />
catalog/account_history_info.php<br />
catalog/download.php<br />
catalog/includes/functions/general.php<br />
catalog/includes/modules/downloads.php</p>

<span class="affectedFiles">File: catalog/admin/orders_status.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/orders_status.php?r1=477&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/orders_status.php?r1=477&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">25</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $orders_status_name_array = $HTTP_POST_VARS[&#039;orders_status_name&#039;];</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">26</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $language_id = $languages[$i][&#039;id&#039;];</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">27</td><td class="diffLineNumbers">27</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">28</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_data_array = array(&#039;orders_status_name&#039; =&gt; tep_db_prepare_input($orders_status_name_array[$language_id]));</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">28</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_data_array = array(&#039;orders_status_name&#039; =&gt; tep_db_prepare_input($orders_status_name_array[$language_id])<span class="ediffChangedB">,</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">29</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">public</span><span class="ediffChangedB">_</span><span class="ediffChangedB">flag</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">=</span><span class="ediffChangedB">&gt;</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">(</span><span class="ediffChangedB">isset</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">HTTP</span><span class="ediffChangedB">_</span><span class="ediffChangedB">POST</span><span class="ediffChangedB">_</span><span class="ediffChangedB">VARS</span><span class="ediffChangedB">[</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">public</span><span class="ediffChangedB">_</span><span class="ediffChangedB">flag</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">]</span>) <span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&amp;</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">HTTP</span><span class="ediffChangedB">_</span><span class="ediffChangedB">POST</span><span class="ediffChangedB">_</span><span class="ediffChangedB">VARS</span><span class="ediffChangedB">[</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">public</span><span class="ediffChangedB">_</span><span class="ediffChangedB">flag</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">]</span> <span class="ediffChangedB">=</span><span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">1</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">?</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">1</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">:</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">0</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">)</span><span class="ediffChangedB">,</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">30</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">downloads</span><span class="ediffChangedB">_</span><span class="ediffChangedB">flag</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">=</span><span class="ediffChangedB">&gt;</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">(</span><span class="ediffChangedB">isset</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">HTTP</span><span class="ediffChangedB">_</span><span class="ediffChangedB">POST</span><span class="ediffChangedB">_</span><span class="ediffChangedB">VARS</span><span class="ediffChangedB">[</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">downloads</span><span class="ediffChangedB">_</span><span class="ediffChangedB">flag</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">]</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&amp;</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">HTTP</span><span class="ediffChangedB">_</span><span class="ediffChangedB">POST</span><span class="ediffChangedB">_</span><span class="ediffChangedB">VARS</span><span class="ediffChangedB">[</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">downloads</span><span class="ediffChangedB">_</span><span class="ediffChangedB">flag</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">]</span> <span class="ediffChangedB">=</span><span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">1</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">?</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">1</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">:</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">0</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">29</td><td class="diffLineNumbers">31</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">30</td><td class="diffLineNumbers">32</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($action == &#039;insert&#039;) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">31</td><td class="diffLineNumbers">33</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (empty($orders_status_id)) {</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">127</td><td class="diffLineNumbers">129</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td valign=&#034;top&#034;&gt;&lt;table border=&#034;0&#034; width=&#034;100%&#034; cellspacing=&#034;0&#034; cellpadding=&#034;2&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">128</td><td class="diffLineNumbers">130</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr class=&#034;dataTableHeadingRow&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">129</td><td class="diffLineNumbers">131</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;dataTableHeadingContent&#034;&gt;&lt;?php echo TABLE_HEADING_ORDERS_STATUS; ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">132</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;dataTableHeadingContent&#034; align=&#034;center&#034;&gt;&lt;?php echo TABLE_HEADING_PUBLIC_STATUS; ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">133</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;dataTableHeadingContent&#034; align=&#034;center&#034;&gt;&lt;?php echo TABLE_HEADING_DOWNLOADS_STATUS; ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">130</td><td class="diffLineNumbers">134</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;dataTableHeadingContent&#034; align=&#034;right&#034;&gt;&lt;?php echo TABLE_HEADING_ACTION; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">131</td><td class="diffLineNumbers">135</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">132</td><td class="diffLineNumbers">136</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">133</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp; $orders_status_query_raw = &#034;select <span class="ediffChangedA">orders</span><span class="ediffChangedA">_</span><span class="ediffChangedA">status</span><span class="ediffChangedA">_</span><span class="ediffChangedA">id</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">orders</span><span class="ediffChangedA">_</span><span class="ediffChangedA">status</span><span class="ediffChangedA">_</span><span class="ediffChangedA">name</span> from &#034; . TABLE_ORDERS_STATUS . &#034; where language_id = &#039;&#034; . (int)$languages_id . &#034;&#039; order by orders_status_id&#034;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">137</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp; $orders_status_query_raw = &#034;select <span class="ediffChangedB">*</span> from &#034; . TABLE_ORDERS_STATUS . &#034; where language_id = &#039;&#034; . (int)$languages_id . &#034;&#039; order by orders_status_id&#034;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">134</td><td class="diffLineNumbers">138</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; $orders_status_split = new splitPageResults($HTTP_GET_VARS[&#039;page&#039;], MAX_DISPLAY_SEARCH_RESULTS, $orders_status_query_raw, $orders_status_query_numrows);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">135</td><td class="diffLineNumbers">139</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; $orders_status_query = tep_db_query($orders_status_query_raw);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">136</td><td class="diffLineNumbers">140</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; while ($orders_status = tep_db_fetch_array($orders_status_query)) {</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">150</td><td class="diffLineNumbers">154</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;dataTableContent&#034;&gt;&#039; . $orders_status[&#039;orders_status_name&#039;] . &#039;&lt;/td&gt;&#039; . &#034;\n&#034;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">151</td><td class="diffLineNumbers">155</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">152</td><td class="diffLineNumbers">156</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">157</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;dataTableContent&#034; align=&#034;center&#034;&gt;&lt;?php echo tep_image(DIR_WS_IMAGES . &#039;icons/&#039; . (($orders_status[&#039;public_flag&#039;] == &#039;1&#039;) ? &#039;tick.gif&#039; : &#039;cross.gif&#039;)); ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">158</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;dataTableContent&#034; align=&#034;center&#034;&gt;&lt;?php echo tep_image(DIR_WS_IMAGES . &#039;icons/&#039; . (($orders_status[&#039;downloads_flag&#039;] == &#039;1&#039;) ? &#039;tick.gif&#039; : &#039;cross.gif&#039;)); ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">153</td><td class="diffLineNumbers">159</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;dataTableContent&#034; align=&#034;right&#034;&gt;&lt;?php if (isset($oInfo) &amp;&amp; is_object($oInfo) &amp;&amp; ($orders_status[&#039;orders_status_id&#039;] == $oInfo-&gt;orders_status_id)) { echo tep_image(DIR_WS_IMAGES . &#039;icon_arrow_right.gif&#039;, &#039;&#039;); } else { echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_ORDERS_STATUS, &#039;page=&#039; . $HTTP_GET_VARS[&#039;page&#039;] . &#039;&amp;oID=&#039; . $orders_status[&#039;orders_status_id&#039;]) . &#039;&#034;&gt;&#039; . tep_image(DIR_WS_IMAGES . &#039;icon_info.gif&#039;, IMAGE_ICON_INFO) . &#039;&lt;/a&gt;&#039;; } ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">154</td><td class="diffLineNumbers">160</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">155</td><td class="diffLineNumbers">161</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">156</td><td class="diffLineNumbers">162</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">157</td><td class="diffLineNumbers">163</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">158</td><td class="diffLineNumbers">164</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">159</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&#034;<span class="ediffChangedA">2</span>&#034;&gt;&lt;table border=&#034;0&#034; width=&#034;100%&#034; cellspacing=&#034;0&#034; cellpadding=&#034;2&#034;&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">165</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&#034;<span class="ediffChangedB">4</span>&#034;&gt;&lt;table border=&#034;0&#034; width=&#034;100%&#034; cellspacing=&#034;0&#034; cellpadding=&#034;2&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">160</td><td class="diffLineNumbers">166</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">161</td><td class="diffLineNumbers">167</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;smallText&#034; valign=&#034;top&#034;&gt;&lt;?php echo $orders_status_split-&gt;display_count($orders_status_query_numrows, MAX_DISPLAY_SEARCH_RESULTS, $HTTP_GET_VARS[&#039;page&#039;], TEXT_DISPLAY_NUMBER_OF_ORDERS_STATUS); ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">162</td><td class="diffLineNumbers">168</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;smallText&#034; align=&#034;right&#034;&gt;&lt;?php echo $orders_status_split-&gt;display_links($orders_status_query_numrows, MAX_DISPLAY_SEARCH_RESULTS, MAX_DISPLAY_PAGE_LINKS, $HTTP_GET_VARS[&#039;page&#039;]); ?&gt;&lt;/td&gt;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">191</td><td class="diffLineNumbers">197</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">192</td><td class="diffLineNumbers">198</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">193</td><td class="diffLineNumbers">199</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . TEXT_INFO_ORDERS_STATUS_NAME . $orders_status_inputs_string);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">200</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . tep_draw_checkbox_field(&#039;public_flag&#039;, &#039;1&#039;) . &#039; &#039; . TEXT_SET_PUBLIC_STATUS);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">201</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;text&#039; =&gt; tep_draw_checkbox_field(&#039;downloads_flag&#039;, &#039;1&#039;) . &#039; &#039; . TEXT_SET_DOWNLOADS_STATUS);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">194</td><td class="diffLineNumbers">202</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . tep_draw_checkbox_field(&#039;default&#039;) . &#039; &#039; . TEXT_SET_DEFAULT);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">195</td><td class="diffLineNumbers">203</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;align&#039; =&gt; &#039;center&#039;, &#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . tep_image_submit(&#039;button_insert.gif&#039;, IMAGE_INSERT) . &#039; &lt;a href=&#034;&#039; . tep_href_link(FILENAME_ORDERS_STATUS, &#039;page=&#039; . $HTTP_GET_VARS[&#039;page&#039;]) . &#039;&#034;&gt;&#039; . tep_image_button(&#039;button_cancel.gif&#039;, IMAGE_CANCEL) . &#039;&lt;/a&gt;&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">196</td><td class="diffLineNumbers">204</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">207</td><td class="diffLineNumbers">215</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">208</td><td class="diffLineNumbers">216</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">209</td><td class="diffLineNumbers">217</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . TEXT_INFO_ORDERS_STATUS_NAME . $orders_status_inputs_string);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">218</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . tep_draw_checkbox_field(&#039;public_flag&#039;, &#039;1&#039;, $oInfo-&gt;public_flag) . &#039; &#039; . TEXT_SET_PUBLIC_STATUS);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">219</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;text&#039; =&gt; tep_draw_checkbox_field(&#039;downloads_flag&#039;, &#039;1&#039;, $oInfo-&gt;downloads_flag) . &#039; &#039; . TEXT_SET_DOWNLOADS_STATUS);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">210</td><td class="diffLineNumbers">220</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (DEFAULT_ORDERS_STATUS_ID != $oInfo-&gt;orders_status_id) $contents[] = array(&#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . tep_draw_checkbox_field(&#039;default&#039;) . &#039; &#039; . TEXT_SET_DEFAULT);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">211</td><td class="diffLineNumbers">221</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;align&#039; =&gt; &#039;center&#039;, &#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . tep_image_submit(&#039;button_update.gif&#039;, IMAGE_UPDATE) . &#039; &lt;a href=&#034;&#039; . tep_href_link(FILENAME_ORDERS_STATUS, &#039;page=&#039; . $HTTP_GET_VARS[&#039;page&#039;] . &#039;&amp;oID=&#039; . $oInfo-&gt;orders_status_id) . &#039;&#034;&gt;&#039; . tep_image_button(&#039;button_cancel.gif&#039;, IMAGE_CANCEL) . &#039;&lt;/a&gt;&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">212</td><td class="diffLineNumbers">222</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/languages/english/orders_status.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/english/orders_status.php?r1=477&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/english/orders_status.php?r1=477&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">13</td><td class="diffLineNumbers">13</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;HEADING_TITLE&#039;, &#039;Orders Status&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">14</td><td class="diffLineNumbers">14</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">15</td><td class="diffLineNumbers">15</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TABLE_HEADING_ORDERS_STATUS&#039;, &#039;Orders Status&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">16</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TABLE_HEADING_PUBLIC_STATUS&#039;, &#039;Public Status&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">17</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TABLE_HEADING_DOWNLOADS_STATUS&#039;, &#039;Downloads Status&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">16</td><td class="diffLineNumbers">18</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TABLE_HEADING_ACTION&#039;, &#039;Action&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">17</td><td class="diffLineNumbers">19</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">18</td><td class="diffLineNumbers">20</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TEXT_INFO_EDIT_INTRO&#039;, &#039;Please make any necessary changes&#039;);</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">23</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TEXT_INFO_HEADING_EDIT_ORDERS_STATUS&#039;, &#039;Edit Orders Status&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">24</td><td class="diffLineNumbers">26</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TEXT_INFO_HEADING_DELETE_ORDERS_STATUS&#039;, &#039;Delete Orders Status&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">25</td><td class="diffLineNumbers">27</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">28</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_SET_PUBLIC_STATUS&#039;, &#039;Show the order to the customer at this order status level&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">29</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_SET_DOWNLOADS_STATUS&#039;, &#039;Allow downloads of virtual products at this order status level&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">30</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">31</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_REMOVE_DEFAULT_ORDER_STATUS&#039;, &#039;Error: The default order status can not be removed. Please set another order status as default, and try again.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">27</td><td class="diffLineNumbers">32</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_STATUS_USED_IN_ORDERS&#039;, &#039;Error: This order status is currently used in orders.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">28</td><td class="diffLineNumbers">33</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_STATUS_USED_IN_HISTORY&#039;, &#039;Error: This order status is currently used in the order status history.&#039;);</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/languages/espanol/orders_status.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/espanol/orders_status.php?r1=477&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/espanol/orders_status.php?r1=477&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">13</td><td class="diffLineNumbers">13</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;HEADING_TITLE&#039;, &#039;Estado Pedidos&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">14</td><td class="diffLineNumbers">14</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">15</td><td class="diffLineNumbers">15</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TABLE_HEADING_ORDERS_STATUS&#039;, &#039;Estado Pedidos&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">16</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TABLE_HEADING_PUBLIC_STATUS&#039;, &#039;Public Status&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">17</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TABLE_HEADING_DOWNLOADS_STATUS&#039;, &#039;Downloads Status&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">16</td><td class="diffLineNumbers">18</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TABLE_HEADING_ACTION&#039;, &#039;Acci&amp;oacute;n&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">17</td><td class="diffLineNumbers">19</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">18</td><td class="diffLineNumbers">20</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TEXT_INFO_EDIT_INTRO&#039;, &#039;Haga los cambios necesarios&#039;);</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">23</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TEXT_INFO_HEADING_EDIT_ORDERS_STATUS&#039;, &#039;Editar Estado Pedido&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">24</td><td class="diffLineNumbers">26</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TEXT_INFO_HEADING_DELETE_ORDERS_STATUS&#039;, &#039;Eliminar Estado Pedido&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">25</td><td class="diffLineNumbers">27</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">28</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_SET_PUBLIC_STATUS&#039;, &#039;Show the order to the customer at this order status level&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">29</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_SET_DOWNLOADS_STATUS&#039;, &#039;Allow downloads of virtual products at this order status level&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">30</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">31</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_REMOVE_DEFAULT_ORDER_STATUS&#039;, &#039;Error: El estado de pedido por defecto no se puede eliminar. Establezca otro estado de pedido predeterminado y pruebe de nuevo.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">27</td><td class="diffLineNumbers">32</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_STATUS_USED_IN_ORDERS&#039;, &#039;Error: Este estado de pedido esta siendo usado actualmente.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">28</td><td class="diffLineNumbers">33</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_STATUS_USED_IN_HISTORY&#039;, &#039;Error: Este estado de pedido se esta usando en algun hist&amp;oacute;rico de algun pedido.&#039;);</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/languages/german/orders_status.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/german/orders_status.php?r1=477&r2=1816">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/german/orders_status.php?r1=477&r2=1816">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">13</td><td class="diffLineNumbers">13</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;HEADING_TITLE&#039;, &#039;Bestellstatus&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">14</td><td class="diffLineNumbers">14</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">15</td><td class="diffLineNumbers">15</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TABLE_HEADING_ORDERS_STATUS&#039;, &#039;Bestellstatus&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">16</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TABLE_HEADING_PUBLIC_STATUS&#039;, &#039;sichtbar f&amp;uuml;r Kunde&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">17</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TABLE_HEADING_DOWNLOADS_STATUS&#039;, &#039;Downloads freigegeben&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">16</td><td class="diffLineNumbers">18</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TABLE_HEADING_ACTION&#039;, &#039;Aktion&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">17</td><td class="diffLineNumbers">19</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">18</td><td class="diffLineNumbers">20</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TEXT_INFO_EDIT_INTRO&#039;, &#039;Bitte f&amp;uuml;hren Sie alle notwendigen &amp;Auml;nderungen durch&#039;);</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">23</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TEXT_INFO_HEADING_EDIT_ORDERS_STATUS&#039;, &#039;Bestellstatus bearbeiten&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">24</td><td class="diffLineNumbers">26</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TEXT_INFO_HEADING_DELETE_ORDERS_STATUS&#039;, &#039;Bestellstatus l&amp;ouml;schen&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">25</td><td class="diffLineNumbers">27</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">28</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_SET_PUBLIC_STATUS&#039;, &#039;Bestellung wird dem Kunden bei diesem Bestellstatus angezeigt&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">29</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_SET_DOWNLOADS_STATUS&#039;, &#039;Virtuelle Produkte k&amp;ouml;nnen bei diesem Status heruntergeladen werden&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">30</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">31</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_REMOVE_DEFAULT_ORDER_STATUS&#039;, &#039;Fehler: Der Standard-Bestellstatus kann nicht gel&amp;ouml;scht werden. Bitte definieren Sie einen neuen Standard-Bestellstatus und wiederholen Sie den Vorgang.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">27</td><td class="diffLineNumbers">32</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_STATUS_USED_IN_ORDERS&#039;, &#039;Fehler: Dieser Bestellstatus wird zur Zeit noch bei den Bestellungen verwendet.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">28</td><td class="diffLineNumbers">33</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_STATUS_USED_IN_HISTORY&#039;, &#039;Fehler: Dieser Bestellstatus wird zur Zeit noch in der Bestellhistorie verwendet.&#039;);</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/account.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/account.php?r1=477&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/account.php?r1=477&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">94</td><td class="diffLineNumbers">94</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;main&#034; align=&#034;center&#034; valign=&#034;top&#034; width=&#034;130&#034;&gt;&lt;?php echo &#039;&lt;b&gt;&#039; . OVERVIEW_PREVIOUS_ORDERS . &#039;&lt;/b&gt;&lt;br&gt;&#039; . tep_image(DIR_WS_IMAGES . &#039;arrow_south_east.gif&#039;); ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">95</td><td class="diffLineNumbers">95</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&#034;0&#034; width=&#034;100%&#034; cellspacing=&#034;0&#034; cellpadding=&#034;2&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">96</td><td class="diffLineNumbers">96</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">97</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; $orders_query = tep_db_query(&#034;select o.orders_id, o.date_purchased, o.delivery_name, o.delivery_country, o.billing_name, o.billing_country, ot.text as order_total, s.orders_status_name from &#034; . TABLE_ORDERS . &#034; o, &#034; . TABLE_ORDERS_TOTAL . &#034; ot, &#034; . TABLE_ORDERS_STATUS . &#034; s where o.customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and o.orders_id = ot.orders_id and ot.class = &#039;ot_total&#039; and o.orders_status = s.orders_status_id and s.language_id = &#039;&#034; . (int)$languages_id . &#034;&#039; order by orders_id desc limit 3&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">97</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; $orders_query = tep_db_query(&#034;select o.orders_id, o.date_purchased, o.delivery_name, o.delivery_country, o.billing_name, o.billing_country, ot.text as order_total, s.orders_status_name from &#034; . TABLE_ORDERS . &#034; o, &#034; . TABLE_ORDERS_TOTAL . &#034; ot, &#034; . TABLE_ORDERS_STATUS . &#034; s where o.customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and o.orders_id = ot.orders_id and ot.class = &#039;ot_total&#039; and o.orders_status = s.orders_status_id and s.language_id = &#039;&#034; . (int)$languages_id . &#034;&#039; <span class="ediffChangedB">and</span> <span class="ediffChangedB">s</span><span class="ediffChangedB">.</span><span class="ediffChangedB">public</span><span class="ediffChangedB">_</span><span class="ediffChangedB">flag</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">1</span><span class="ediffChangedB">&#039;</span> order by orders_id desc limit 3&#034;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">98</td><td class="diffLineNumbers">98</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; while ($orders = tep_db_fetch_array($orders_query)) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">99</td><td class="diffLineNumbers">99</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_not_null($orders[&#039;delivery_name&#039;])) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">100</td><td class="diffLineNumbers">100</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $order_name = $orders[&#039;delivery_name&#039;];</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/account_history.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/account_history.php?r1=477&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/account_history.php?r1=477&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">62</td><td class="diffLineNumbers">62</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; $orders_total = tep_count_customer_orders();</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">63</td><td class="diffLineNumbers">63</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">64</td><td class="diffLineNumbers">64</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; if ($orders_total &gt; 0) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">65</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; $history_query_raw = &#034;select o.orders_id, o.date_purchased, o.delivery_name, o.billing_name, ot.text as order_total, s.orders_status_name from &#034; . TABLE_ORDERS . &#034; o, &#034; . TABLE_ORDERS_TOTAL . &#034; ot, &#034; . TABLE_ORDERS_STATUS . &#034; s where o.customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and o.orders_id = ot.orders_id and ot.class = &#039;ot_total&#039; and o.orders_status = s.orders_status_id and s.language_id = &#039;&#034; . (int)$languages_id . &#034;&#039; order by orders_id DESC&#034;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">65</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; $history_query_raw = &#034;select o.orders_id, o.date_purchased, o.delivery_name, o.billing_name, ot.text as order_total, s.orders_status_name from &#034; . TABLE_ORDERS . &#034; o, &#034; . TABLE_ORDERS_TOTAL . &#034; ot, &#034; . TABLE_ORDERS_STATUS . &#034; s where o.customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and o.orders_id = ot.orders_id and ot.class = &#039;ot_total&#039; and o.orders_status = s.orders_status_id and s.language_id = &#039;&#034; . (int)$languages_id . &#034;&#039; <span class="ediffChangedB">and</span> <span class="ediffChangedB">s</span><span class="ediffChangedB">.</span><span class="ediffChangedB">public</span><span class="ediffChangedB">_</span><span class="ediffChangedB">flag</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">1</span><span class="ediffChangedB">&#039;</span> order by orders_id DESC&#034;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">66</td><td class="diffLineNumbers">66</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; $history_split = new splitPageResults($history_query_raw, MAX_DISPLAY_ORDER_HISTORY);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">67</td><td class="diffLineNumbers">67</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; $history_query = tep_db_query($history_split-&gt;sql_query);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">68</td><td class="diffLineNumbers">68</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/account_history_info.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/account_history_info.php?r1=477&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/account_history_info.php?r1=477&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">21</td><td class="diffLineNumbers">21</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_ACCOUNT_HISTORY, &#039;&#039;, &#039;SSL&#039;));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">22</td><td class="diffLineNumbers">22</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">23</td><td class="diffLineNumbers">23</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; </td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">24</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp; $customer_info_query = tep_db_query(&#034;select customers_id from &#034; . TABLE_ORDERS . &#034; where orders_id = &#039;&#034;. (int)$HTTP_GET_VARS[&#039;order_id&#039;] . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">24</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp; $customer_info_query = tep_db_query(&#034;select <span class="ediffChangedB">o</span><span class="ediffChangedB">.</span>customers_id from &#034; . TABLE_ORDERS . &#034; <span class="ediffChangedB">o</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">TABLE</span><span class="ediffChangedB">_</span><span class="ediffChangedB">ORDERS</span><span class="ediffChangedB">_</span><span class="ediffChangedB">STATUS</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">s</span> where <span class="ediffChangedB">o</span><span class="ediffChangedB">.</span>orders_id = &#039;&#034;. (int)$HTTP_GET_VARS[&#039;order_id&#039;] . &#034;&#039; <span class="ediffChangedB">and</span> <span class="ediffChangedB">o</span><span class="ediffChangedB">.</span><span class="ediffChangedB">orders</span><span class="ediffChangedB">_</span><span class="ediffChangedB">status</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">s</span><span class="ediffChangedB">.</span><span class="ediffChangedB">orders</span><span class="ediffChangedB">_</span><span class="ediffChangedB">status</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">and</span> <span class="ediffChangedB">s</span><span class="ediffChangedB">.</span><span class="ediffChangedB">language</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span>&#034; <span class="ediffChangedB">.</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">int</span>)<span class="ediffChangedB">$</span><span class="ediffChangedB">languages</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">and</span> <span class="ediffChangedB">s</span><span class="ediffChangedB">.</span><span class="ediffChangedB">public</span><span class="ediffChangedB">_</span><span class="ediffChangedB">flag</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">1</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&#034;</span><span class="ediffChangedB">)</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">25</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; $customer_info = tep_db_fetch_array($customer_info_query);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">26</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; if ($customer_info[&#039;customers_id&#039;] != $customer_id) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">27</td><td class="diffLineNumbers">27</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_ACCOUNT_HISTORY, &#039;&#039;, &#039;SSL&#039;));</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">210</td><td class="diffLineNumbers">210</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr class=&#034;infoBoxContents&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">211</td><td class="diffLineNumbers">211</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td valign=&#034;top&#034;&gt;&lt;table border=&#034;0&#034; width=&#034;100%&#034; cellspacing=&#034;0&#034; cellpadding=&#034;2&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">212</td><td class="diffLineNumbers">212</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">213</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp; $statuses_query = tep_db_query(&#034;select os.orders_status_name, osh.date_added, osh.comments from &#034; . TABLE_ORDERS_STATUS . &#034; os, &#034; . TABLE_ORDERS_STATUS_HISTORY . &#034; osh where osh.orders_id = &#039;&#034; . (int)$HTTP_GET_VARS[&#039;order_id&#039;] . &#034;&#039; and osh.orders_status_id = os.orders_status_id and os.language_id = &#039;&#034; . (int)$languages_id . &#034;&#039; order by osh.date_added&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">213</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp; $statuses_query = tep_db_query(&#034;select os.orders_status_name, osh.date_added, osh.comments from &#034; . TABLE_ORDERS_STATUS . &#034; os, &#034; . TABLE_ORDERS_STATUS_HISTORY . &#034; osh where osh.orders_id = &#039;&#034; . (int)$HTTP_GET_VARS[&#039;order_id&#039;] . &#034;&#039; and osh.orders_status_id = os.orders_status_id and os.language_id = &#039;&#034; . (int)$languages_id . &#034;&#039; <span class="ediffChangedB">and</span> <span class="ediffChangedB">os</span><span class="ediffChangedB">.</span><span class="ediffChangedB">public</span><span class="ediffChangedB">_</span><span class="ediffChangedB">flag</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">1</span><span class="ediffChangedB">&#039;</span> order by osh.date_added&#034;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">214</td><td class="diffLineNumbers">214</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; while ($statuses = tep_db_fetch_array($statuses_query)) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">215</td><td class="diffLineNumbers">215</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; echo &#039;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;&#039; . &#034;\n&#034; .</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">216</td><td class="diffLineNumbers">216</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;main&#034; valign=&#034;top&#034; width=&#034;70&#034;&gt;&#039; . tep_date_short($statuses[&#039;date_added&#039;]) . &#039;&lt;/td&gt;&#039; . &#034;\n&#034; .</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/download.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/download.php?r1=1720&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/download.php?r1=1720&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">20</td><td class="diffLineNumbers">20</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">21</td><td class="diffLineNumbers">21</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; </td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">22</td><td class="diffLineNumbers">22</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">// Check that order_id, customer_id and filename match</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">23</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp; $downloads_query = tep_db_query(&#034;select date_format(o.date_purchased, &#039;%Y-%m-%d&#039;) as date_purchased_day, opd.download_maxdays, opd.download_count, opd.download_maxdays, opd.orders_products_filename from &#034; . TABLE_ORDERS . &#034; o, &#034; . TABLE_ORDERS_PRODUCTS . &#034; op, &#034; . TABLE_ORDERS_PRODUCTS_DOWNLOAD . &#034; opd where o.customers_id = &#039;&#034; . $customer_id . &#034;&#039; and o.orders_id = &#039;&#034; . (int)$HTTP_GET_VARS[&#039;order&#039;] . &#034;&#039; and o.orders_id = op.orders_id and op.orders_products_id = opd.orders_products_id and opd.orders_products_download_id = &#039;&#034; . (int)$HTTP_GET_VARS[&#039;id&#039;] . &#034;&#039; and opd.orders_products_filename != &#039;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">23</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp; $downloads_query = tep_db_query(&#034;select date_format(o.date_purchased, &#039;%Y-%m-%d&#039;) as date_purchased_day, opd.download_maxdays, opd.download_count, opd.download_maxdays, opd.orders_products_filename from &#034; . TABLE_ORDERS . &#034; o, &#034; . TABLE_ORDERS_PRODUCTS . &#034; op, &#034; . TABLE_ORDERS_PRODUCTS_DOWNLOAD . &#034; opd<span class="ediffChangedB">,</span> <span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">TABLE</span><span class="ediffChangedB">_</span><span class="ediffChangedB">ORDERS</span><span class="ediffChangedB">_</span><span class="ediffChangedB">STATUS</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">os</span> where o.customers_id = &#039;&#034; . $customer_id . &#034;&#039; and o.orders_id = &#039;&#034; . (int)$HTTP_GET_VARS[&#039;order&#039;] . &#034;&#039; and o.orders_id = op.orders_id and op.orders_products_id = opd.orders_products_id and opd.orders_products_download_id = &#039;&#034; . (int)$HTTP_GET_VARS[&#039;id&#039;] . &#034;&#039; and opd.orders_products_filename != &#039;&#039; <span class="ediffChangedB">and</span> <span class="ediffChangedB">o</span><span class="ediffChangedB">.</span><span class="ediffChangedB">orders</span><span class="ediffChangedB">_</span><span class="ediffChangedB">status</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">os</span><span class="ediffChangedB">.</span><span class="ediffChangedB">orders</span><span class="ediffChangedB">_</span><span class="ediffChangedB">status</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">and</span> <span class="ediffChangedB">os</span><span class="ediffChangedB">.</span><span class="ediffChangedB">downloads</span><span class="ediffChangedB">_</span><span class="ediffChangedB">flag</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">1</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">and</span> <span class="ediffChangedB">os</span><span class="ediffChangedB">.</span><span class="ediffChangedB">language</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span>&#034; <span class="ediffChangedB">.</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">int</span>)<span class="ediffChangedB">$</span><span class="ediffChangedB">languages</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&#034;</span><span class="ediffChangedB">)</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">24</td><td class="diffLineNumbers">24</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; if (!tep_db_num_rows($downloads_query)) die;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">25</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; $downloads = tep_db_fetch_array($downloads_query);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">26</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">// MySQL 3.22 does not have INTERVAL</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/functions/general.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/functions/general.php?r1=1699&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/functions/general.php?r1=1699&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">1252</td><td class="diffLineNumbers">1252</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">1253</td><td class="diffLineNumbers">1253</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">1254</td><td class="diffLineNumbers">1254</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; function tep_count_customer_orders($id = &#039;&#039;, $check_session = true) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">1255</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; global $customer_id;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">1255</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; global $customer_id<span class="ediffChangedB">,</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">languages</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">1256</td><td class="diffLineNumbers">1256</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">1257</td><td class="diffLineNumbers">1257</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; if (is_numeric($id) == false) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">1258</td><td class="diffLineNumbers">1258</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_session_is_registered(&#039;customer_id&#039;)) {</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">1268</td><td class="diffLineNumbers">1268</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">1269</td><td class="diffLineNumbers">1269</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">1270</td><td class="diffLineNumbers">1270</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">1271</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; $orders_check_query = tep_db_query(&#034;select count(*) as total from &#034; . TABLE_ORDERS . &#034; where customers_id = &#039;&#034; . (int)$id . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">1271</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; $orders_check_query = tep_db_query(&#034;select count(*) as total from &#034; . TABLE_ORDERS . &#034; <span class="ediffChangedB">o</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">TABLE</span><span class="ediffChangedB">_</span><span class="ediffChangedB">ORDERS</span><span class="ediffChangedB">_</span><span class="ediffChangedB">STATUS</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">s</span> where <span class="ediffChangedB">o</span><span class="ediffChangedB">.</span>customers_id = &#039;&#034; . (int)$id . &#034;&#039; <span class="ediffChangedB">and</span> <span class="ediffChangedB">o</span><span class="ediffChangedB">.</span><span class="ediffChangedB">orders</span><span class="ediffChangedB">_</span><span class="ediffChangedB">status</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">s</span><span class="ediffChangedB">.</span><span class="ediffChangedB">orders</span><span class="ediffChangedB">_</span><span class="ediffChangedB">status</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">and</span> <span class="ediffChangedB">s</span><span class="ediffChangedB">.</span><span class="ediffChangedB">language</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span>&#034; <span class="ediffChangedB">.</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">int</span>)<span class="ediffChangedB">$</span><span class="ediffChangedB">languages</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">and</span> <span class="ediffChangedB">s</span><span class="ediffChangedB">.</span><span class="ediffChangedB">public</span><span class="ediffChangedB">_</span><span class="ediffChangedB">flag</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">1</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&#034;</span><span class="ediffChangedB">)</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">1272</td><td class="diffLineNumbers">1272</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; $orders_check = tep_db_fetch_array($orders_check_query);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">1273</td><td class="diffLineNumbers">1273</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">1274</td><td class="diffLineNumbers">1274</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; return $orders_check[&#039;total&#039;];</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/modules/downloads.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/modules/downloads.php?r1=477&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/modules/downloads.php?r1=477&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">22</td><td class="diffLineNumbers">22</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">23</td><td class="diffLineNumbers">23</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">24</td><td class="diffLineNumbers">24</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">// Now get all downloadable products in that order</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">25</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp; $downloads_query = tep_db_query(&#034;select date_format(o.date_purchased, &#039;%Y-%m-%d&#039;) as date_purchased_day, opd.download_maxdays, op.products_name, opd.orders_products_download_id, opd.orders_products_filename, opd.download_count, opd.download_maxdays from &#034; . TABLE_ORDERS . &#034; o, &#034; . TABLE_ORDERS_PRODUCTS . &#034; op, &#034; . TABLE_ORDERS_PRODUCTS_DOWNLOAD . &#034; opd where o.customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and o.orders_id = &#039;&#034; . (int)$last_order . &#034;&#039; and o.orders_id = op.orders_id and op.orders_products_id = opd.orders_products_id and opd.orders_products_filename != &#039;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">25</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp; $downloads_query = tep_db_query(&#034;select date_format(o.date_purchased, &#039;%Y-%m-%d&#039;) as date_purchased_day, opd.download_maxdays, op.products_name, opd.orders_products_download_id, opd.orders_products_filename, opd.download_count, opd.download_maxdays from &#034; . TABLE_ORDERS . &#034; o, &#034; . TABLE_ORDERS_PRODUCTS . &#034; op, &#034; . TABLE_ORDERS_PRODUCTS_DOWNLOAD . &#034; opd<span class="ediffChangedB">,</span> <span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">TABLE</span><span class="ediffChangedB">_</span><span class="ediffChangedB">ORDERS</span><span class="ediffChangedB">_</span><span class="ediffChangedB">STATUS</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">os</span> where o.customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039; and o.orders_id = &#039;&#034; . (int)$last_order . &#034;&#039; and o.orders_id = op.orders_id and op.orders_products_id = opd.orders_products_id and opd.orders_products_filename != &#039;&#039; <span class="ediffChangedB">and</span> <span class="ediffChangedB">o</span><span class="ediffChangedB">.</span><span class="ediffChangedB">orders</span><span class="ediffChangedB">_</span><span class="ediffChangedB">status</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">os</span><span class="ediffChangedB">.</span><span class="ediffChangedB">orders</span><span class="ediffChangedB">_</span><span class="ediffChangedB">status</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">and</span> <span class="ediffChangedB">os</span><span class="ediffChangedB">.</span><span class="ediffChangedB">downloads</span><span class="ediffChangedB">_</span><span class="ediffChangedB">flag</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">1</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">and</span> <span class="ediffChangedB">os</span><span class="ediffChangedB">.</span><span class="ediffChangedB">language</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span>&#034; <span class="ediffChangedB">.</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">int</span>)<span class="ediffChangedB">$</span><span class="ediffChangedB">languages</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&#034;</span><span class="ediffChangedB">)</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">26</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; if (tep_db_num_rows($downloads_query) &gt; 0) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">27</td><td class="diffLineNumbers">27</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">28</td><td class="diffLineNumbers">28</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
</table>

<h3>[C] Update the free shipping method title</h3>

<ul>
  <li>Use the free shipping language definition for the shipping title when free shipping is active.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/modules/order_total/ot_shipping.php</p>

<span class="affectedFiles">File: catalog/includes/modules/order_total/ot_shipping.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/modules/order_total/ot_shipping.php?r1=477&r2=1739">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/modules/order_total/ot_shipping.php?r1=477&r2=1739">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">39</td><td class="diffLineNumbers">39</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">40</td><td class="diffLineNumbers">40</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">41</td><td class="diffLineNumbers">41</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( ($pass == true) &amp;&amp; ( ($order-&gt;info[&#039;total&#039;] - $order-&gt;info[&#039;shipping_cost&#039;]) &gt;= MODULE_ORDER_TOTAL_SHIPPING_FREE_SHIPPING_OVER) ) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">42</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $order-&gt;info[&#039;shipping_method&#039;] = <span class="ediffChangedA">$</span><span class="ediffChangedA">this</span><span class="ediffChangedA">-</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">title</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">42</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $order-&gt;info[&#039;shipping_method&#039;] = <span class="ediffChangedB">FREE</span><span class="ediffChangedB">_</span><span class="ediffChangedB">SHIPPING</span><span class="ediffChangedB">_</span><span class="ediffChangedB">TITLE</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">43</td><td class="diffLineNumbers">43</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $order-&gt;info[&#039;total&#039;] -= $order-&gt;info[&#039;shipping_cost&#039;];</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">44</td><td class="diffLineNumbers">44</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $order-&gt;info[&#039;shipping_cost&#039;] = 0;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">45</td><td class="diffLineNumbers">45</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
</table>

<h3>[C] Update credit card error messages</h3>

<ul>
  <li>Remove HTML formatting from credit card processing error messages.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/languages/english.php<br />
catalog/includes/languages/espanol.php<br />
catalog/includes/languages/german.php</p>

<span class="affectedFiles">File: catalog/includes/languages/english.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/languages/english.php?r1=477&r2=1743">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/languages/english.php?r1=477&r2=1743">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">310</td><td class="diffLineNumbers">310</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;WARNING_SESSION_AUTO_START&#039;, &#039;Warning: session.auto_start is enabled - please disable this php feature in php.ini and restart the web server.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">311</td><td class="diffLineNumbers">311</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;WARNING_DOWNLOAD_DIRECTORY_NON_EXISTENT&#039;, &#039;Warning: The downloadable products directory does not exist: &#039; . DIR_FS_DOWNLOAD . &#039;. Downloadable products will not work until this directory is valid.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">312</td><td class="diffLineNumbers">312</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">313</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">define(&#039;TEXT_CCVAL_ERROR_INVALID_DATE&#039;, &#039;The expiry date entered for the credit card is invalid.<span class="ediffChangedA">&lt;</span><span class="ediffChangedA">br</span><span class="ediffChangedA">&gt;</span>Please check the date and try again.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">314</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">define(&#039;TEXT_CCVAL_ERROR_INVALID_NUMBER&#039;, &#039;The credit card number entered is invalid.<span class="ediffChangedA">&lt;</span><span class="ediffChangedA">br</span><span class="ediffChangedA">&gt;</span>Please check the number and try again.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">315</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">define(&#039;TEXT_CCVAL_ERROR_UNKNOWN_CARD&#039;, &#039;The first four digits of the number entered are: %s<span class="ediffChangedA">&lt;</span><span class="ediffChangedA">br</span><span class="ediffChangedA">&gt;</span>If that number is correct, we do not accept that type of credit card.<span class="ediffChangedA">&lt;</span><span class="ediffChangedA">br</span><span class="ediffChangedA">&gt;</span>If it is wrong, please try again.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">313</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">define(&#039;TEXT_CCVAL_ERROR_INVALID_DATE&#039;, &#039;The expiry date entered for the credit card is invalid. Please check the date and try again.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">314</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">define(&#039;TEXT_CCVAL_ERROR_INVALID_NUMBER&#039;, &#039;The credit card number entered is invalid. Please check the number and try again.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">315</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">define(&#039;TEXT_CCVAL_ERROR_UNKNOWN_CARD&#039;, &#039;The first four digits of the number entered are: %s<span class="ediffChangedB">.</span> If that number is correct, we do not accept that type of credit card. If it is wrong, please try again.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">316</td><td class="diffLineNumbers">316</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">317</td><td class="diffLineNumbers">317</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;FOOTER_TEXT_BODY&#039;, &#039;Copyright &amp;copy; &#039; . date(&#039;Y&#039;) . &#039; &lt;a href=&#034;&#039; . tep_href_link(FILENAME_DEFAULT) . &#039;&#034;&gt;&#039; . STORE_NAME . &#039;&lt;/a&gt;&lt;br&gt;Powered by &lt;a href=&#034;http://www.oscommerce.com&#034; target=&#034;_blank&#034;&gt;osCommerce&lt;/a&gt;&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">318</td><td class="diffLineNumbers">318</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/languages/espanol.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/languages/espanol.php?r1=477&r2=1743">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/languages/espanol.php?r1=477&r2=1743">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">310</td><td class="diffLineNumbers">310</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;WARNING_SESSION_AUTO_START&#039;, &#039;Advertencia: session.auto_start esta activado - desactive esta caracteristica en el fichero php.ini and reinicie el servidor web.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">311</td><td class="diffLineNumbers">311</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;WARNING_DOWNLOAD_DIRECTORY_NON_EXISTENT&#039;, &#039;Advertencia: El directorio para productos descargables no existe: &#039; . DIR_FS_DOWNLOAD . &#039;. Los productos descargables no funcionar&amp;aacute;n hasta que no se corriga este error.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">312</td><td class="diffLineNumbers">312</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">313</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">define(&#039;TEXT_CCVAL_ERROR_INVALID_DATE&#039;, &#039;La fecha de caducidad de la tarjeta de cr&amp;eacute;dito es incorrecta.<span class="ediffChangedA">&lt;</span><span class="ediffChangedA">br</span><span class="ediffChangedA">&gt;</span>Compruebe la fecha e int&amp;eacute;ntelo de nuevo.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">314</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">define(&#039;TEXT_CCVAL_ERROR_INVALID_NUMBER&#039;, &#039;El n&amp;uacute;mero de la tarjeta de cr&amp;eacute;dito es incorrecto.<span class="ediffChangedA">&lt;</span><span class="ediffChangedA">br</span><span class="ediffChangedA">&gt;</span>Compruebe el numero e int&amp;eacute;ntelo de nuevo.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">315</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">define(&#039;TEXT_CCVAL_ERROR_UNKNOWN_CARD&#039;, &#039;Los primeros cuatro digitos de su tarjeta son: %s<span class="ediffChangedA">&lt;</span><span class="ediffChangedA">br</span><span class="ediffChangedA">&gt;</span>Si este n&amp;uacute;mero es correcto, no aceptamos este tipo de tarjetas.<span class="ediffChangedA">&lt;</span><span class="ediffChangedA">br</span><span class="ediffChangedA">&gt;</span>Si es incorrecto, int&amp;eacute;ntelo de nuevo.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">313</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">define(&#039;TEXT_CCVAL_ERROR_INVALID_DATE&#039;, &#039;La fecha de caducidad de la tarjeta de cr&amp;eacute;dito es incorrecta. Compruebe la fecha e int&amp;eacute;ntelo de nuevo.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">314</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">define(&#039;TEXT_CCVAL_ERROR_INVALID_NUMBER&#039;, &#039;El n&amp;uacute;mero de la tarjeta de cr&amp;eacute;dito es incorrecto. Compruebe el numero e int&amp;eacute;ntelo de nuevo.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">315</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">define(&#039;TEXT_CCVAL_ERROR_UNKNOWN_CARD&#039;, &#039;Los primeros cuatro digitos de su tarjeta son: %s<span class="ediffChangedB">.</span> Si este n&amp;uacute;mero es correcto, no aceptamos este tipo de tarjetas. Si es incorrecto, int&amp;eacute;ntelo de nuevo.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">316</td><td class="diffLineNumbers">316</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">317</td><td class="diffLineNumbers">317</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;FOOTER_TEXT_BODY&#039;, &#039;Copyright &amp;copy; &#039; . date(&#039;Y&#039;) . &#039; &lt;a href=&#034;&#039; . tep_href_link(FILENAME_DEFAULT) . &#039;&#034;&gt;&#039; . STORE_NAME . &#039;&lt;/a&gt;&lt;br&gt;Powered by &lt;a href=&#034;http://www.oscommerce.com&#034; target=&#034;_blank&#034;&gt;osCommerce&lt;/a&gt;&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">318</td><td class="diffLineNumbers">318</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/languages/german.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/languages/german.php?r1=477&r2=1743">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/languages/german.php?r1=477&r2=1743">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">310</td><td class="diffLineNumbers">310</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;WARNING_SESSION_AUTO_START&#039;, &#039;Warnung: session.auto_start ist enabled - Bitte disablen Sie dieses PHP Feature in der php.ini und starten Sie den WEB-Server neu!&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">311</td><td class="diffLineNumbers">311</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;WARNING_DOWNLOAD_DIRECTORY_NON_EXISTENT&#039;, &#039;Warnung: Das Verzeichnis f&uuml;r den Artikel Download existiert nicht: &#039; . DIR_FS_DOWNLOAD . &#039;. Diese Funktion wird nicht funktionieren bis das Verzeichnis erstellt wurde!&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">312</td><td class="diffLineNumbers">312</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">313</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">define(&#039;TEXT_CCVAL_ERROR_INVALID_DATE&#039;, &#039;Das &#034;G&amp;uuml;ltig bis&#034; Datum ist ung&amp;uuml;ltig.<span class="ediffChangedA">&lt;</span><span class="ediffChangedA">br</span><span class="ediffChangedA">&gt;</span>Bitte korrigieren Sie Ihre Angaben.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">314</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">define(&#039;TEXT_CCVAL_ERROR_INVALID_NUMBER&#039;, &#039;Die &#034;KreditkarteNummer&#034;, die Sie angegeben haben, ist ung&amp;uuml;ltig.<span class="ediffChangedA">&lt;</span><span class="ediffChangedA">br</span><span class="ediffChangedA">&gt;</span>Bitte korrigieren Sie Ihre Angaben.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">315</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">define(&#039;TEXT_CCVAL_ERROR_UNKNOWN_CARD&#039;, &#039;Die ersten 4 Ziffern Ihrer Kreditkarte sind: %s<span class="ediffChangedA">&lt;</span><span class="ediffChangedA">br</span><span class="ediffChangedA">&gt;</span>Wenn diese Angaben stimmen, wird dieser Kartentyp leider nicht akzeptiert.<span class="ediffChangedA">&lt;</span><span class="ediffChangedA">br</span><span class="ediffChangedA">&gt;</span>Bitte korrigieren Sie Ihre Angaben gegebenfalls.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">313</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">define(&#039;TEXT_CCVAL_ERROR_INVALID_DATE&#039;, &#039;Das &#034;G&amp;uuml;ltig bis&#034; Datum ist ung&amp;uuml;ltig. Bitte korrigieren Sie Ihre Angaben.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">314</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">define(&#039;TEXT_CCVAL_ERROR_INVALID_NUMBER&#039;, &#039;Die &#034;KreditkarteNummer&#034;, die Sie angegeben haben, ist ung&amp;uuml;ltig. Bitte korrigieren Sie Ihre Angaben.&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">315</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">define(&#039;TEXT_CCVAL_ERROR_UNKNOWN_CARD&#039;, &#039;Die ersten 4 Ziffern Ihrer Kreditkarte sind: %s<span class="ediffChangedB">.</span> Wenn diese Angaben stimmen, wird dieser Kartentyp leider nicht akzeptiert. Bitte korrigieren Sie Ihre Angaben gegebenfalls.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">316</td><td class="diffLineNumbers">316</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">317</td><td class="diffLineNumbers">317</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;FOOTER_TEXT_BODY&#039;, &#039;Copyright &amp;copy; &#039; . date(&#039;Y&#039;) . &#039; &lt;a href=&#034;&#039; . tep_href_link(FILENAME_DEFAULT) . &#039;&#034;&gt;&#039; . STORE_NAME . &#039;&lt;/a&gt;&lt;br&gt;Powered by &lt;a href=&#034;http://www.oscommerce.com&#034; target=&#034;_blank&#034;&gt;osCommerce&lt;/a&gt;&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">318</td><td class="diffLineNumbers">318</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
</table>

<h3>[A] Update File Manager</h3>

<ul>
  <li>Add checks when creating files and directories in the Administration Tool -> File Manager section.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/file_manager.php<br />
catalog/admin/includes/languages/english/file_manager.php<br />
catalog/admin/includes/languages/espanol/file_manager.php<br />
catalog/admin/includes/languages/german/file_manager.php</p>

<span class="affectedFiles">File: catalog/admin/file_manager.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/file_manager.php?r1=1652&r2=1744">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/file_manager.php?r1=1652&r2=1744">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">43</td><td class="diffLineNumbers">43</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!$tep_remove_error) tep_redirect(tep_href_link(FILENAME_FILE_MANAGER));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">44</td><td class="diffLineNumbers">44</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">45</td><td class="diffLineNumbers">45</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case &#039;insert&#039;:</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">46</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (mkdir($current_path . &#039;/&#039; . $HTTP_POST_VARS[&#039;folder_name&#039;], 0777)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">46</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (<span class="ediffChangedB">isset</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">HTTP</span><span class="ediffChangedB">_</span><span class="ediffChangedB">POST</span><span class="ediffChangedB">_</span><span class="ediffChangedB">VARS</span><span class="ediffChangedB">[</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">folder</span><span class="ediffChangedB">_</span><span class="ediffChangedB">name</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">]</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&amp;</span> <span class="ediffChangedB">tep</span><span class="ediffChangedB">_</span><span class="ediffChangedB">not</span><span class="ediffChangedB">_</span><span class="ediffChangedB">null</span><span class="ediffChangedB">(</span><span class="ediffChangedB">basename</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">HTTP</span><span class="ediffChangedB">_</span><span class="ediffChangedB">POST</span><span class="ediffChangedB">_</span><span class="ediffChangedB">VARS</span><span class="ediffChangedB">[</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">folder</span><span class="ediffChangedB">_</span><span class="ediffChangedB">name</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">]</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&amp;</span> mkdir($current_path . &#039;/&#039; . <span class="ediffChangedB">basename</span><span class="ediffChangedB">(</span>$HTTP_POST_VARS[&#039;folder_name&#039;]<span class="ediffChangedB">)</span>, 0777)) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">47</td><td class="diffLineNumbers">47</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_FILE_MANAGER, &#039;info=&#039; . urlencode($HTTP_POST_VARS[&#039;folder_name&#039;])));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">48</td><td class="diffLineNumbers">48</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">49</td><td class="diffLineNumbers">49</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">50</td><td class="diffLineNumbers">50</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case &#039;save&#039;:</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">51</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($fp = fopen($current_path . &#039;/&#039; . $HTTP_POST_VARS[&#039;filename&#039;], &#039;w+&#039;)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">52</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fputs($fp, stripslashes($HTTP_POST_VARS[&#039;file_contents&#039;]));</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">53</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fclose($fp);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">54</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_FILE_MANAGER, &#039;info=&#039; . urlencode($HTTP_POST_VARS[&#039;filename&#039;])));</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">51</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (<span class="ediffChangedB">isset</span><span class="ediffChangedB">(</span>$<span class="ediffChangedB">HTTP</span><span class="ediffChangedB">_</span><span class="ediffChangedB">POST</span><span class="ediffChangedB">_</span><span class="ediffChangedB">VARS</span><span class="ediffChangedB">[</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">filename</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">]</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&amp;</span> <span class="ediffChangedB">tep</span><span class="ediffChangedB">_</span><span class="ediffChangedB">not</span><span class="ediffChangedB">_</span><span class="ediffChangedB">null</span><span class="ediffChangedB">(</span><span class="ediffChangedB">basename</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">HTTP</span><span class="ediffChangedB">_</span><span class="ediffChangedB">POST</span><span class="ediffChangedB">_</span><span class="ediffChangedB">VARS</span><span class="ediffChangedB">[</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">filename</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">]</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">{</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">52</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">if</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">is</span><span class="ediffChangedB">_</span><span class="ediffChangedB">writeable</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">current</span><span class="ediffChangedB">_</span><span class="ediffChangedB">path</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&amp;</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">$</span>fp = fopen($current_path . &#039;/&#039; . <span class="ediffChangedB">basename</span><span class="ediffChangedB">(</span>$HTTP_POST_VARS[&#039;filename&#039;]<span class="ediffChangedB">)</span>, &#039;w+&#039;))<span class="ediffChangedB">)</span> {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">53</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fputs($fp, stripslashes($HTTP_POST_VARS[&#039;file_contents&#039;]));</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">54</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fclose($fp);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">55</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_FILE_MANAGER, &#039;info=&#039; . urlencode(<span class="ediffChangedB">basename</span><span class="ediffChangedB">(</span>$HTTP_POST_VARS[&#039;filename&#039;])))<span class="ediffChangedB">)</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">56</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">}</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">57</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">}</span> <span class="ediffChangedB">else</span> <span class="ediffChangedB">{</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">58</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">$</span><span class="ediffChangedB">action</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">new</span><span class="ediffChangedB">_</span><span class="ediffChangedB">file</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">59</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">$</span><span class="ediffChangedB">directory</span><span class="ediffChangedB">_</span><span class="ediffChangedB">writeable</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">true</span><span class="ediffChangedB">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">60</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">$</span><span class="ediffChangedB">messageStack</span><span class="ediffChangedB">-</span><span class="ediffChangedB">&gt;</span><span class="ediffChangedB">add</span><span class="ediffChangedB">(</span><span class="ediffChangedB">ERROR</span><span class="ediffChangedB">_</span><span class="ediffChangedB">FILENAME</span><span class="ediffChangedB">_</span><span class="ediffChangedB">EMPTY</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">error</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">)</span><span class="ediffChangedB">;</span></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">55</td><td class="diffLineNumbers">61</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">56</td><td class="diffLineNumbers">62</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">57</td><td class="diffLineNumbers">63</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case &#039;processuploads&#039;:</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/languages/english/file_manager.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/english/file_manager.php?r1=477&r2=1744">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/english/file_manager.php?r1=477&r2=1744">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">35</td><td class="diffLineNumbers">35</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_DIRECTORY_NOT_REMOVEABLE&#039;, &#039;Error: I can not remove this directory. Please set the right user permissions on: %s&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">36</td><td class="diffLineNumbers">36</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_FILE_NOT_REMOVEABLE&#039;, &#039;Error: I can not remove this file. Please set the right user permissions on: %s&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">37</td><td class="diffLineNumbers">37</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_DIRECTORY_DOES_NOT_EXIST&#039;, &#039;Error: Directory does not exist: %s&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">38</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;ERROR_FILENAME_EMPTY&#039;, &#039;Error: Please enter a filename to store the contents in.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">38</td><td class="diffLineNumbers">39</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/languages/espanol/file_manager.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/espanol/file_manager.php?r1=477&r2=1744">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/espanol/file_manager.php?r1=477&r2=1744">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">35</td><td class="diffLineNumbers">35</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_DIRECTORY_NOT_REMOVEABLE&#039;, &#039;Error: No puedo eliminar el directorio. Asigne los permisos adecuados a: %s&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">36</td><td class="diffLineNumbers">36</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_FILE_NOT_REMOVEABLE&#039;, &#039;Error: No puedo eliminar este fichero. Asigne los permisos adecuados a: %s&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">37</td><td class="diffLineNumbers">37</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_DIRECTORY_DOES_NOT_EXIST&#039;, &#039;Error: No existe el directorio: %s&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">38</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;ERROR_FILENAME_EMPTY&#039;, &#039;Error: Please enter a filename to store the contents in.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">38</td><td class="diffLineNumbers">39</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/languages/german/file_manager.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/german/file_manager.php?r1=477&r2=1817">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/german/file_manager.php?r1=477&r2=1817">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">35</td><td class="diffLineNumbers">35</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_DIRECTORY_NOT_REMOVEABLE&#039;, &#039;Fehler: Das Verzeichnis kann nicht gel&amp;ouml;scht werden. Bitte korrigieren Sie die Zugriffsrechte f&amp;uuml;r: %s !&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">36</td><td class="diffLineNumbers">36</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_FILE_NOT_REMOVEABLE&#039;, &#039;Fehler: Die Datei kann nicht gel&amp;ouml;scht werden. Bitte korrigieren Sie die Zugriffsrechte f&amp;uuml;r: %s !&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">37</td><td class="diffLineNumbers">37</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;ERROR_DIRECTORY_DOES_NOT_EXIST&#039;, &#039;Fehler: Das Verzeichnis %s existiert nicht!&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">38</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;ERROR_FILENAME_EMPTY&#039;, &#039;Fehler: Bitte geben Sie einen Dateinamen an.&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">38</td><td class="diffLineNumbers">39</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
</table>

<h3>[A] Update the table block class</h3>

<ul>
  <li>Fix logic with nested tables in the Administration Tool tableBlock class.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/includes/classes/table_block.php</p>

<span class="affectedFiles">File: catalog/admin/includes/classes/table_block.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/classes/table_block.php?r1=1739&r2=1745">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/classes/table_block.php?r1=1739&r2=1745">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">41</td><td class="diffLineNumbers">41</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">42</td><td class="diffLineNumbers">42</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($contents[$i][0]) &amp;&amp; is_array($contents[$i][0])) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">43</td><td class="diffLineNumbers">43</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($x=0, $y=sizeof($contents[$i]); $x&lt;$y; $x++) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">44</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($contents[$i][$x][&#039;text&#039;]) &amp;&amp; tep_not_null(<span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span>$contents[$i][$x][&#039;text&#039;]))<span class="ediffChangedA">)</span> {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">44</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($contents[$i][$x][&#039;text&#039;]) &amp;&amp; tep_not_null($contents[$i][$x][&#039;text&#039;])) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">45</td><td class="diffLineNumbers">45</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tableBox_string .= &#039;&nbsp;&nbsp;&nbsp; &lt;td&#039;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">46</td><td class="diffLineNumbers">46</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($contents[$i][$x][&#039;align&#039;]) &amp;&amp; tep_not_null($contents[$i][$x][&#039;align&#039;])) $tableBox_string .= &#039; align=&#034;&#039; . $contents[$i][$x][&#039;align&#039;] . &#039;&#034;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">47</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($contents[$i][$x][&#039;params&#039;]) &amp;&amp; tep_not_null(<span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span>$contents[$i][$x][&#039;params&#039;]))<span class="ediffChangedA">)</span> {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">47</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($contents[$i][$x][&#039;params&#039;]) &amp;&amp; tep_not_null($contents[$i][$x][&#039;params&#039;])) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">48</td><td class="diffLineNumbers">48</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tableBox_string .= &#039; &#039; . $contents[$i][$x][&#039;params&#039;];</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">49</td><td class="diffLineNumbers">49</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } elseif (tep_not_null($this-&gt;table_data_parameters)) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">50</td><td class="diffLineNumbers">50</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tableBox_string .= &#039; &#039; . $this-&gt;table_data_parameters;</td>
        </tr>
</table>

<h3>[A] MySQL 5.0 Strict Mode compatibility updates</h3>
</ul>

<ul>
  <li>MySQL 5.0 Strict Mode compatibility updates.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/backup.php<br />
catalog/admin/categories.php<br />
catalog/admin/languages.php<br />
catalog/admin/products_attributes.php</p>

<span class="affectedFiles">File: catalog/admin/backup.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/backup.php?r1=1610&r2=1755">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/backup.php?r1=1610&r2=1755">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">260</td><td class="diffLineNumbers">260</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&#034;delete from &#034; . TABLE_SESSIONS);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">261</td><td class="diffLineNumbers">261</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">262</td><td class="diffLineNumbers">262</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&#034;delete from &#034; . TABLE_CONFIGURATION . &#034; where configuration_key = &#039;DB_LAST_RESTORE&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">263</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&#034;insert into &#034; . TABLE_CONFIGURATION . &#034; values (<span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span>, &#039;Last Database Restore&#039;, &#039;DB_LAST_RESTORE&#039;, &#039;&#034; . $read_from . &#034;&#039;, &#039;Last database restore file&#039;, &#039;6&#039;, &#039;&#039;, <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span>, now(), &#039;&#039;, &#039;&#039;)&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">263</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&#034;insert into &#034; . TABLE_CONFIGURATION . &#034; values (<span class="ediffChangedB">null</span>, &#039;Last Database Restore&#039;, &#039;DB_LAST_RESTORE&#039;, &#039;&#034; . $read_from . &#034;&#039;, &#039;Last database restore file&#039;, &#039;6&#039;, &#039;<span class="ediffChangedB">0</span>&#039;, <span class="ediffChangedB">null</span>, now(), &#039;&#039;, &#039;&#039;)&#034;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">264</td><td class="diffLineNumbers">264</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">265</td><td class="diffLineNumbers">265</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($remove_raw) &amp;&amp; ($remove_raw == true)) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">266</td><td class="diffLineNumbers">266</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unlink($restore_from);</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/categories.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/categories.php?r1=1754&r2=1755">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/categories.php?r1=1754&r2=1755">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">38</td><td class="diffLineNumbers">38</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($HTTP_POST_VARS[&#039;categories_id&#039;])) $categories_id = tep_db_prepare_input($HTTP_POST_VARS[&#039;categories_id&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">39</td><td class="diffLineNumbers">39</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sort_order = tep_db_prepare_input($HTTP_POST_VARS[&#039;sort_order&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">40</td><td class="diffLineNumbers">40</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">41</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_data_array = array(&#039;sort_order&#039; =&gt; $sort_order);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">41</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_data_array = array(&#039;sort_order&#039; =&gt; <span class="ediffChangedB">(</span><span class="ediffChangedB">int</span><span class="ediffChangedB">)</span>$sort_order);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">42</td><td class="diffLineNumbers">42</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">43</td><td class="diffLineNumbers">43</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($action == &#039;insert_category&#039;) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">44</td><td class="diffLineNumbers">44</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $insert_sql_data = array(&#039;parent_id&#039; =&gt; $current_category_id,</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">215</td><td class="diffLineNumbers">215</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">216</td><td class="diffLineNumbers">216</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_date_available = (date(&#039;Y-m-d&#039;) &lt; $products_date_available) ? $products_date_available : &#039;null&#039;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">217</td><td class="diffLineNumbers">217</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">218</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_data_array = array(&#039;products_quantity&#039; =&gt; tep_db_prepare_input($HTTP_POST_VARS[&#039;products_quantity&#039;]),</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">218</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_data_array = array(&#039;products_quantity&#039; =&gt; <span class="ediffChangedB">(</span><span class="ediffChangedB">int</span><span class="ediffChangedB">)</span>tep_db_prepare_input($HTTP_POST_VARS[&#039;products_quantity&#039;]),</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">219</td><td class="diffLineNumbers">219</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;products_model&#039; =&gt; tep_db_prepare_input($HTTP_POST_VARS[&#039;products_model&#039;]),</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">220</td><td class="diffLineNumbers">220</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;products_price&#039; =&gt; tep_db_prepare_input($HTTP_POST_VARS[&#039;products_price&#039;]),</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">221</td><td class="diffLineNumbers">221</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;products_date_available&#039; =&gt; $products_date_available,</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">222</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;products_weight&#039; =&gt; tep_db_prepare_input($HTTP_POST_VARS[&#039;products_weight&#039;]),</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">222</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;products_weight&#039; =&gt; <span class="ediffChangedB">(</span><span class="ediffChangedB">float</span><span class="ediffChangedB">)</span>tep_db_prepare_input($HTTP_POST_VARS[&#039;products_weight&#039;]),</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">223</td><td class="diffLineNumbers">223</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;products_status&#039; =&gt; tep_db_prepare_input($HTTP_POST_VARS[&#039;products_status&#039;]),</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">224</td><td class="diffLineNumbers">224</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;products_tax_class_id&#039; =&gt; tep_db_prepare_input($HTTP_POST_VARS[&#039;products_tax_class_id&#039;]),</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">225</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;manufacturers_id&#039; =&gt; tep_db_prepare_input($HTTP_POST_VARS[&#039;manufacturers_id&#039;]));</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">225</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;manufacturers_id&#039; =&gt; <span class="ediffChangedB">(</span><span class="ediffChangedB">int</span><span class="ediffChangedB">)</span>tep_db_prepare_input($HTTP_POST_VARS[&#039;manufacturers_id&#039;]));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">226</td><td class="diffLineNumbers">226</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">227</td><td class="diffLineNumbers">227</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($HTTP_POST_VARS[&#039;products_image&#039;]) &amp;&amp; tep_not_null($HTTP_POST_VARS[&#039;products_image&#039;]) &amp;&amp; ($HTTP_POST_VARS[&#039;products_image&#039;] != &#039;none&#039;)) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">228</td><td class="diffLineNumbers">228</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_data_array[&#039;products_image&#039;] = tep_db_prepare_input($HTTP_POST_VARS[&#039;products_image&#039;]);</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/languages.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/languages.php?r1=477&r2=1755">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/languages.php?r1=477&r2=1755">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">18</td><td class="diffLineNumbers">18</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; switch ($action) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">19</td><td class="diffLineNumbers">19</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case &#039;insert&#039;:</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">20</td><td class="diffLineNumbers">20</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $name = tep_db_prepare_input($HTTP_POST_VARS[&#039;name&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">21</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $code = tep_db_prepare_input($HTTP_POST_VARS[&#039;code&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">21</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $code = tep_db_prepare_input(<span class="ediffChangedB">substr</span><span class="ediffChangedB">(</span>$HTTP_POST_VARS[&#039;code&#039;]<span class="ediffChangedB">,</span> <span class="ediffChangedB">0</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">2</span>)<span class="ediffChangedB">)</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">22</td><td class="diffLineNumbers">22</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $image = tep_db_prepare_input($HTTP_POST_VARS[&#039;image&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">23</td><td class="diffLineNumbers">23</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $directory = tep_db_prepare_input($HTTP_POST_VARS[&#039;directory&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">24</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sort_order = tep_db_prepare_input($HTTP_POST_VARS[&#039;sort_order&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">24</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sort_order = <span class="ediffChangedB">(</span><span class="ediffChangedB">int</span><span class="ediffChangedB">)</span>tep_db_prepare_input($HTTP_POST_VARS[&#039;sort_order&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">25</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">26</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&#034;insert into &#034; . TABLE_LANGUAGES . &#034; (name, code, image, directory, sort_order) values (&#039;&#034; . tep_db_input($name) . &#034;&#039;, &#039;&#034; . tep_db_input($code) . &#034;&#039;, &#039;&#034; . tep_db_input($image) . &#034;&#039;, &#039;&#034; . tep_db_input($directory) . &#034;&#039;, &#039;&#034; . tep_db_input($sort_order) . &#034;&#039;)&#034;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">27</td><td class="diffLineNumbers">27</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $insert_id = tep_db_insert_id();</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">71</td><td class="diffLineNumbers">71</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case &#039;save&#039;:</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">72</td><td class="diffLineNumbers">72</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $lID = tep_db_prepare_input($HTTP_GET_VARS[&#039;lID&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">73</td><td class="diffLineNumbers">73</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $name = tep_db_prepare_input($HTTP_POST_VARS[&#039;name&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">74</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $code = tep_db_prepare_input($HTTP_POST_VARS[&#039;code&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">74</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $code = tep_db_prepare_input(<span class="ediffChangedB">substr</span><span class="ediffChangedB">(</span>$HTTP_POST_VARS[&#039;code&#039;]<span class="ediffChangedB">,</span> <span class="ediffChangedB">0</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">2</span>)<span class="ediffChangedB">)</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">75</td><td class="diffLineNumbers">75</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $image = tep_db_prepare_input($HTTP_POST_VARS[&#039;image&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">76</td><td class="diffLineNumbers">76</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $directory = tep_db_prepare_input($HTTP_POST_VARS[&#039;directory&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">77</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sort_order = tep_db_prepare_input($HTTP_POST_VARS[&#039;sort_order&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">77</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sort_order = <span class="ediffChangedB">(</span><span class="ediffChangedB">int</span><span class="ediffChangedB">)</span>tep_db_prepare_input($HTTP_POST_VARS[&#039;sort_order&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">78</td><td class="diffLineNumbers">78</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">79</td><td class="diffLineNumbers">79</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&#034;update &#034; . TABLE_LANGUAGES . &#034; set name = &#039;&#034; . tep_db_input($name) . &#034;&#039;, code = &#039;&#034; . tep_db_input($code) . &#034;&#039;, image = &#039;&#034; . tep_db_input($image) . &#034;&#039;, directory = &#039;&#034; . tep_db_input($directory) . &#034;&#039;, sort_order = &#039;&#034; . tep_db_input($sort_order) . &#034;&#039; where languages_id = &#039;&#034; . (int)$lID . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">80</td><td class="diffLineNumbers">80</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/products_attributes.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/products_attributes.php?r1=477&r2=1746">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/products_attributes.php?r1=477&r2=1746">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">58</td><td class="diffLineNumbers">58</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $value_price = tep_db_prepare_input($HTTP_POST_VARS[&#039;value_price&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">59</td><td class="diffLineNumbers">59</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $price_prefix = tep_db_prepare_input($HTTP_POST_VARS[&#039;price_prefix&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">60</td><td class="diffLineNumbers">60</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">61</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&#034;insert into &#034; . TABLE_PRODUCTS_ATTRIBUTES . &#034; values (<span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span>, &#039;&#034; . (int)$products_id . &#034;&#039;, &#039;&#034; . (int)$options_id . &#034;&#039;, &#039;&#034; . (int)$values_id . &#034;&#039;, &#039;&#034; . tep_db_input($value_price) . &#034;&#039;, &#039;&#034; . tep_db_input($price_prefix) . &#034;&#039;)&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">61</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&#034;insert into &#034; . TABLE_PRODUCTS_ATTRIBUTES . &#034; values (<span class="ediffChangedB">null</span>, &#039;&#034; . (int)$products_id . &#034;&#039;, &#039;&#034; . (int)$options_id . &#034;&#039;, &#039;&#034; . (int)$values_id . &#034;&#039;, &#039;&#034; . tep_db_input($value_price) . &#034;&#039;, &#039;&#034; . tep_db_input($price_prefix) . &#034;&#039;)&#034;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">62</td><td class="diffLineNumbers">62</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">63</td><td class="diffLineNumbers">63</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (DOWNLOAD_ENABLED == &#039;true&#039;) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">64</td><td class="diffLineNumbers">64</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_attributes_id = tep_db_insert_id();</td>
        </tr>
</table>

<h3>[A] Update http_build_query() compatibility function</h3>

<ul>
  <li>Fix http_build_query() compatibility function in the Administration Tool.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/includes/functions/compatibility.php</p>

<span class="affectedFiles">File: catalog/admin/includes/functions/compatibility.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/functions/compatibility.php?r1=1610&r2=1748">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/functions/compatibility.php?r1=1610&r2=1748">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">186</td><td class="diffLineNumbers">186</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $arg_separator = ini_get(&#039;arg_separator.output&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">187</td><td class="diffLineNumbers">187</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">188</td><td class="diffLineNumbers">188</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( empty($arg_separator) ) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">189</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $separator = &#039;&amp;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">189</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $<span class="ediffChangedB">arg</span><span class="ediffChangedB">_</span>separator = &#039;&amp;&#039;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">190</td><td class="diffLineNumbers">190</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">191</td><td class="diffLineNumbers">191</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">192</td><td class="diffLineNumbers">192</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">217</td><td class="diffLineNumbers">217</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return null;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">218</td><td class="diffLineNumbers">218</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">219</td><td class="diffLineNumbers">219</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">220</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return implode($separator, $tmp);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">220</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return implode($<span class="ediffChangedB">arg</span><span class="ediffChangedB">_</span>separator, $tmp);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">221</td><td class="diffLineNumbers">221</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">222</td><td class="diffLineNumbers">222</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">223</td><td class="diffLineNumbers">223</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">// Helper function</td>
        </tr>
</table>

<h3>[A] Update Newsletter Manager</h3>

<ul>
  <li>Fix variable name being checked against.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/newsletters.php</p>

<span class="affectedFiles">File: catalog/admin/newsletters.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/newsletters.php?r1=477&r2=1751">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/newsletters.php?r1=477&r2=1751">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">38</td><td class="diffLineNumbers">38</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $newsletter_error = true;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">39</td><td class="diffLineNumbers">39</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">40</td><td class="diffLineNumbers">40</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">41</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (empty($module)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">41</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (empty($<span class="ediffChangedB">newsletter</span><span class="ediffChangedB">_</span>module)) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">42</td><td class="diffLineNumbers">42</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $messageStack-&gt;add(ERROR_NEWSLETTER_MODULE, &#039;error&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">43</td><td class="diffLineNumbers">43</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $newsletter_error = true;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">44</td><td class="diffLineNumbers">44</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
</table>

<h3>[AC] Update database session storage handler</h3>

<ul>
  <li>Return an empty string value instead of a boolean value (required by custom session handlers for the read function).</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/includes/functions/sessions.php<br />
catalog/includes/functions/sessions.php</p>

<span class="affectedFiles">File: catalog/admin/includes/functions/sessions.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/functions/sessions.php?r1=1741&r2=1752">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/functions/sessions.php?r1=1741&r2=1752">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">36</td><td class="diffLineNumbers">36</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $value[&#039;value&#039;];</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">37</td><td class="diffLineNumbers">37</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">38</td><td class="diffLineNumbers">38</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">39</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <span class="ediffChangedA">false</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">39</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&#039;</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">40</td><td class="diffLineNumbers">40</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">41</td><td class="diffLineNumbers">41</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">42</td><td class="diffLineNumbers">42</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; function _sess_write($key, $val) {</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/includes/functions/sessions.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/functions/sessions.php?r1=1741&r2=1752">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/functions/sessions.php?r1=1741&r2=1752">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">36</td><td class="diffLineNumbers">36</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $value[&#039;value&#039;];</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">37</td><td class="diffLineNumbers">37</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">38</td><td class="diffLineNumbers">38</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">39</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <span class="ediffChangedA">false</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">39</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&#039;</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">40</td><td class="diffLineNumbers">40</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">41</td><td class="diffLineNumbers">41</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">42</td><td class="diffLineNumbers">42</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; function _sess_write($key, $val) {</td>
        </tr>
</table>

<h3>[A] Update administration of categories</h3>

<ul>
  <li>Fix the cPath value for category entries in search result listings.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/categories.php</p>

<span class="affectedFiles">File: catalog/admin/categories.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/categories.php?r1=1607&r2=1754">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/categories.php?r1=1607&r2=1754">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">971</td><td class="diffLineNumbers">971</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default:</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">972</td><td class="diffLineNumbers">972</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($rows &gt; 0) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">973</td><td class="diffLineNumbers">973</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($cInfo) &amp;&amp; is_object($cInfo)) { // category info box contents</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">974</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $category_path_string = &#039;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">975</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $category_path = tep_generate_category_path($cInfo-&gt;categories_id);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">976</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($i=(sizeof($category_path[0])-1); $i&gt;0; $i--) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">977</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $category_path_string .= $category_path[0][$i][&#039;id&#039;] . &#039;_&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">978</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">979</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $category_path_string = substr($category_path_string, 0, -1);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">980</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">974</td><td class="diffLineNumbers">981</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $heading[] = array(&#039;text&#039; =&gt; &#039;&lt;b&gt;&#039; . $cInfo-&gt;categories_name . &#039;&lt;/b&gt;&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">975</td><td class="diffLineNumbers">982</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">976</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;align&#039; =&gt; &#039;center&#039;, &#039;text&#039; =&gt; &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_CATEGORIES, &#039;cPath=&#039; . $<span class="ediffChangedA">cPath</span> . &#039;&amp;cID=&#039; . $cInfo-&gt;categories_id . &#039;&amp;action=edit_category&#039;) . &#039;&#034;&gt;&#039; . tep_image_button(&#039;button_edit.gif&#039;, IMAGE_EDIT) . &#039;&lt;/a&gt; &lt;a href=&#034;&#039; . tep_href_link(FILENAME_CATEGORIES, &#039;cPath=&#039; . $<span class="ediffChangedA">cPath</span> . &#039;&amp;cID=&#039; . $cInfo-&gt;categories_id . &#039;&amp;action=delete_category&#039;) . &#039;&#034;&gt;&#039; . tep_image_button(&#039;button_delete.gif&#039;, IMAGE_DELETE) . &#039;&lt;/a&gt; &lt;a href=&#034;&#039; . tep_href_link(FILENAME_CATEGORIES, &#039;cPath=&#039; . $<span class="ediffChangedA">cPath</span> . &#039;&amp;cID=&#039; . $cInfo-&gt;categories_id . &#039;&amp;action=move_category&#039;) . &#039;&#034;&gt;&#039; . tep_image_button(&#039;button_move.gif&#039;, IMAGE_MOVE) . &#039;&lt;/a&gt;&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">983</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;align&#039; =&gt; &#039;center&#039;, &#039;text&#039; =&gt; &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_CATEGORIES, &#039;cPath=&#039; . $<span class="ediffChangedB">category</span><span class="ediffChangedB">_</span><span class="ediffChangedB">path</span><span class="ediffChangedB">_</span><span class="ediffChangedB">string</span> . &#039;&amp;cID=&#039; . $cInfo-&gt;categories_id . &#039;&amp;action=edit_category&#039;) . &#039;&#034;&gt;&#039; . tep_image_button(&#039;button_edit.gif&#039;, IMAGE_EDIT) . &#039;&lt;/a&gt; &lt;a href=&#034;&#039; . tep_href_link(FILENAME_CATEGORIES, &#039;cPath=&#039; . $<span class="ediffChangedB">category</span><span class="ediffChangedB">_</span><span class="ediffChangedB">path</span><span class="ediffChangedB">_</span><span class="ediffChangedB">string</span> . &#039;&amp;cID=&#039; . $cInfo-&gt;categories_id . &#039;&amp;action=delete_category&#039;) . &#039;&#034;&gt;&#039; . tep_image_button(&#039;button_delete.gif&#039;, IMAGE_DELETE) . &#039;&lt;/a&gt; &lt;a href=&#034;&#039; . tep_href_link(FILENAME_CATEGORIES, &#039;cPath=&#039; . $<span class="ediffChangedB">category</span><span class="ediffChangedB">_</span><span class="ediffChangedB">path</span><span class="ediffChangedB">_</span><span class="ediffChangedB">string</span> . &#039;&amp;cID=&#039; . $cInfo-&gt;categories_id . &#039;&amp;action=move_category&#039;) . &#039;&#034;&gt;&#039; . tep_image_button(&#039;button_move.gif&#039;, IMAGE_MOVE) . &#039;&lt;/a&gt;&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">977</td><td class="diffLineNumbers">984</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . TEXT_DATE_ADDED . &#039; &#039; . tep_date_short($cInfo-&gt;date_added));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">978</td><td class="diffLineNumbers">985</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tep_not_null($cInfo-&gt;last_modified)) $contents[] = array(&#039;text&#039; =&gt; TEXT_LAST_MODIFIED . &#039; &#039; . tep_date_short($cInfo-&gt;last_modified));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">979</td><td class="diffLineNumbers">986</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . tep_info_image($cInfo-&gt;categories_image, $cInfo-&gt;categories_name, HEADING_IMAGE_WIDTH, HEADING_IMAGE_HEIGHT) . &#039;&lt;br&gt;&#039; . $cInfo-&gt;categories_image);</td>
        </tr>
</table>

<h3>[C] Update processing of Address Book entries</h3>

<ul>
  <li>Verify the customers primary address when it is being updated.</li>
  <li>Verify the number of address book entries before inserting a new one.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/address_book_process.php</p>

<span class="affectedFiles">File: catalog/address_book_process.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/address_book_process.php?r1=1598&r2=1766">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/address_book_process.php?r1=1598&r2=1766">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">142</td><td class="diffLineNumbers">142</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">143</td><td class="diffLineNumbers">143</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">144</td><td class="diffLineNumbers">144</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($HTTP_POST_VARS[&#039;action&#039;] == &#039;update&#039;) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">145</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_perform(TABLE_ADDRESS_BOOK, $sql_data_array, &#039;update&#039;, &#034;address_book_id = &#039;&#034; . (int)$HTTP_GET_VARS[&#039;edit&#039;] . &#034;&#039; and customers_id =&#039;&#034; . (int)$customer_id . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">145</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">$</span><span class="ediffChangedB">check</span><span class="ediffChangedB">_</span><span class="ediffChangedB">query</span> <span class="ediffChangedB">=</span> tep_db_<span class="ediffChangedB">query</span><span class="ediffChangedB">(</span><span class="ediffChangedB">&#034;</span><span class="ediffChangedB">select</span> <span class="ediffChangedB">address</span><span class="ediffChangedB">_</span><span class="ediffChangedB">book</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">from</span> <span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">TABLE</span><span class="ediffChangedB">_</span><span class="ediffChangedB">ADDRESS</span><span class="ediffChangedB">_</span><span class="ediffChangedB">BOOK</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">where</span> <span class="ediffChangedB">address</span><span class="ediffChangedB">_</span><span class="ediffChangedB">book</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">int</span><span class="ediffChangedB">)</span><span class="ediffChangedB">$</span><span class="ediffChangedB">HTTP</span><span class="ediffChangedB">_</span><span class="ediffChangedB">GET</span><span class="ediffChangedB">_</span><span class="ediffChangedB">VARS</span><span class="ediffChangedB">[</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">edit</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">]</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">and</span> <span class="ediffChangedB">customers</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">int</span><span class="ediffChangedB">)</span><span class="ediffChangedB">$</span><span class="ediffChangedB">customer</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">limit</span> <span class="ediffChangedB">1</span><span class="ediffChangedB">&#034;</span><span class="ediffChangedB">)</span><span class="ediffChangedB">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">146</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">if</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">tep</span><span class="ediffChangedB">_</span><span class="ediffChangedB">db</span><span class="ediffChangedB">_</span><span class="ediffChangedB">num</span><span class="ediffChangedB">_</span><span class="ediffChangedB">rows</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">check</span><span class="ediffChangedB">_</span><span class="ediffChangedB">query</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">=</span><span class="ediffChangedB">=</span> <span class="ediffChangedB">1</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">{</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">147</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">tep</span><span class="ediffChangedB">_</span><span class="ediffChangedB">db</span><span class="ediffChangedB">_</span>perform(TABLE_ADDRESS_BOOK, $sql_data_array, &#039;update&#039;, &#034;address_book_id = &#039;&#034; . (int)$HTTP_GET_VARS[&#039;edit&#039;] . &#034;&#039; and customers_id =&#039;&#034; . (int)$customer_id . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">146</td><td class="diffLineNumbers">148</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">147</td><td class="diffLineNumbers">149</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">// reregister session variables</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">148</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( (isset($HTTP_POST_VARS[&#039;primary&#039;]) &amp;&amp; ($HTTP_POST_VARS[&#039;primary&#039;] == &#039;on&#039;)) || ($HTTP_GET_VARS[&#039;edit&#039;] == $customer_default_address_id) ) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">149</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_first_name = $firstname;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">150</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_country_id = $country;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">151</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_zone_id = (($zone_id &gt; 0) ? (int)$zone_id : &#039;0&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">152</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_default_address_id = (int)$HTTP_GET_VARS[&#039;edit&#039;];</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">150</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( (isset($HTTP_POST_VARS[&#039;primary&#039;]) &amp;&amp; ($HTTP_POST_VARS[&#039;primary&#039;] == &#039;on&#039;)) || ($HTTP_GET_VARS[&#039;edit&#039;] == $customer_default_address_id) ) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">151</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_first_name = $firstname;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">152</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_country_id = $country;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">153</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_zone_id = (($zone_id &gt; 0) ? (int)$zone_id : &#039;0&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">154</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_default_address_id = (int)$HTTP_GET_VARS[&#039;edit&#039;];</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">153</td><td class="diffLineNumbers">155</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">154</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_data_array = array(&#039;customers_firstname&#039; =&gt; $firstname,</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">155</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;customers_lastname&#039; =&gt; $lastname,</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">156</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;customers_default_address_id&#039; =&gt; (int)$HTTP_GET_VARS[&#039;edit&#039;]);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">156</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_data_array = array(&#039;customers_firstname&#039; =&gt; $firstname,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">157</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;customers_lastname&#039; =&gt; $lastname,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">158</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;customers_default_address_id&#039; =&gt; (int)$HTTP_GET_VARS[&#039;edit&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">157</td><td class="diffLineNumbers">159</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">158</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ACCOUNT_GENDER == &#039;true&#039;) $sql_data_array[&#039;customers_gender&#039;] = $gender;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">160</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ACCOUNT_GENDER == &#039;true&#039;) $sql_data_array[&#039;customers_gender&#039;] = $gender;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">159</td><td class="diffLineNumbers">161</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">160</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_perform(TABLE_CUSTOMERS, $sql_data_array, &#039;update&#039;, &#034;customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">162</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_perform(TABLE_CUSTOMERS, $sql_data_array, &#039;update&#039;, &#034;customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">163</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">}</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">164</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">165</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">$</span><span class="ediffChangedB">messageStack</span><span class="ediffChangedB">-</span><span class="ediffChangedB">&gt;</span><span class="ediffChangedB">add</span><span class="ediffChangedB">_</span><span class="ediffChangedB">session</span><span class="ediffChangedB">(</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">addressbook</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">SUCCESS</span><span class="ediffChangedB">_</span><span class="ediffChangedB">ADDRESS</span><span class="ediffChangedB">_</span><span class="ediffChangedB">BOOK</span><span class="ediffChangedB">_</span><span class="ediffChangedB">ENTRY</span><span class="ediffChangedB">_</span><span class="ediffChangedB">UPDATED</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">success</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">)</span><span class="ediffChangedB">;</span></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">161</td><td class="diffLineNumbers">166</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">162</td><td class="diffLineNumbers">167</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">163</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_data_array[&#039;customers_id&#039;] = (int)$customer_id;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">164</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_perform(TABLE_ADDRESS_BOOK, $sql_data_array);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">168</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">if</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">tep</span><span class="ediffChangedB">_</span><span class="ediffChangedB">count</span><span class="ediffChangedB">_</span><span class="ediffChangedB">customer</span><span class="ediffChangedB">_</span><span class="ediffChangedB">address</span><span class="ediffChangedB">_</span><span class="ediffChangedB">book</span><span class="ediffChangedB">_</span><span class="ediffChangedB">entries</span><span class="ediffChangedB">(</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">&lt;</span> <span class="ediffChangedB">MAX</span><span class="ediffChangedB">_</span><span class="ediffChangedB">ADDRESS</span><span class="ediffChangedB">_</span><span class="ediffChangedB">BOOK</span><span class="ediffChangedB">_</span><span class="ediffChangedB">ENTRIES</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">{</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">169</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_data_array[&#039;customers_id&#039;] = (int)$customer_id;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">170</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_perform(TABLE_ADDRESS_BOOK, $sql_data_array);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">165</td><td class="diffLineNumbers">171</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">166</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $new_address_book_id = tep_db_insert_id();</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">172</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $new_address_book_id = tep_db_insert_id();</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">167</td><td class="diffLineNumbers">173</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">168</td><td class="diffLineNumbers">174</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">// reregister session variables</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">169</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($HTTP_POST_VARS[&#039;primary&#039;]) &amp;&amp; ($HTTP_POST_VARS[&#039;primary&#039;] == &#039;on&#039;)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">170</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_first_name = $firstname;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">171</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_country_id = $country;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">172</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_zone_id = (($zone_id &gt; 0) ? (int)$zone_id : &#039;0&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">173</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($HTTP_POST_VARS[&#039;primary&#039;]) &amp;&amp; ($HTTP_POST_VARS[&#039;primary&#039;] == &#039;on&#039;)) $customer_default_address_id = $new_address_book_id;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">175</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($HTTP_POST_VARS[&#039;primary&#039;]) &amp;&amp; ($HTTP_POST_VARS[&#039;primary&#039;] == &#039;on&#039;)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">176</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_first_name = $firstname;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">177</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_country_id = $country;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">178</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $customer_zone_id = (($zone_id &gt; 0) ? (int)$zone_id : &#039;0&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">179</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($HTTP_POST_VARS[&#039;primary&#039;]) &amp;&amp; ($HTTP_POST_VARS[&#039;primary&#039;] == &#039;on&#039;)) $customer_default_address_id = $new_address_book_id;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">174</td><td class="diffLineNumbers">180</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">175</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_data_array = array(&#039;customers_firstname&#039; =&gt; $firstname,</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">176</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;customers_lastname&#039; =&gt; $lastname);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">181</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_data_array = array(&#039;customers_firstname&#039; =&gt; $firstname,</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">182</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;customers_lastname&#039; =&gt; $lastname);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">177</td><td class="diffLineNumbers">183</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">178</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ACCOUNT_GENDER == &#039;true&#039;) $sql_data_array[&#039;customers_gender&#039;] = $gender;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">179</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($HTTP_POST_VARS[&#039;primary&#039;]) &amp;&amp; ($HTTP_POST_VARS[&#039;primary&#039;] == &#039;on&#039;)) $sql_data_array[&#039;customers_default_address_id&#039;] = $new_address_book_id;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">184</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ACCOUNT_GENDER == &#039;true&#039;) $sql_data_array[&#039;customers_gender&#039;] = $gender;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">185</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($HTTP_POST_VARS[&#039;primary&#039;]) &amp;&amp; ($HTTP_POST_VARS[&#039;primary&#039;] == &#039;on&#039;)) $sql_data_array[&#039;customers_default_address_id&#039;] = $new_address_book_id;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">180</td><td class="diffLineNumbers">186</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">181</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_perform(TABLE_CUSTOMERS, $sql_data_array, &#039;update&#039;, &#034;customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">187</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_perform(TABLE_CUSTOMERS, $sql_data_array, &#039;update&#039;, &#034;customers_id = &#039;&#034; . (int)$customer_id . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">188</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">189</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">$</span><span class="ediffChangedB">messageStack</span><span class="ediffChangedB">-</span><span class="ediffChangedB">&gt;</span><span class="ediffChangedB">add</span><span class="ediffChangedB">_</span><span class="ediffChangedB">session</span><span class="ediffChangedB">(</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">addressbook</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">SUCCESS</span><span class="ediffChangedB">_</span><span class="ediffChangedB">ADDRESS</span><span class="ediffChangedB">_</span><span class="ediffChangedB">BOOK</span><span class="ediffChangedB">_</span><span class="ediffChangedB">ENTRY</span><span class="ediffChangedB">_</span><span class="ediffChangedB">UPDATED</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">success</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">)</span><span class="ediffChangedB">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">190</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">}</span></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">182</td><td class="diffLineNumbers">191</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">183</td><td class="diffLineNumbers">192</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">184</td><td class="diffLineNumbers">193</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">185</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $messageStack-&gt;add_session(&#039;addressbook&#039;, SUCCESS_ADDRESS_BOOK_ENTRY_UPDATED, &#039;success&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">186</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">187</td><td class="diffLineNumbers">194</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_redirect(tep_href_link(FILENAME_ADDRESS_BOOK, &#039;&#039;, &#039;SSL&#039;));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">188</td><td class="diffLineNumbers">195</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">189</td><td class="diffLineNumbers">196</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
</table>

<h3>[A] Update administration of product attributes</h3>

<ul>
  <li>Standards updates.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/products_attributes.php</p>

<span class="affectedFiles">File: catalog/admin/products_attributes (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/products_attributes.php?r1=1746&r2=1776">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/products_attributes.php?r1=1746&r2=1776">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">15</td><td class="diffLineNumbers">15</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">16</td><td class="diffLineNumbers">16</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; $action = (isset($HTTP_GET_VARS[&#039;action&#039;]) ? $HTTP_GET_VARS[&#039;action&#039;] : &#039;&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">17</td><td class="diffLineNumbers">17</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">18</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp; <span class="ediffChangedA">if</span> <span class="ediffChangedA">(</span><span class="ediffChangedA">tep</span><span class="ediffChangedA">_</span><span class="ediffChangedA">not</span><span class="ediffChangedA">_</span><span class="ediffChangedA">null</span><span class="ediffChangedA">(</span>$<span class="ediffChangedA">action</span><span class="ediffChangedA">)</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">{</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">19</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">$</span><span class="ediffChangedA">page</span>_<span class="ediffChangedA">info</span> = <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">20</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">if</span> (isset($HTTP_GET_VARS[&#039;option_page&#039;])<span class="ediffChangedA">)</span> $<span class="ediffChangedA">page</span>_<span class="ediffChangedA">info</span> <span class="ediffChangedA">.</span><span class="ediffChangedA">=</span> &#039;option_page<span class="ediffChangedA">=</span>&#039; <span class="ediffChangedA">.</span> $HTTP_GET_VARS[&#039;option_page&#039;] <span class="ediffChangedA">.</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">&#039;</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">21</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">if</span> (isset($HTTP_GET_VARS[&#039;value_page&#039;])<span class="ediffChangedA">)</span> $<span class="ediffChangedA">page</span>_<span class="ediffChangedA">info</span> <span class="ediffChangedA">.</span><span class="ediffChangedA">=</span> &#039;value_page<span class="ediffChangedA">=</span>&#039; <span class="ediffChangedA">.</span> $HTTP_GET_VARS[&#039;value_page&#039;] <span class="ediffChangedA">.</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">&#039;</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">22</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">if</span> (isset($HTTP_GET_VARS[&#039;attribute_page&#039;])<span class="ediffChangedA">)</span> $<span class="ediffChangedA">page</span>_<span class="ediffChangedA">info</span> <span class="ediffChangedA">.</span><span class="ediffChangedA">=</span> &#039;attribute_page<span class="ediffChangedA">=</span>&#039; <span class="ediffChangedA">.</span> $HTTP_GET_VARS[&#039;attribute_page&#039;] <span class="ediffChangedA">.</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">23</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">if</span> <span class="ediffChangedA">(</span><span class="ediffChangedA">tep</span><span class="ediffChangedA">_</span><span class="ediffChangedA">not</span><span class="ediffChangedA">_</span><span class="ediffChangedA">null</span><span class="ediffChangedA">(</span><span class="ediffChangedA">$</span><span class="ediffChangedA">page</span><span class="ediffChangedA">_</span><span class="ediffChangedA">info</span><span class="ediffChangedA">)</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">{</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">24</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">$</span><span class="ediffChangedA">page</span><span class="ediffChangedA">_</span><span class="ediffChangedA">info</span> <span class="ediffChangedA">=</span> <span class="ediffChangedA">substr</span><span class="ediffChangedA">(</span><span class="ediffChangedA">$</span><span class="ediffChangedA">page</span><span class="ediffChangedA">_</span><span class="ediffChangedA">info</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">0</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">-</span>1<span class="ediffChangedA">)</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">25</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">}</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">18</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp; $<span class="ediffChangedB">option</span>_<span class="ediffChangedB">page</span> = (isset($HTTP_GET_VARS[&#039;option_page&#039;]) <span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&amp;</span> <span class="ediffChangedB">is</span><span class="ediffChangedB">_</span><span class="ediffChangedB">numeric</span><span class="ediffChangedB">(</span>$<span class="ediffChangedB">HTTP</span>_<span class="ediffChangedB">GET</span><span class="ediffChangedB">_</span><span class="ediffChangedB">VARS</span><span class="ediffChangedB">[</span>&#039;option_page&#039;<span class="ediffChangedB">]</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">?</span> $HTTP_GET_VARS[&#039;option_page&#039;] <span class="ediffChangedB">:</span> <span class="ediffChangedB">1</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">19</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp; <span class="ediffChangedB">$</span><span class="ediffChangedB">value</span><span class="ediffChangedB">_</span><span class="ediffChangedB">page</span> <span class="ediffChangedB">=</span> (isset($HTTP_GET_VARS[&#039;value_page&#039;]) <span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&amp;</span> <span class="ediffChangedB">is</span><span class="ediffChangedB">_</span><span class="ediffChangedB">numeric</span><span class="ediffChangedB">(</span>$<span class="ediffChangedB">HTTP</span>_<span class="ediffChangedB">GET</span><span class="ediffChangedB">_</span><span class="ediffChangedB">VARS</span><span class="ediffChangedB">[</span>&#039;value_page&#039;<span class="ediffChangedB">]</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">?</span> $HTTP_GET_VARS[&#039;value_page&#039;] <span class="ediffChangedB">:</span> <span class="ediffChangedB">1</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">20</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp; <span class="ediffChangedB">$</span><span class="ediffChangedB">attribute</span><span class="ediffChangedB">_</span><span class="ediffChangedB">page</span> <span class="ediffChangedB">=</span> (isset($HTTP_GET_VARS[&#039;attribute_page&#039;]) <span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&amp;</span> <span class="ediffChangedB">is</span><span class="ediffChangedB">_</span><span class="ediffChangedB">numeric</span><span class="ediffChangedB">(</span>$<span class="ediffChangedB">HTTP</span>_<span class="ediffChangedB">GET</span><span class="ediffChangedB">_</span><span class="ediffChangedB">VARS</span><span class="ediffChangedB">[</span>&#039;attribute_page&#039;<span class="ediffChangedB">]</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span> <span class="ediffChangedB">?</span> $HTTP_GET_VARS[&#039;attribute_page&#039;] <span class="ediffChangedB">:</span> 1;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">21</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">22</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; $page_info = &#039;option_page=&#039; . $option_page . &#039;&amp;value_page=&#039; . $value_page . &#039;&amp;attribute_page=&#039; . $attribute_page;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">23</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">24</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; if (tep_not_null($action)) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">27</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; switch ($action) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">28</td><td class="diffLineNumbers">26</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case &#039;add_product_options&#039;:</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">29</td><td class="diffLineNumbers">27</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_options_id = tep_db_prepare_input($HTTP_POST_VARS[&#039;products_options_id&#039;]);</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">58</td><td class="diffLineNumbers">56</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $value_price = tep_db_prepare_input($HTTP_POST_VARS[&#039;value_price&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">59</td><td class="diffLineNumbers">57</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $price_prefix = tep_db_prepare_input($HTTP_POST_VARS[&#039;price_prefix&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">60</td><td class="diffLineNumbers">58</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">61</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&#034;insert into &#034; . TABLE_PRODUCTS_ATTRIBUTES . &#034; values (null, &#039;&#034; . (int)$products_id . &#034;&#039;, &#039;&#034; . (int)$options_id . &#034;&#039;, &#039;&#034; . (int)$values_id . &#034;&#039;, &#039;&#034; . tep_db_input($value_price) . &#034;&#039;, &#039;&#034; . tep_db_input($price_prefix) . &#034;&#039;)&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">59</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&#034;insert into &#034; . TABLE_PRODUCTS_ATTRIBUTES . &#034; values (null, &#039;&#034; . (int)$products_id . &#034;&#039;, &#039;&#034; . (int)$options_id . &#034;&#039;, &#039;&#034; . (int)$values_id . &#034;&#039;, &#039;&#034; . <span class="ediffChangedB">(</span><span class="ediffChangedB">float</span><span class="ediffChangedB">)</span>tep_db_input($value_price) . &#034;&#039;, &#039;&#034; . tep_db_input($price_prefix) . &#034;&#039;)&#034;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">62</td><td class="diffLineNumbers">60</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">63</td><td class="diffLineNumbers">61</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (DOWNLOAD_ENABLED == &#039;true&#039;) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">64</td><td class="diffLineNumbers">62</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_attributes_id = tep_db_insert_id();</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">109</td><td class="diffLineNumbers">107</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $price_prefix = tep_db_prepare_input($HTTP_POST_VARS[&#039;price_prefix&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">110</td><td class="diffLineNumbers">108</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $attribute_id = tep_db_prepare_input($HTTP_POST_VARS[&#039;attribute_id&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">111</td><td class="diffLineNumbers">109</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">112</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&#034;update &#034; . TABLE_PRODUCTS_ATTRIBUTES . &#034; set products_id = &#039;&#034; . (int)$products_id . &#034;&#039;, options_id = &#039;&#034; . (int)$options_id . &#034;&#039;, options_values_id = &#039;&#034; . (int)$values_id . &#034;&#039;, options_values_price = &#039;&#034; . tep_db_input($value_price) . &#034;&#039;, price_prefix = &#039;&#034; . tep_db_input($price_prefix) . &#034;&#039; where products_attributes_id = &#039;&#034; . (int)$attribute_id . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">110</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(&#034;update &#034; . TABLE_PRODUCTS_ATTRIBUTES . &#034; set products_id = &#039;&#034; . (int)$products_id . &#034;&#039;, options_id = &#039;&#034; . (int)$options_id . &#034;&#039;, options_values_id = &#039;&#034; . (int)$values_id . &#034;&#039;, options_values_price = &#039;&#034; . <span class="ediffChangedB">(</span><span class="ediffChangedB">float</span><span class="ediffChangedB">)</span>tep_db_input($value_price) . &#034;&#039;, price_prefix = &#039;&#034; . tep_db_input($price_prefix) . &#034;&#039; where products_attributes_id = &#039;&#034; . (int)$attribute_id . &#034;&#039;&#034;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">113</td><td class="diffLineNumbers">111</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">114</td><td class="diffLineNumbers">112</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (DOWNLOAD_ENABLED == &#039;true&#039;) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">115</td><td class="diffLineNumbers">113</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $products_attributes_filename = tep_db_prepare_input($HTTP_POST_VARS[&#039;products_attributes_filename&#039;]);</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">158</td><td class="diffLineNumbers">156</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;meta http-equiv=&#034;Content-Type&#034; content=&#034;text/html; charset=&lt;?php echo CHARSET; ?&gt;&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">159</td><td class="diffLineNumbers">157</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;title&gt;&lt;?php echo TITLE; ?&gt;&lt;/title&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">160</td><td class="diffLineNumbers">158</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;link rel=&#034;stylesheet&#034; type=&#034;text/css&#034; href=&#034;includes/stylesheet.css&#034;&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">161</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&lt;script language=&#034;javascript&#034;&gt;&lt;!--</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">162</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">function go_option() {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">163</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; if (document.option_order_by.selected.options[document.option_order_by.selected.selectedIndex].value != &#034;none&#034;) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">164</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; location = &#034;&lt;?php echo tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;option_page=&#039; . ($HTTP_GET_VARS[&#039;option_page&#039;] ? $HTTP_GET_VARS[&#039;option_page&#039;] : 1)); ?&gt;&amp;option_order_by=&#034;+document.option_order_by.selected.options[document.option_order_by.selected.selectedIndex].value;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">165</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">166</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">}</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">167</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">//--&gt;&lt;/script&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">168</td><td class="diffLineNumbers">159</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;/head&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">169</td><td class="diffLineNumbers">160</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;body marginwidth=&#034;0&#034; marginheight=&#034;0&#034; topmargin=&#034;0&#034; bottommargin=&#034;0&#034; leftmargin=&#034;0&#034; rightmargin=&#034;0&#034; bgcolor=&#034;#FFFFFF&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">170</td><td class="diffLineNumbers">161</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;!-- header //--&gt;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">194</td><td class="diffLineNumbers">185</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">195</td><td class="diffLineNumbers">186</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">196</td><td class="diffLineNumbers">187</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;pageHeading&#034;&gt;&amp;nbsp;&lt;?php echo $options_values[&#039;products_options_name&#039;]; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">197</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&amp;nbsp;&lt;?php echo tep_image(DIR_WS_IMAGES . &#039;pixel_trans.gif&#039;, &#039;&#039;, &#039;1&#039;, &#039;53&#039;); ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">198</td><td class="diffLineNumbers">188</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">199</td><td class="diffLineNumbers">189</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">200</td><td class="diffLineNumbers">190</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&#034;0&#034; width=&#034;100%&#034; cellspacing=&#034;0&#034; cellpadding=&#034;2&#034;&gt;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">233</td><td class="diffLineNumbers">223</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&#034;3&#034; class=&#034;main&#034;&gt;&lt;br&gt;&lt;?php echo TEXT_WARNING_OF_DELETE; ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">234</td><td class="diffLineNumbers">224</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">235</td><td class="diffLineNumbers">225</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">236</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;right&#034; colspan=&#034;3&#034; class=&#034;main&#034;&gt;&lt;br&gt;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, <span class="ediffChangedA">(</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span>$<span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">value</span><span class="ediffChangedA">_</span>page<span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">?</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">value</span>_<span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">value</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">:</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">(</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span><span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">?</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span> <span class="ediffChangedA">:</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, &#039; cancel &#039;); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">226</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;right&#034; colspan=&#034;3&#034; class=&#034;main&#034;&gt;&lt;br&gt;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_<span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, &#039; cancel &#039;); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">237</td><td class="diffLineNumbers">227</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">238</td><td class="diffLineNumbers">228</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">239</td><td class="diffLineNumbers">229</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">242</td><td class="diffLineNumbers">232</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;main&#034; colspan=&#034;3&#034;&gt;&lt;br&gt;&lt;?php echo TEXT_OK_TO_DELETE; ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">243</td><td class="diffLineNumbers">233</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">244</td><td class="diffLineNumbers">234</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">245</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;main&#034; align=&#034;right&#034; colspan=&#034;3&#034;&gt;&lt;br&gt;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=delete_option&amp;option_id=&#039; . $HTTP_GET_VARS[&#039;option_id&#039;], &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_delete.gif&#039;, &#039; delete &#039;); ?&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, <span class="ediffChangedA">(</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span>$<span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">order</span><span class="ediffChangedA">_</span><span class="ediffChangedA">by</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">?</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">order</span><span class="ediffChangedA">_</span><span class="ediffChangedA">by</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">order</span><span class="ediffChangedA">_</span><span class="ediffChangedA">by</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">:</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">(</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span><span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span>page<span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">?</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span>_<span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">page</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span> <span class="ediffChangedA">:</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, &#039; cancel &#039;); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">235</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;main&#034; align=&#034;right&#034; colspan=&#034;3&#034;&gt;&lt;br&gt;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=delete_option&amp;option_id=&#039; . $HTTP_GET_VARS[&#039;option_id&#039;] <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">page</span><span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_delete.gif&#039;, &#039; delete &#039;); ?&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_<span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, &#039; cancel &#039;); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">246</td><td class="diffLineNumbers">236</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">247</td><td class="diffLineNumbers">237</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">248</td><td class="diffLineNumbers">238</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">251</td><td class="diffLineNumbers">241</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">252</td><td class="diffLineNumbers">242</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">253</td><td class="diffLineNumbers">243</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">254</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; if (isset($HTTP_GET_VARS[&#039;option_order_by&#039;])) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">255</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $option_order_by = $HTTP_GET_VARS[&#039;option_order_by&#039;];</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">256</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">257</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $option_order_by = &#039;products_options_id&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">258</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">259</td><td class="diffLineNumbers">244</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">260</td><td class="diffLineNumbers">245</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">261</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&#034;<span class="ediffChangedA">2</span>&#034; class=&#034;pageHeading&#034;&gt;&amp;nbsp;&lt;?php echo HEADING_TITLE_OPT; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">262</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">&lt;</span><span class="ediffChangedA">td</span> <span class="ediffChangedA">align</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">right</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">br</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">form</span> <span class="ediffChangedA">name</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">option</span><span class="ediffChangedA">_</span><span class="ediffChangedA">order</span><span class="ediffChangedA">_</span><span class="ediffChangedA">by</span><span class="ediffChangedA">&#034;</span> <span class="ediffChangedA">action</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">?</span><span class="ediffChangedA">php</span> <span class="ediffChangedA">echo</span> <span class="ediffChangedA">FILENAME</span><span class="ediffChangedA">_</span><span class="ediffChangedA">PRODUCTS</span><span class="ediffChangedA">_</span><span class="ediffChangedA">ATTRIBUTES</span><span class="ediffChangedA">;</span> <span class="ediffChangedA">?</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">select</span> <span class="ediffChangedA">name</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">selected</span><span class="ediffChangedA">&#034;</span> <span class="ediffChangedA">onChange</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">go</span><span class="ediffChangedA">_</span><span class="ediffChangedA">option</span><span class="ediffChangedA">(</span><span class="ediffChangedA">)</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">option</span> <span class="ediffChangedA">value</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">products</span><span class="ediffChangedA">_</span><span class="ediffChangedA">options</span><span class="ediffChangedA">_</span><span class="ediffChangedA">id</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">?</span><span class="ediffChangedA">php</span> <span class="ediffChangedA">if</span> <span class="ediffChangedA">(</span><span class="ediffChangedA">$</span><span class="ediffChangedA">option</span><span class="ediffChangedA">_</span><span class="ediffChangedA">order</span><span class="ediffChangedA">_</span><span class="ediffChangedA">by</span> <span class="ediffChangedA">=</span><span class="ediffChangedA">=</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">products</span><span class="ediffChangedA">_</span><span class="ediffChangedA">options</span><span class="ediffChangedA">_</span><span class="ediffChangedA">id</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">{</span> <span class="ediffChangedA">echo</span> <span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">SELECTED</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">;</span> <span class="ediffChangedA">}</span> <span class="ediffChangedA">?</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">?</span><span class="ediffChangedA">php</span> <span class="ediffChangedA">echo</span> <span class="ediffChangedA">TEXT</span><span class="ediffChangedA">_</span><span class="ediffChangedA">OPTION</span><span class="ediffChangedA">_</span><span class="ediffChangedA">ID</span><span class="ediffChangedA">;</span> <span class="ediffChangedA">?</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">/</span><span class="ediffChangedA">option</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">option</span> <span class="ediffChangedA">value</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">products</span><span class="ediffChangedA">_</span><span class="ediffChangedA">options</span><span class="ediffChangedA">_</span><span class="ediffChangedA">name</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">?</span><span class="ediffChangedA">php</span> <span class="ediffChangedA">if</span> <span class="ediffChangedA">(</span><span class="ediffChangedA">$</span><span class="ediffChangedA">option</span><span class="ediffChangedA">_</span><span class="ediffChangedA">order</span><span class="ediffChangedA">_</span><span class="ediffChangedA">by</span> <span class="ediffChangedA">=</span><span class="ediffChangedA">=</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">products</span><span class="ediffChangedA">_</span><span class="ediffChangedA">options</span><span class="ediffChangedA">_</span><span class="ediffChangedA">name</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">{</span> <span class="ediffChangedA">echo</span> <span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">SELECTED</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">;</span> <span class="ediffChangedA">}</span> <span class="ediffChangedA">?</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">?</span><span class="ediffChangedA">php</span> <span class="ediffChangedA">echo</span> <span class="ediffChangedA">TEXT</span><span class="ediffChangedA">_</span><span class="ediffChangedA">OPTION</span><span class="ediffChangedA">_</span><span class="ediffChangedA">NAME</span><span class="ediffChangedA">;</span> <span class="ediffChangedA">?</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">/</span><span class="ediffChangedA">option</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">/</span><span class="ediffChangedA">select</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">/</span><span class="ediffChangedA">form</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">/</span><span class="ediffChangedA">td</span><span class="ediffChangedA">&gt;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">246</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&#034;<span class="ediffChangedB">3</span>&#034; class=&#034;pageHeading&#034;&gt;&amp;nbsp;&lt;?php echo HEADING_TITLE_OPT; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">263</td><td class="diffLineNumbers">247</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">264</td><td class="diffLineNumbers">248</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">265</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&#034;3&#034; class=&#034;smallText&#034;&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">249</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&#034;3&#034; class=&#034;smallText&#034; <span class="ediffChangedB">align</span><span class="ediffChangedB">=</span><span class="ediffChangedB">&#034;</span><span class="ediffChangedB">right</span><span class="ediffChangedB">&#034;</span>&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">266</td><td class="diffLineNumbers">250</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">267</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; $<span class="ediffChangedA">per</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span> <span class="ediffChangedA">=</span> <span class="ediffChangedA">MAX</span><span class="ediffChangedA">_</span><span class="ediffChangedA">ROW</span><span class="ediffChangedA">_</span><span class="ediffChangedA">LISTS</span><span class="ediffChangedA">_</span><span class="ediffChangedA">OPTIONS</span><span class="ediffChangedA">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">268</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">$</span>options = &#034;select * from &#034; . TABLE_PRODUCTS_OPTIONS . &#034; where language_id = &#039;&#034; . (int)$languages_id . &#034;&#039; order by <span class="ediffChangedA">&#034;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">option</span>_<span class="ediffChangedA">order</span>_<span class="ediffChangedA">by</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">269</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">if</span> <span class="ediffChangedA">(</span><span class="ediffChangedA">!</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span>$<span class="ediffChangedA">option</span>_<span class="ediffChangedA">page</span><span class="ediffChangedA">)</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">{</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">270</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">$</span><span class="ediffChangedA">option</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span> = <span class="ediffChangedA">1</span><span class="ediffChangedA">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">271</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">}</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">272</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; $<span class="ediffChangedA">prev</span><span class="ediffChangedA">_</span>option_page <span class="ediffChangedA">=</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">option</span>_<span class="ediffChangedA">page</span> <span class="ediffChangedA">-</span> <span class="ediffChangedA">1</span><span class="ediffChangedA">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">273</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">$</span><span class="ediffChangedA">next</span>_<span class="ediffChangedA">option</span>_<span class="ediffChangedA">page</span> <span class="ediffChangedA">=</span> $<span class="ediffChangedA">option</span>_<span class="ediffChangedA">page</span> <span class="ediffChangedA">+</span> <span class="ediffChangedA">1</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">251</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; $options = &#034;select * from &#034; . TABLE_PRODUCTS_OPTIONS . &#034; where language_id = &#039;&#034; . (int)$languages_id . &#034;&#039; order by <span class="ediffChangedB">products</span>_<span class="ediffChangedB">options</span>_<span class="ediffChangedB">id</span><span class="ediffChangedB">&#034;</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">252</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; $<span class="ediffChangedB">options</span>_<span class="ediffChangedB">split</span> = <span class="ediffChangedB">new</span> <span class="ediffChangedB">splitPageResults</span><span class="ediffChangedB">(</span>$option_page<span class="ediffChangedB">,</span> <span class="ediffChangedB">MAX</span>_<span class="ediffChangedB">ROW</span>_<span class="ediffChangedB">LISTS</span>_<span class="ediffChangedB">OPTIONS</span><span class="ediffChangedB">,</span> $<span class="ediffChangedB">options</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">options</span>_<span class="ediffChangedB">query</span><span class="ediffChangedB">_</span><span class="ediffChangedB">numrows</span><span class="ediffChangedB">)</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">274</td><td class="diffLineNumbers">253</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">275</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $option_query = tep_db_query($options);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">276</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">277</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $option_page_start = ($per_page * $option_page) - $per_page;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">278</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $num_rows = tep_db_num_rows($option_query);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">279</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">280</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; if ($num_rows &lt;= $per_page) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">281</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $num_pages = 1;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">282</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; } else if (($num_rows % $per_page) == 0) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">283</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $num_pages = ($num_rows / $per_page);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">284</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">285</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $num_pages = ($num_rows / $per_page) + 1;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">286</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">287</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $num_pages = (int) $num_pages;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">288</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">289</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $options = $options . &#034; LIMIT $option_page_start, $per_page&#034;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">290</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">291</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; // Previous</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">292</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; if ($prev_option_page)&nbsp; {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">293</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;option_page=&#039; . $prev_option_page) . &#039;&#034;&gt; &amp;lt;&amp;lt; &lt;/a&gt; | &#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">294</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">295</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">296</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; for ($i = 1; $i &lt;= $num_pages; $i++) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">297</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($i != $option_page) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">298</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;option_page=&#039; . $i) . &#039;&#034;&gt;&#039; . $i . &#039;&lt;/a&gt; | &#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">299</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">300</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;b&gt;&lt;font color=red&gt;&#039; . $i . &#039;&lt;/font&gt;&lt;/b&gt; | &#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">301</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">302</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">303</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">304</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; // Next</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">305</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; if ($option_page != $num_pages) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">306</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;option_page=&#039; . $next_option_page) . &#039;&#034;&gt; &amp;gt;&amp;gt; &lt;/a&gt;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">307</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">254</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; echo $options_split-&gt;display_links($options_query_numrows, MAX_ROW_LISTS_OPTIONS, MAX_DISPLAY_PAGE_LINKS, $option_page, &#039;value_page=&#039; . $value_page . &#039;&amp;attribute_page=&#039; . $attribute_page, &#039;option_page&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">308</td><td class="diffLineNumbers">255</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">309</td><td class="diffLineNumbers">256</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">310</td><td class="diffLineNumbers">257</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">329</td><td class="diffLineNumbers">276</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr class=&#034;&lt;?php echo (floor($rows/2) == ($rows/2) ? &#039;attributes-even&#039; : &#039;attributes-odd&#039;); ?&gt;&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">330</td><td class="diffLineNumbers">277</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">331</td><td class="diffLineNumbers">278</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (($action == &#039;update_option&#039;) &amp;&amp; ($HTTP_GET_VARS[&#039;option_id&#039;] == $options_values[&#039;products_options_id&#039;])) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">332</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;form name=&#034;option&#034; action=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=update_option_name&#039;, &#039;NONSSL&#039;) . &#039;&#034; method=&#034;post&#034;&gt;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">279</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;form name=&#034;option&#034; action=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=update_option_name<span class="ediffChangedB">&amp;</span>&#039; <span class="ediffChangedB">.</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">page</span><span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034; method=&#034;post&#034;&gt;&#039;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">333</td><td class="diffLineNumbers">280</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $inputs = &#039;&#039;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">334</td><td class="diffLineNumbers">281</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($i = 0, $n = sizeof($languages); $i &lt; $n; $i ++) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">335</td><td class="diffLineNumbers">282</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $option_name = tep_db_query(&#034;select products_options_name from &#034; . TABLE_PRODUCTS_OPTIONS . &#034; where products_options_id = &#039;&#034; . $options_values[&#039;products_options_id&#039;] . &#034;&#039; and language_id = &#039;&#034; . $languages[$i][&#039;id&#039;] . &#034;&#039;&#034;);</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">339</td><td class="diffLineNumbers">286</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">340</td><td class="diffLineNumbers">287</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo $options_values[&#039;products_options_id&#039;]; ?&gt;&lt;input type=&#034;hidden&#034; name=&#034;option_id&#034; value=&#034;&lt;?php echo $options_values[&#039;products_options_id&#039;]; ?&gt;&#034;&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">341</td><td class="diffLineNumbers">288</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;smallText&#034;&gt;&lt;?php echo $inputs; ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">342</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo tep_image_submit(&#039;button_update.gif&#039;, IMAGE_UPDATE); ?&gt;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, IMAGE_CANCEL); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">289</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo tep_image_submit(&#039;button_update.gif&#039;, IMAGE_UPDATE); ?&gt;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, <span class="ediffChangedB">$</span><span class="ediffChangedB">page</span><span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, IMAGE_CANCEL); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">343</td><td class="diffLineNumbers">290</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">344</td><td class="diffLineNumbers">291</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;/form&gt;&#039; . &#034;\n&#034;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">345</td><td class="diffLineNumbers">292</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">346</td><td class="diffLineNumbers">293</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">347</td><td class="diffLineNumbers">294</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo $options_values[&#034;products_options_id&#034;]; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">348</td><td class="diffLineNumbers">295</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo $options_values[&#034;products_options_name&#034;]; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">349</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=update_option&amp;option_id=&#039; . $options_values[&#039;products_options_id&#039;] . &#039;&amp;<span class="ediffChangedA">option</span><span class="ediffChangedA">_</span><span class="ediffChangedA">order</span><span class="ediffChangedA">_</span><span class="ediffChangedA">by</span><span class="ediffChangedA">=</span>&#039; . $<span class="ediffChangedA">option</span><span class="ediffChangedA">_</span><span class="ediffChangedA">order</span><span class="ediffChangedA">_</span><span class="ediffChangedA">by</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">option</span><span class="ediffChangedA">_</span>page<span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">option</span>_<span class="ediffChangedA">page</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_edit.gif&#039;, IMAGE_UPDATE); ?&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=delete_product_option&amp;option_id=&#039; . $options_values[&#039;products_options_id&#039;], &#039;NONSSL&#039;) , &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_delete.gif&#039;, IMAGE_DELETE); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">296</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=update_option&amp;option_id=&#039; . $options_values[&#039;products_options_id&#039;] . &#039;&amp;&#039; . $page_<span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_edit.gif&#039;, IMAGE_UPDATE); ?&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=delete_product_option&amp;option_id=&#039; . $options_values[&#039;products_options_id&#039;] <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">page</span><span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) , &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_delete.gif&#039;, IMAGE_DELETE); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">350</td><td class="diffLineNumbers">297</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">351</td><td class="diffLineNumbers">298</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">352</td><td class="diffLineNumbers">299</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">365</td><td class="diffLineNumbers">312</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">366</td><td class="diffLineNumbers">313</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr class=&#034;&lt;?php echo (floor($rows/2) == ($rows/2) ? &#039;attributes-even&#039; : &#039;attributes-odd&#039;); ?&gt;&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">367</td><td class="diffLineNumbers">314</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">368</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;form name=&#034;options&#034; action=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=add_product_options&amp;<span class="ediffChangedA">option</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span>&#039; . $<span class="ediffChangedA">option</span><span class="ediffChangedA">_</span>page, &#039;NONSSL&#039;) . &#039;&#034; method=&#034;post&#034;&gt;&lt;input type=&#034;hidden&#034; name=&#034;products_options_id&#034; value=&#034;&#039; . $next_id . &#039;&#034;&gt;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">315</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;form name=&#034;options&#034; action=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=add_product_options&amp;&#039; . $page<span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034; method=&#034;post&#034;&gt;&lt;input type=&#034;hidden&#034; name=&#034;products_options_id&#034; value=&#034;&#039; . $next_id . &#039;&#034;&gt;&#039;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">369</td><td class="diffLineNumbers">316</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $inputs = &#039;&#039;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">370</td><td class="diffLineNumbers">317</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($i = 0, $n = sizeof($languages); $i &lt; $n; $i ++) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">371</td><td class="diffLineNumbers">318</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $inputs .= $languages[$i][&#039;code&#039;] . &#039;:&amp;nbsp;&lt;input type=&#034;text&#034; name=&#034;option_name[&#039; . $languages[$i][&#039;id&#039;] . &#039;]&#034; size=&#034;20&#034;&gt;&amp;nbsp;&lt;br&gt;&#039;;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">396</td><td class="diffLineNumbers">343</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">397</td><td class="diffLineNumbers">344</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">398</td><td class="diffLineNumbers">345</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&#034;3&#034; class=&#034;pageHeading&#034;&gt;&amp;nbsp;&lt;?php echo $values_values[&#039;products_options_values_name&#039;]; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">399</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&amp;nbsp;&lt;?php echo tep_image(DIR_WS_IMAGES . &#039;pixel_trans.gif&#039;, &#039;&#039;, &#039;1&#039;, &#039;53&#039;); ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">400</td><td class="diffLineNumbers">346</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">401</td><td class="diffLineNumbers">347</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">402</td><td class="diffLineNumbers">348</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&#034;0&#034; width=&#034;100%&#034; cellspacing=&#034;0&#034; cellpadding=&#034;2&#034;&gt;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">434</td><td class="diffLineNumbers">380</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;main&#034; colspan=&#034;3&#034;&gt;&lt;br&gt;&lt;?php echo TEXT_WARNING_OF_DELETE; ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">435</td><td class="diffLineNumbers">381</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">436</td><td class="diffLineNumbers">382</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">437</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;main&#034; align=&#034;right&#034; colspan=&#034;3&#034;&gt;&lt;br&gt;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, <span class="ediffChangedA">(</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span>$<span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">value</span><span class="ediffChangedA">_</span>page<span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">?</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">value</span>_<span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">value</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">:</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">(</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span><span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">?</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span> <span class="ediffChangedA">:</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, &#039; cancel &#039;); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">383</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;main&#034; align=&#034;right&#034; colspan=&#034;3&#034;&gt;&lt;br&gt;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_<span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, &#039; cancel &#039;); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">438</td><td class="diffLineNumbers">384</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">439</td><td class="diffLineNumbers">385</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">440</td><td class="diffLineNumbers">386</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">443</td><td class="diffLineNumbers">389</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;main&#034; colspan=&#034;3&#034;&gt;&lt;br&gt;&lt;?php echo TEXT_OK_TO_DELETE; ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">444</td><td class="diffLineNumbers">390</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">445</td><td class="diffLineNumbers">391</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">446</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;main&#034; align=&#034;right&#034; colspan=&#034;3&#034;&gt;&lt;br&gt;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=delete_value&amp;value_id=&#039; . $HTTP_GET_VARS[&#039;value_id&#039;], &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_delete.gif&#039;, &#039; delete &#039;); ?&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">option</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> $<span class="ediffChangedA">option</span><span class="ediffChangedA">_</span>page <span class="ediffChangedA">.</span> <span class="ediffChangedA">(</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span><span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span>_<span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">value</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">?</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">value</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">value</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span> <span class="ediffChangedA">:</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">(</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span><span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">?</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span> <span class="ediffChangedA">:</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, &#039; cancel &#039;); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">392</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;main&#034; align=&#034;right&#034; colspan=&#034;3&#034;&gt;&lt;br&gt;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=delete_value&amp;value_id=&#039; . $HTTP_GET_VARS[&#039;value_id&#039;] <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">page</span><span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_delete.gif&#039;, &#039; delete &#039;); ?&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_<span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, &#039; cancel &#039;); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">447</td><td class="diffLineNumbers">393</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">448</td><td class="diffLineNumbers">394</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">449</td><td class="diffLineNumbers">395</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">454</td><td class="diffLineNumbers">400</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; } else {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">455</td><td class="diffLineNumbers">401</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">456</td><td class="diffLineNumbers">402</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">457</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&#034;<span class="ediffChangedA">3</span>&#034; class=&#034;pageHeading&#034;&gt;&amp;nbsp;&lt;?php echo HEADING_TITLE_VAL; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">458</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">&lt;</span><span class="ediffChangedA">td</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">nbsp</span><span class="ediffChangedA">;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">?</span><span class="ediffChangedA">php</span> <span class="ediffChangedA">echo</span> <span class="ediffChangedA">tep</span><span class="ediffChangedA">_</span><span class="ediffChangedA">image</span><span class="ediffChangedA">(</span><span class="ediffChangedA">DIR</span><span class="ediffChangedA">_</span><span class="ediffChangedA">WS</span><span class="ediffChangedA">_</span><span class="ediffChangedA">IMAGES</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">pixel</span><span class="ediffChangedA">_</span><span class="ediffChangedA">trans</span><span class="ediffChangedA">.</span><span class="ediffChangedA">gif</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">1</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">53</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span><span class="ediffChangedA">;</span> <span class="ediffChangedA">?</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">nbsp</span><span class="ediffChangedA">;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">/</span><span class="ediffChangedA">td</span><span class="ediffChangedA">&gt;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">403</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&#034;<span class="ediffChangedB">4</span>&#034; class=&#034;pageHeading&#034;&gt;&amp;nbsp;&lt;?php echo HEADING_TITLE_VAL; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">459</td><td class="diffLineNumbers">404</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">460</td><td class="diffLineNumbers">405</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">461</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&#034;4&#034; class=&#034;smallText&#034;&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">406</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&#034;4&#034; class=&#034;smallText&#034; <span class="ediffChangedB">align</span><span class="ediffChangedB">=</span><span class="ediffChangedB">&#034;</span><span class="ediffChangedB">right</span><span class="ediffChangedB">&#034;</span>&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">462</td><td class="diffLineNumbers">407</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">463</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $per_page = MAX_ROW_LISTS_OPTIONS;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">464</td><td class="diffLineNumbers">408</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; $values = &#034;select pov.products_options_values_id, pov.products_options_values_name, pov2po.products_options_id from &#034; . TABLE_PRODUCTS_OPTIONS_VALUES . &#034; pov left join &#034; . TABLE_PRODUCTS_OPTIONS_VALUES_TO_PRODUCTS_OPTIONS . &#034; pov2po on pov.products_options_values_id = pov2po.products_options_values_id where pov.language_id = &#039;&#034; . (int)$languages_id . &#034;&#039; order by pov.products_options_values_id&#034;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">465</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">if</span> <span class="ediffChangedA">(</span><span class="ediffChangedA">!</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span>$<span class="ediffChangedA">value</span>_<span class="ediffChangedA">page</span><span class="ediffChangedA">)</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">{</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">466</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">$</span><span class="ediffChangedA">value</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span> = <span class="ediffChangedA">1</span><span class="ediffChangedA">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">467</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">}</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">468</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; $<span class="ediffChangedA">prev</span><span class="ediffChangedA">_</span>value_page <span class="ediffChangedA">=</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">value</span>_<span class="ediffChangedA">page</span> <span class="ediffChangedA">-</span> <span class="ediffChangedA">1</span><span class="ediffChangedA">;</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">469</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; <span class="ediffChangedA">$</span><span class="ediffChangedA">next</span>_<span class="ediffChangedA">value</span>_<span class="ediffChangedA">page</span> <span class="ediffChangedA">=</span> $<span class="ediffChangedA">value</span>_<span class="ediffChangedA">page</span> <span class="ediffChangedA">+</span> <span class="ediffChangedA">1</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">409</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; $<span class="ediffChangedB">values</span>_<span class="ediffChangedB">split</span> = <span class="ediffChangedB">new</span> <span class="ediffChangedB">splitPageResults</span><span class="ediffChangedB">(</span>$value_page<span class="ediffChangedB">,</span> <span class="ediffChangedB">MAX</span>_<span class="ediffChangedB">ROW</span>_<span class="ediffChangedB">LISTS</span>_<span class="ediffChangedB">OPTIONS</span><span class="ediffChangedB">,</span> $<span class="ediffChangedB">values</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">values</span>_<span class="ediffChangedB">query</span><span class="ediffChangedB">_</span><span class="ediffChangedB">numrows</span><span class="ediffChangedB">)</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">470</td><td class="diffLineNumbers">410</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">471</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $value_query = tep_db_query($values);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">472</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">473</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $value_page_start = ($per_page * $value_page) - $per_page;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">474</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $num_rows = tep_db_num_rows($value_query);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">475</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">476</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; if ($num_rows &lt;= $per_page) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">477</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $num_pages = 1;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">478</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; } else if (($num_rows % $per_page) == 0) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">479</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $num_pages = ($num_rows / $per_page);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">480</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">481</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $num_pages = ($num_rows / $per_page) + 1;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">482</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">483</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $num_pages = (int) $num_pages;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">484</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">485</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $values = $values . &#034; LIMIT $value_page_start, $per_page&#034;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">486</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">487</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; // Previous</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">488</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; if ($prev_value_page)&nbsp; {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">489</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;option_order_by=&#039; . $option_order_by . &#039;&amp;value_page=&#039; . $prev_value_page) . &#039;&#034;&gt; &amp;lt;&amp;lt; &lt;/a&gt; | &#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">490</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">491</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">492</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; for ($i = 1; $i &lt;= $num_pages; $i++) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">493</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($i != $value_page) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">494</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, (isset($option_order_by) ? &#039;option_order_by=&#039; . $option_order_by . &#039;&amp;&#039; : &#039;&#039;) . &#039;value_page=&#039; . $i) . &#039;&#034;&gt;&#039; . $i . &#039;&lt;/a&gt; | &#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">495</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">496</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;b&gt;&lt;font color=red&gt;&#039; . $i . &#039;&lt;/font&gt;&lt;/b&gt; | &#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">497</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">498</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">499</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">500</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; // Next</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">501</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; if ($value_page != $num_pages) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">502</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, (isset($option_order_by) ? &#039;option_order_by=&#039; . $option_order_by . &#039;&amp;&#039; : &#039;&#039;) . &#039;value_page=&#039; . $next_value_page) . &#039;&#034;&gt; &amp;gt;&amp;gt;&lt;/a&gt; &#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">503</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">411</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; echo $values_split-&gt;display_links($values_query_numrows, MAX_ROW_LISTS_OPTIONS, MAX_DISPLAY_PAGE_LINKS, $value_page, &#039;option_page=&#039; . $option_page . &#039;&amp;attribute_page=&#039; . $attribute_page, &#039;value_page&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">504</td><td class="diffLineNumbers">412</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">505</td><td class="diffLineNumbers">413</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">506</td><td class="diffLineNumbers">414</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">528</td><td class="diffLineNumbers">436</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr class=&#034;&lt;?php echo (floor($rows/2) == ($rows/2) ? &#039;attributes-even&#039; : &#039;attributes-odd&#039;); ?&gt;&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">529</td><td class="diffLineNumbers">437</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">530</td><td class="diffLineNumbers">438</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (($action == &#039;update_option_value&#039;) &amp;&amp; ($HTTP_GET_VARS[&#039;value_id&#039;] == $values_values[&#039;products_options_values_id&#039;])) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">531</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;form name=&#034;values&#034; action=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=update_value&#039;, &#039;NONSSL&#039;) . &#039;&#034; method=&#034;post&#034;&gt;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">439</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;form name=&#034;values&#034; action=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=update_value<span class="ediffChangedB">&amp;</span>&#039; <span class="ediffChangedB">.</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">page</span><span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034; method=&#034;post&#034;&gt;&#039;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">532</td><td class="diffLineNumbers">440</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $inputs = &#039;&#039;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">533</td><td class="diffLineNumbers">441</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($i = 0, $n = sizeof($languages); $i &lt; $n; $i ++) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">534</td><td class="diffLineNumbers">442</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $value_name = tep_db_query(&#034;select products_options_values_name from &#034; . TABLE_PRODUCTS_OPTIONS_VALUES . &#034; where products_options_values_id = &#039;&#034; . (int)$values_values[&#039;products_options_values_id&#039;] . &#034;&#039; and language_id = &#039;&#034; . (int)$languages[$i][&#039;id&#039;] . &#034;&#039;&#034;);</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">550</td><td class="diffLineNumbers">458</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">551</td><td class="diffLineNumbers">459</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">552</td><td class="diffLineNumbers">460</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;smallText&#034;&gt;&lt;?php echo $inputs; ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">553</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo tep_image_submit(&#039;button_update.gif&#039;, IMAGE_UPDATE); ?&gt;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, IMAGE_CANCEL); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">461</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo tep_image_submit(&#039;button_update.gif&#039;, IMAGE_UPDATE); ?&gt;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, <span class="ediffChangedB">$</span><span class="ediffChangedB">page</span><span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, IMAGE_CANCEL); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">554</td><td class="diffLineNumbers">462</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">555</td><td class="diffLineNumbers">463</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;/form&gt;&#039;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">556</td><td class="diffLineNumbers">464</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">557</td><td class="diffLineNumbers">465</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">558</td><td class="diffLineNumbers">466</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo $values_values[&#034;products_options_values_id&#034;]; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">559</td><td class="diffLineNumbers">467</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo $options_name; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">560</td><td class="diffLineNumbers">468</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo $values_name; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">561</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=update_option_value&amp;value_id=&#039; . $values_values[&#039;products_options_values_id&#039;] . <span class="ediffChangedA">(</span><span class="ediffChangedA">isset</span><span class="ediffChangedA">(</span><span class="ediffChangedA">$</span><span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span>&#039;<span class="ediffChangedA">value</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span><span class="ediffChangedA">)</span> <span class="ediffChangedA">?</span> <span class="ediffChangedA">&#039;</span>&amp;<span class="ediffChangedA">value</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span>&#039; . $<span class="ediffChangedA">HTTP</span><span class="ediffChangedA">_</span><span class="ediffChangedA">GET</span><span class="ediffChangedA">_</span><span class="ediffChangedA">VARS</span><span class="ediffChangedA">[</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">value</span><span class="ediffChangedA">_</span>page<span class="ediffChangedA">&#039;</span><span class="ediffChangedA">]</span> <span class="ediffChangedA">:</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&#039;</span><span class="ediffChangedA">)</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_edit.gif&#039;, IMAGE_UPDATE); ?&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=delete_option_value&amp;value_id=&#039; . $values_values[&#039;products_options_values_id&#039;], &#039;NONSSL&#039;) , &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_delete.gif&#039;, IMAGE_DELETE); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">469</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=update_option_value&amp;value_id=&#039; . $values_values[&#039;products_options_values_id&#039;] . &#039;&amp;&#039; . $page<span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_edit.gif&#039;, IMAGE_UPDATE); ?&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=delete_option_value&amp;value_id=&#039; . $values_values[&#039;products_options_values_id&#039;] <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">page</span><span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) , &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_delete.gif&#039;, IMAGE_DELETE); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">562</td><td class="diffLineNumbers">470</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">563</td><td class="diffLineNumbers">471</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">564</td><td class="diffLineNumbers">472</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $max_values_id_query = tep_db_query(&#034;select max(products_options_values_id) + 1 as next_id from &#034; . TABLE_PRODUCTS_OPTIONS_VALUES);</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">575</td><td class="diffLineNumbers">483</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">576</td><td class="diffLineNumbers">484</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr class=&#034;&lt;?php echo (floor($rows/2) == ($rows/2) ? &#039;attributes-even&#039; : &#039;attributes-odd&#039;); ?&gt;&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">577</td><td class="diffLineNumbers">485</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">578</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;form name=&#034;values&#034; action=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=add_product_option_values&amp;<span class="ediffChangedA">value</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span>&#039; . $<span class="ediffChangedA">value</span><span class="ediffChangedA">_</span>page, &#039;NONSSL&#039;) . &#039;&#034; method=&#034;post&#034;&gt;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">486</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;form name=&#034;values&#034; action=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=add_product_option_values&amp;&#039; . $page<span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034; method=&#034;post&#034;&gt;&#039;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">579</td><td class="diffLineNumbers">487</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">580</td><td class="diffLineNumbers">488</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo $next_id; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">581</td><td class="diffLineNumbers">489</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;select name=&#034;option_id&#034;&gt;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">611</td><td class="diffLineNumbers">519</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt; </td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">612</td><td class="diffLineNumbers">520</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;!-- products_attributes //--&gt;&nbsp; </td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">613</td><td class="diffLineNumbers">521</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">522</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">523</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">524</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">614</td><td class="diffLineNumbers">525</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td width=&#034;100%&#034;&gt;&lt;table border=&#034;0&#034; width=&#034;100%&#034; cellspacing=&#034;0&#034; cellpadding=&#034;0&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">615</td><td class="diffLineNumbers">526</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">616</td><td class="diffLineNumbers">527</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;pageHeading&#034;&gt;&amp;nbsp;&lt;?php echo HEADING_TITLE_ATRIB; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">617</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&amp;nbsp;&lt;?php echo tep_image(DIR_WS_IMAGES . &#039;pixel_trans.gif&#039;, &#039;&#039;, &#039;1&#039;, &#039;53&#039;); ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">618</td><td class="diffLineNumbers">528</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">619</td><td class="diffLineNumbers">529</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">620</td><td class="diffLineNumbers">530</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">625</td><td class="diffLineNumbers">535</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; } else {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">626</td><td class="diffLineNumbers">536</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; $form_action = &#039;add_product_attributes&#039;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">627</td><td class="diffLineNumbers">537</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">628</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">629</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; if (!isset($attribute_page)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">630</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $attribute_page = 1;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">631</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">632</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; $prev_attribute_page = $attribute_page - 1;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">633</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; $next_attribute_page = $attribute_page + 1;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">634</td><td class="diffLineNumbers">538</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">635</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;<span class="ediffChangedA">form</span> <span class="ediffChangedA">name</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">attributes</span><span class="ediffChangedA">&#034;</span> <span class="ediffChangedA">action</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">&lt;</span><span class="ediffChangedA">?</span><span class="ediffChangedA">php</span> <span class="ediffChangedA">echo</span> <span class="ediffChangedA">tep</span><span class="ediffChangedA">_</span><span class="ediffChangedA">href</span><span class="ediffChangedA">_</span><span class="ediffChangedA">link</span><span class="ediffChangedA">(</span><span class="ediffChangedA">FILENAME</span><span class="ediffChangedA">_</span><span class="ediffChangedA">PRODUCTS</span><span class="ediffChangedA">_</span><span class="ediffChangedA">ATTRIBUTES</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">action</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">form</span><span class="ediffChangedA">_</span><span class="ediffChangedA">action</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">option</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">option</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">value</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">value</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">)</span><span class="ediffChangedA">;</span> <span class="ediffChangedA">?</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&#034;</span> <span class="ediffChangedA">method</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">post</span><span class="ediffChangedA">&#034;</span><span class="ediffChangedA">&gt;</span><span class="ediffChangedA">&lt;</span>table border=&#034;0&#034; width=&#034;100%&#034; cellspacing=&#034;0&#034; cellpadding=&#034;2&#034;&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">539</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;table border=&#034;0&#034; width=&#034;100%&#034; cellspacing=&#034;0&#034; cellpadding=&#034;2&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">636</td><td class="diffLineNumbers">540</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">637</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td <span class="ediffChangedA">colspan</span>=&#034;<span class="ediffChangedA">7</span>&#034; <span class="ediffChangedA">class</span>=&#034;<span class="ediffChangedA">smallText</span>&#034;&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">541</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td <span class="ediffChangedB">class</span>=&#034;<span class="ediffChangedB">smallText</span>&#034; <span class="ediffChangedB">align</span>=&#034;<span class="ediffChangedB">right</span>&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">638</td><td class="diffLineNumbers">542</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">639</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; $per_page = MAX_ROW_LISTS_OPTIONS;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">640</td><td class="diffLineNumbers">543</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; $attributes = &#034;select pa.* from &#034; . TABLE_PRODUCTS_ATTRIBUTES . &#034; pa left join &#034; . TABLE_PRODUCTS_DESCRIPTION . &#034; pd on pa.products_id = pd.products_id and pd.language_id = &#039;&#034; . (int)$languages_id . &#034;&#039; order by pd.products_name&#034;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">641</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp; $<span class="ediffChangedA">attribute</span>_<span class="ediffChangedA">query</span> = <span class="ediffChangedA">tep</span>_<span class="ediffChangedA">db</span>_<span class="ediffChangedA">query</span><span class="ediffChangedA">(</span>$attributes);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">544</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp; $<span class="ediffChangedB">attributes</span>_<span class="ediffChangedB">split</span> = <span class="ediffChangedB">new</span> <span class="ediffChangedB">splitPageResults</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">attribute</span>_<span class="ediffChangedB">page</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">MAX</span>_<span class="ediffChangedB">ROW</span><span class="ediffChangedB">_</span><span class="ediffChangedB">LISTS</span><span class="ediffChangedB">_</span><span class="ediffChangedB">OPTIONS</span><span class="ediffChangedB">,</span> $attributes<span class="ediffChangedB">,</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">attributes</span><span class="ediffChangedB">_</span><span class="ediffChangedB">query</span><span class="ediffChangedB">_</span><span class="ediffChangedB">numrows</span>);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">642</td><td class="diffLineNumbers">545</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">643</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; $attribute_page_start = ($per_page * $attribute_page) - $per_page;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">644</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; $num_rows = tep_db_num_rows($attribute_query);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">645</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">646</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; if ($num_rows &lt;= $per_page) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">647</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp; $num_pages = 1;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">648</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; } else if (($num_rows % $per_page) == 0) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">649</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp; $num_pages = ($num_rows / $per_page);</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">650</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">651</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp; $num_pages = ($num_rows / $per_page) + 1;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">652</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">653</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; $num_pages = (int) $num_pages;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">654</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">655</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; $attributes = $attributes . &#034; LIMIT $attribute_page_start, $per_page&#034;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">656</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">657</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; // Previous</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">658</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; if ($prev_attribute_page) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">659</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;attribute_page=&#039; . $prev_attribute_page) . &#039;&#034;&gt; &amp;lt;&amp;lt; &lt;/a&gt; | &#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">660</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">661</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">662</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; for ($i = 1; $i &lt;= $num_pages; $i++) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">663</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; if ($i != $attribute_page) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">664</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;attribute_page=&#039; . $i) . &#039;&#034;&gt;&#039; . $i . &#039;&lt;/a&gt; | &#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">665</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">666</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &#039;&lt;b&gt;&lt;font color=&#034;red&#034;&gt;&#039; . $i . &#039;&lt;/font&gt;&lt;/b&gt; | &#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">667</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">668</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">669</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">670</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; // Next</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">671</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; if ($attribute_page != $num_pages) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">672</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;attribute_page=&#039; . $next_attribute_page) . &#039;&#034;&gt; &amp;gt;&amp;gt; &lt;/a&gt;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">673</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">546</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; echo $attributes_split-&gt;display_links($attributes_query_numrows, MAX_ROW_LISTS_OPTIONS, MAX_DISPLAY_PAGE_LINKS, $attribute_page, &#039;option_page=&#039; . $option_page . &#039;&amp;value_page=&#039; . $value_page, &#039;attribute_page&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">674</td><td class="diffLineNumbers">547</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">675</td><td class="diffLineNumbers">548</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">676</td><td class="diffLineNumbers">549</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">550</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">551</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;form name=&#034;attributes&#034; action=&#034;&lt;?php echo tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=&#039; . $form_action . &#039;&amp;&#039; . $page_info); ?&gt;&#034; method=&#034;post&#034;&gt;&lt;table border=&#034;0&#034; width=&#034;100%&#034; cellspacing=&#034;0&#034; cellpadding=&#034;2&#034;&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">677</td><td class="diffLineNumbers">552</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">678</td><td class="diffLineNumbers">553</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td colspan=&#034;7&#034;&gt;&lt;?php echo tep_black_line(); ?&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">679</td><td class="diffLineNumbers">554</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">741</td><td class="diffLineNumbers">616</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">742</td><td class="diffLineNumbers">617</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;right&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;input type=&#034;text&#034; name=&#034;value_price&#034; value=&#034;&lt;?php echo $attributes_values[&#039;options_values_price&#039;]; ?&gt;&#034; size=&#034;6&#034;&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">743</td><td class="diffLineNumbers">618</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;input type=&#034;text&#034; name=&#034;price_prefix&#034; value=&#034;&lt;?php echo $attributes_values[&#039;price_prefix&#039;]; ?&gt;&#034; size=&#034;2&#034;&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">744</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo tep_image_submit(&#039;button_update.gif&#039;, IMAGE_UPDATE); ?&gt;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> $<span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span>page, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, IMAGE_CANCEL); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">619</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo tep_image_submit(&#039;button_update.gif&#039;, IMAGE_UPDATE); ?&gt;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page<span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, IMAGE_CANCEL); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">745</td><td class="diffLineNumbers">620</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">746</td><td class="diffLineNumbers">621</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (DOWNLOAD_ENABLED == &#039;true&#039;) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">747</td><td class="diffLineNumbers">622</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $download_query_raw =&#034;select products_attributes_filename, products_attributes_maxdays, products_attributes_maxcount </td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">784</td><td class="diffLineNumbers">659</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;b&gt;&lt;?php echo $values_name; ?&gt;&lt;/b&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">785</td><td class="diffLineNumbers">660</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;right&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;b&gt;&lt;?php echo $attributes_values[&#034;options_values_price&#034;]; ?&gt;&lt;/b&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">786</td><td class="diffLineNumbers">661</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;b&gt;&lt;?php echo $attributes_values[&#034;price_prefix&#034;]; ?&gt;&lt;/b&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">787</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;b&gt;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=delete_attribute&amp;attribute_id=&#039; . $HTTP_GET_VARS[&#039;attribute_id&#039;]) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_confirm.gif&#039;, IMAGE_CONFIRM); ?&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">option</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> $<span class="ediffChangedA">option</span><span class="ediffChangedA">_</span>page <span class="ediffChangedA">.</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">value</span>_<span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">value</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">&#039;</span><span class="ediffChangedA">&amp;</span><span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span><span class="ediffChangedA">&#039;</span> <span class="ediffChangedA">.</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, IMAGE_CANCEL); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/b&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">662</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;b&gt;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=delete_attribute&amp;attribute_id=&#039; . $HTTP_GET_VARS[&#039;attribute_id&#039;] <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">page</span><span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_confirm.gif&#039;, IMAGE_CONFIRM); ?&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_<span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_cancel.gif&#039;, IMAGE_CANCEL); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/b&gt;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">788</td><td class="diffLineNumbers">663</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">789</td><td class="diffLineNumbers">664</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">790</td><td class="diffLineNumbers">665</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">794</td><td class="diffLineNumbers">669</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo $values_name; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">795</td><td class="diffLineNumbers">670</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;right&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo $attributes_values[&#034;options_values_price&#034;]; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">796</td><td class="diffLineNumbers">671</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo $attributes_values[&#034;price_prefix&#034;]; ?&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">797</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=update_attribute&amp;attribute_id=&#039; . $attributes_values[&#039;products_attributes_id&#039;] . &#039;&amp;<span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span>&#039; . $<span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span>page, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_edit.gif&#039;, IMAGE_UPDATE); ?&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=delete_product_attribute&amp;attribute_id=&#039; . $attributes_values[&#039;products_attributes_id&#039;] . &#039;&amp;<span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span><span class="ediffChangedA">page</span><span class="ediffChangedA">=</span>&#039; . $<span class="ediffChangedA">attribute</span><span class="ediffChangedA">_</span>page, &#039;NONSSL&#039;) , &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_delete.gif&#039;, IMAGE_DELETE); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">672</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td align=&#034;center&#034; class=&#034;smallText&#034;&gt;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=update_attribute&amp;attribute_id=&#039; . $attributes_values[&#039;products_attributes_id&#039;] . &#039;&amp;&#039; . $page<span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) . &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_edit.gif&#039;, IMAGE_UPDATE); ?&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&lt;?php echo &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, &#039;action=delete_product_attribute&amp;attribute_id=&#039; . $attributes_values[&#039;products_attributes_id&#039;] . &#039;&amp;&#039; . $page<span class="ediffChangedB">_</span><span class="ediffChangedB">info</span>, &#039;NONSSL&#039;) , &#039;&#034;&gt;&#039;; ?&gt;&lt;?php echo tep_image_button(&#039;button_delete.gif&#039;, IMAGE_DELETE); ?&gt;&lt;/a&gt;&amp;nbsp;&lt;/td&gt;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">798</td><td class="diffLineNumbers">673</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&lt;?php</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">799</td><td class="diffLineNumbers">674</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">800</td><td class="diffLineNumbers">675</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; $max_attributes_id_query = tep_db_query(&#034;select max(products_attributes_id) + 1 as next_id from &#034; . TABLE_PRODUCTS_ATTRIBUTES);</td>
        </tr>
</table>

<h3>[A] Protect includes directory from direct HTTP requests</h3>

<ul>
  <li>Add a .htaccess file to the admin/includes/ directory to prevent direct HTTP requests to PHP files.</li>
</ul>

<p class="affectedFiles"><b>Added Files</b><br />
catalog/admin/includes/.htaccess</p>

<span class="affectedFiles">File: catalog/admin/includes/.htaccess (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/.htaccess?r=1775">online</a>) (<a href="http://svn.oscommerce.com/fisheye/browse/~raw,r=1775/osCommerce/oscommerce2/trunk/catalog/admin/includes/.htaccess">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
  <tr>
    <td class="lineContent diffContent"># $Id: .htaccess 1775 2008-01-09 19:26:55Z hpdl $
#
# This is used with Apache WebServers
# The following blocks direct HTTP requests in this directory recursively
#
# For this to work, you must include the parameter 'Limit' to the AllowOverride configuration
#
# Example:
#
#&lt;Directory "/usr/local/apache/htdocs"&gt;
#  AllowOverride Limit
#
# 'All' with also work. (This configuration is in your apache/conf/httpd.conf file)
#
# This does not affect PHP include/require functions
#
# Example: http://server/catalog/admin/includes/application_top.php will not work

&lt;Files *.php&gt;
Order Deny,Allow
Deny from all
&lt;/Files&gt;</td>
  </tr>
</table>

<h3>[A] Display module version if available</h3>

<ul>
  <li>Display module version if it contains a version signature string.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/modules.php<br />
catalog/admin/includes/languages/english/modules.php<br />
catalog/admin/includes/languages/espanol/modules.php<br />
catalog/admin/includes/languages/german/modules.php</p>

<span class="affectedFiles">File: catalog/admin/modules.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/modules.php?r1=477&r2=1802">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/modules.php?r1=477&r2=1802">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">143</td><td class="diffLineNumbers">143</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $module_info = array(&#039;code&#039; =&gt; $module-&gt;code,</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">144</td><td class="diffLineNumbers">144</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;title&#039; =&gt; $module-&gt;title,</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">145</td><td class="diffLineNumbers">145</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;description&#039; =&gt; $module-&gt;description,</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">146</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;status&#039; =&gt; $module-&gt;check());</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">146</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;status&#039; =&gt; $module-&gt;check()<span class="ediffChangedB">,</span></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">147</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">signature</span><span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">=</span><span class="ediffChangedB">&gt;</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">isset</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">module</span><span class="ediffChangedB">-</span><span class="ediffChangedB">&gt;</span><span class="ediffChangedB">signature</span>) <span class="ediffChangedB">?</span> <span class="ediffChangedB">$</span><span class="ediffChangedB">module</span><span class="ediffChangedB">-</span><span class="ediffChangedB">&gt;</span><span class="ediffChangedB">signature</span> <span class="ediffChangedB">:</span> <span class="ediffChangedB">null</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">147</td><td class="diffLineNumbers">148</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">148</td><td class="diffLineNumbers">149</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $module_keys = $module-&gt;keys();</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">149</td><td class="diffLineNumbers">150</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">251</td><td class="diffLineNumbers">252</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $keys = substr($keys, 0, strrpos($keys, &#039;&lt;br&gt;&lt;br&gt;&#039;));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">252</td><td class="diffLineNumbers">253</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">253</td><td class="diffLineNumbers">254</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;align&#039; =&gt; &#039;center&#039;, &#039;text&#039; =&gt; &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_MODULES, &#039;set=&#039; . $set . &#039;&amp;module=&#039; . $mInfo-&gt;code . &#039;&amp;action=remove&#039;) . &#039;&#034;&gt;&#039; . tep_image_button(&#039;button_module_remove.gif&#039;, IMAGE_MODULE_REMOVE) . &#039;&lt;/a&gt; &lt;a href=&#034;&#039; . tep_href_link(FILENAME_MODULES, &#039;set=&#039; . $set . (isset($HTTP_GET_VARS[&#039;module&#039;]) ? &#039;&amp;module=&#039; . $HTTP_GET_VARS[&#039;module&#039;] : &#039;&#039;) . &#039;&amp;action=edit&#039;) . &#039;&#034;&gt;&#039; . tep_image_button(&#039;button_edit.gif&#039;, IMAGE_EDIT) . &#039;&lt;/a&gt;&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">255</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">256</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($mInfo-&gt;signature) &amp;&amp; (list($scode, $smodule, $sversion, $soscversion) = explode(&#039;|&#039;, $mInfo-&gt;signature))) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">257</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . tep_image(DIR_WS_IMAGES . &#039;icon_info.gif&#039;, IMAGE_ICON_INFO) . &#039;&amp;nbsp;&lt;b&gt;&#039; . TEXT_INFO_VERSION . &#039;&lt;/b&gt; &#039; . $sversion . &#039; (&lt;a href=&#034;http://sig.oscommerce.com/&#039; . $mInfo-&gt;signature . &#039;&#034; target=&#034;_blank&#034;&gt;&#039; . TEXT_INFO_ONLINE_STATUS . &#039;&lt;/a&gt;)&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">258</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">259</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">254</td><td class="diffLineNumbers">260</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . $mInfo-&gt;description);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">255</td><td class="diffLineNumbers">261</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . $keys);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">256</td><td class="diffLineNumbers">262</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">257</td><td class="diffLineNumbers">263</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;align&#039; =&gt; &#039;center&#039;, &#039;text&#039; =&gt; &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_MODULES, &#039;set=&#039; . $set . &#039;&amp;module=&#039; . $mInfo-&gt;code . &#039;&amp;action=install&#039;) . &#039;&#034;&gt;&#039; . tep_image_button(&#039;button_module_install.gif&#039;, IMAGE_MODULE_INSTALL) . &#039;&lt;/a&gt;&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">264</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">265</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($mInfo-&gt;signature) &amp;&amp; (list($scode, $smodule, $sversion, $soscversion) = explode(&#039;|&#039;, $mInfo-&gt;signature))) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">266</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . tep_image(DIR_WS_IMAGES . &#039;icon_info.gif&#039;, IMAGE_ICON_INFO) . &#039;&amp;nbsp;&lt;b&gt;&#039; . TEXT_INFO_VERSION . &#039;&lt;/b&gt; &#039; . $sversion . &#039; (&lt;a href=&#034;http://sig.oscommerce.com/&#039; . $mInfo-&gt;signature . &#039;&#034; target=&#034;_blank&#034;&gt;&#039; . TEXT_INFO_ONLINE_STATUS . &#039;&lt;/a&gt;)&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">267</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">268</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">258</td><td class="diffLineNumbers">269</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = array(&#039;text&#039; =&gt; &#039;&lt;br&gt;&#039; . $mInfo-&gt;description);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">259</td><td class="diffLineNumbers">270</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">260</td><td class="diffLineNumbers">271</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/languages/english/modules.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/english/modules.php?r1=477&r2=1802">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/english/modules.php?r1=477&r2=1802">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">18</td><td class="diffLineNumbers">18</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TABLE_HEADING_SORT_ORDER&#039;, &#039;Sort Order&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">19</td><td class="diffLineNumbers">19</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TABLE_HEADING_ACTION&#039;, &#039;Action&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">20</td><td class="diffLineNumbers">20</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">21</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_INFO_VERSION&#039;, &#039;Version:&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">22</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_INFO_ONLINE_STATUS&#039;, &#039;online status&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">23</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">21</td><td class="diffLineNumbers">24</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TEXT_MODULE_DIRECTORY&#039;, &#039;Module Directory:&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">22</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/languages/espanol/modules.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/espanol/modules.php?r1=477&r2=1802">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/espanol/modules.php?r1=477&r2=1802">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">18</td><td class="diffLineNumbers">18</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TABLE_HEADING_SORT_ORDER&#039;, &#039;Orden&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">19</td><td class="diffLineNumbers">19</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TABLE_HEADING_ACTION&#039;, &#039;Acci&amp;oacute;n&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">20</td><td class="diffLineNumbers">20</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">21</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_INFO_VERSION&#039;, &#039;Versi&amp;oacute;n:&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">22</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_INFO_ONLINE_STATUS&#039;, &#039;online status&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">23</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">21</td><td class="diffLineNumbers">24</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TEXT_MODULE_DIRECTORY&#039;, &#039;Directorio de m&amp;oacute;dulos:&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">22</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/languages/german/modules.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/german/modules.php?r1=477&r2=1802">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/languages/german/modules.php?r1=477&r2=1802">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">18</td><td class="diffLineNumbers">18</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TABLE_HEADING_SORT_ORDER&#039;, &#039;Reihenfolge&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">19</td><td class="diffLineNumbers">19</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TABLE_HEADING_ACTION&#039;, &#039;Aktion&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">20</td><td class="diffLineNumbers">20</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">21</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_INFO_VERSION&#039;, &#039;Version:&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">22</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">define(&#039;TEXT_INFO_ONLINE_STATUS&#039;, &#039;online status&#039;);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">23</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">21</td><td class="diffLineNumbers">24</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">define(&#039;TEXT_MODULE_DIRECTORY&#039;, &#039;Modul Verzeichnis:&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">22</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
</table>

<h3>[A] Update database backup and restoration</h3>

<ul>
  <li>When restoring a database, only drop tables that are being restored.</li>
  <li>Show only .sql, .zip, and .gz files in the backups listing.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/admin/backup.php<br />
catalog/admin/includes/functions/compatibility.php</p>

<span class="affectedFiles">File: catalog/admin/backup.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/backup.php?r1=1755&r2=1821">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/backup.php?r1=1755&r2=1821">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">206</td><td class="diffLineNumbers">206</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">207</td><td class="diffLineNumbers">207</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isset($restore_query)) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">208</td><td class="diffLineNumbers">208</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_array = array();</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">209</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $drop_table_names = array();</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">209</td><td class="diffLineNumbers">210</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_length = strlen($restore_query);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">210</td><td class="diffLineNumbers">211</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $pos = strpos($restore_query, &#039;;&#039;);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">211</td><td class="diffLineNumbers">212</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($i=$pos; $i&lt;$sql_length; $i++) {</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">239</td><td class="diffLineNumbers">240</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $next = &#039;insert&#039;;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">240</td><td class="diffLineNumbers">241</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">241</td><td class="diffLineNumbers">242</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( (eregi(&#039;create&#039;, $next)) || (eregi(&#039;insert&#039;, $next)) || (eregi(&#039;drop t&#039;, $next)) ) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">243</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $query = substr($restore_query, 0, $i);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">244</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">242</td><td class="diffLineNumbers">245</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $next = &#039;&#039;;</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">243</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_array[] = <span class="ediffChangedA">substr</span><span class="ediffChangedA">(</span>$<span class="ediffChangedA">restore</span><span class="ediffChangedA">_</span>query<span class="ediffChangedA">,</span> <span class="ediffChangedA">0</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">$</span><span class="ediffChangedA">i</span><span class="ediffChangedA">)</span>;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">246</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_array[] = $query;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">244</td><td class="diffLineNumbers">247</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $restore_query = ltrim(substr($restore_query, $i+1));</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">245</td><td class="diffLineNumbers">248</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sql_length = strlen($restore_query);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">246</td><td class="diffLineNumbers">249</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $i = strpos($restore_query, &#039;;&#039;)-1;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">250</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">251</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (eregi(&#039;^create*&#039;, $query)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">252</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $table_name = trim(substr($query, stripos($query, &#039;table &#039;)+6));</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">253</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $table_name = substr($table_name, 0, strpos($table_name, &#039; &#039;));</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">254</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">255</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $drop_table_names[] = $table_name;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">256</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">247</td><td class="diffLineNumbers">257</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">248</td><td class="diffLineNumbers">258</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">249</td><td class="diffLineNumbers">259</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">250</td><td class="diffLineNumbers">260</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">251</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(<span class="ediffChangedA">&#034;</span>drop table if exists <span class="ediffChangedA">address</span><span class="ediffChangedA">_</span><span class="ediffChangedA">book</span>, <span class="ediffChangedA">address</span><span class="ediffChangedA">_</span><span class="ediffChangedA">format</span>, <span class="ediffChangedA">administrators</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">banners</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">banners</span>_<span class="ediffChangedA">history</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">categories</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">categories</span>_<span class="ediffChangedA">description</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">configuration</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">configuration</span><span class="ediffChangedA">_</span><span class="ediffChangedA">group</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">counter</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">counter</span><span class="ediffChangedA">_</span><span class="ediffChangedA">history</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">countries</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">currencies</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">customers</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">customers</span><span class="ediffChangedA">_</span><span class="ediffChangedA">basket</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">customers</span><span class="ediffChangedA">_</span><span class="ediffChangedA">basket</span><span class="ediffChangedA">_</span><span class="ediffChangedA">attributes</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">customers</span><span class="ediffChangedA">_</span><span class="ediffChangedA">info</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">languages</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">manufacturers</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">manufacturers</span><span class="ediffChangedA">_</span><span class="ediffChangedA">info</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">orders</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">orders</span><span class="ediffChangedA">_</span><span class="ediffChangedA">products</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">orders</span><span class="ediffChangedA">_</span><span class="ediffChangedA">status</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">orders</span><span class="ediffChangedA">_</span><span class="ediffChangedA">status</span><span class="ediffChangedA">_</span><span class="ediffChangedA">history</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">orders</span><span class="ediffChangedA">_</span><span class="ediffChangedA">products</span><span class="ediffChangedA">_</span><span class="ediffChangedA">attributes</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">orders</span><span class="ediffChangedA">_</span><span class="ediffChangedA">products</span><span class="ediffChangedA">_</span><span class="ediffChangedA">download</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">products</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">products</span><span class="ediffChangedA">_</span><span class="ediffChangedA">attributes</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">products</span><span class="ediffChangedA">_</span><span class="ediffChangedA">attributes</span><span class="ediffChangedA">_</span><span class="ediffChangedA">download</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">prodcts</span><span class="ediffChangedA">_</span><span class="ediffChangedA">description</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">products</span><span class="ediffChangedA">_</span><span class="ediffChangedA">options</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">products</span><span class="ediffChangedA">_</span><span class="ediffChangedA">options</span><span class="ediffChangedA">_</span><span class="ediffChangedA">values</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">products</span><span class="ediffChangedA">_</span><span class="ediffChangedA">options</span><span class="ediffChangedA">_</span><span class="ediffChangedA">values</span><span class="ediffChangedA">_</span><span class="ediffChangedA">to</span><span class="ediffChangedA">_</span><span class="ediffChangedA">products</span><span class="ediffChangedA">_</span><span class="ediffChangedA">options</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">products</span><span class="ediffChangedA">_</span><span class="ediffChangedA">to</span><span class="ediffChangedA">_</span><span class="ediffChangedA">categories</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">reviews</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">reviews</span><span class="ediffChangedA">_</span><span class="ediffChangedA">description</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">sessions</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">specials</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">tax</span><span class="ediffChangedA">_</span><span class="ediffChangedA">class</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">tax</span><span class="ediffChangedA">_</span><span class="ediffChangedA">rates</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">geo</span><span class="ediffChangedA">_</span><span class="ediffChangedA">zones</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">whos</span><span class="ediffChangedA">_</span><span class="ediffChangedA">online</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">zones</span><span class="ediffChangedA">,</span> <span class="ediffChangedA">zones</span><span class="ediffChangedA">_</span><span class="ediffChangedA">to</span><span class="ediffChangedA">_</span><span class="ediffChangedA">geo</span><span class="ediffChangedA">_</span><span class="ediffChangedA">zones</span><span class="ediffChangedA">&#034;</span>);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">261</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query(<span class="ediffChangedB">&#039;</span>drop table if exists <span class="ediffChangedB">&#039;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">implode</span><span class="ediffChangedB">(</span><span class="ediffChangedB">&#039;</span>, <span class="ediffChangedB">&#039;</span>, <span class="ediffChangedB">$</span><span class="ediffChangedB">drop</span>_<span class="ediffChangedB">table</span>_<span class="ediffChangedB">names</span>)<span class="ediffChangedB">)</span>;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">252</td><td class="diffLineNumbers">262</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">253</td><td class="diffLineNumbers">263</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($i=0, $n=sizeof($sql_array); $i&lt;$n; $i++) {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">254</td><td class="diffLineNumbers">264</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tep_db_query($sql_array[$i]);</td>
        </tr>
   <tr class="diffSkipped">
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffLineNumbers">&nbsp;</td>
    <td class="diffMarkerCol"><pre class="diffPre">&hellip;</pre></td>
    <td class="diffContent"><pre class="diffPre">&hellip;</pre></td>
   </tr>
        <tr>
                    <td class="diffLineNumbers">362</td><td class="diffLineNumbers">372</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; $dir = dir(DIR_FS_BACKUP);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">363</td><td class="diffLineNumbers">373</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; $contents = array();</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">364</td><td class="diffLineNumbers">374</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; while ($file = $dir-&gt;read()) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">365</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!is_dir(DIR_FS_BACKUP . $file)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">375</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!is_dir(DIR_FS_BACKUP . $file) <span class="ediffChangedB">&amp;</span><span class="ediffChangedB">&amp;</span> <span class="ediffChangedB">in</span><span class="ediffChangedB">_</span><span class="ediffChangedB">array</span><span class="ediffChangedB">(</span><span class="ediffChangedB">substr</span><span class="ediffChangedB">(</span><span class="ediffChangedB">$</span><span class="ediffChangedB">file</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">-</span><span class="ediffChangedB">3</span>)<span class="ediffChangedB">,</span> <span class="ediffChangedB">array</span><span class="ediffChangedB">(</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">zip</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">sql</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">.</span><span class="ediffChangedB">gz</span><span class="ediffChangedB">&#039;</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span><span class="ediffChangedB">)</span> {</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">366</td><td class="diffLineNumbers">376</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $contents[] = $file;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">367</td><td class="diffLineNumbers">377</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">368</td><td class="diffLineNumbers">378</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
</table>

<br />

<span class="affectedFiles">File: catalog/admin/includes/functions/compatibility.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/admin/includes/functions/compatibility.php?r1=1748&r2=1829">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/admin/includes/functions/compatibility.php?r1=1748&r2=1829">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">237</td><td class="diffLineNumbers">237</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return implode($arg_separator, $tmp);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">238</td><td class="diffLineNumbers">238</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">239</td><td class="diffLineNumbers">239</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">240</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">241</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">/*</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">242</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;* stripos() natively supported from PHP 5.0</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">243</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;* From Pear::PHP_Compat</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">244</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;*/</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">245</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">246</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; if (!function_exists(&#039;stripos&#039;)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">247</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; function stripos($haystack, $needle, $offset = null) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">248</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $fix = 0;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">249</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">250</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!is_null($offset)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">251</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($offset &gt; 0) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">252</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $haystack = substr($haystack, $offset, strlen($haystack) - $offset);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">253</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $fix = $offset;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">254</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">255</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">256</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">257</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $segments = explode(strtolower($needle), strtolower($haystack), 2);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">258</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">259</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">// Check there was a match</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">260</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (count($segments) == 1) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">261</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">262</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">263</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">264</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $position = strlen($segments[0]) + $fix;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">265</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB"></td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">266</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $position;</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">267</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp;&nbsp;&nbsp; }</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">268</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent diffContentB">&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">240</td><td class="diffLineNumbers">269</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">?&gt;</td>
        </tr>
</table>

<h3>[C] Update new products module</h3>

<ul>
  <li>Retrieve product names in one query.</li>
</ul>

<p class="affectedFiles"><b>Affected Files</b><br />
catalog/includes/modules/new_products.php</p>

<span class="affectedFiles">File: catalog/includes/modules/new_products.php (<a href="http://svn.oscommerce.com/fisheye/browse/osCommerce/oscommerce2/trunk/catalog/includes/modules/new_products.php?r1=477&r2=1806">online</a>) (<a href="http://svn.oscommerce.com/fisheye/rdiff/osCommerce/oscommerce2/trunk/catalog/includes/modules/new_products.php?r1=477&r2=1806">raw</a>)</span>

<table class="diff hardDiff unifiedDiff" cellspacing="0">
        <tr>
                    <td class="diffLineNumbers">18</td><td class="diffLineNumbers">18</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; new contentBoxHeading($info_box_contents);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">19</td><td class="diffLineNumbers">19</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">20</td><td class="diffLineNumbers">20</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; if ( (!isset($new_products_category_id)) || ($new_products_category_id == &#039;0&#039;) ) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">21</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; $new_products_query = tep_db_query(&#034;select p.products_id, p.products_image, p.products_tax_class_id, if(s.status, s.specials_new_products_price, p.products_price) as products_price from &#034; . TABLE_PRODUCTS . &#034; p left join &#034; . TABLE_SPECIALS . &#034; s on p.products_id = s.products_id where products_status = &#039;1&#039; order by p.products_date_added desc limit &#034; . MAX_DISPLAY_NEW_PRODUCTS);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">21</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; $new_products_query = tep_db_query(&#034;select p.products_id, p.products_image, p.products_tax_class_id, <span class="ediffChangedB">pd</span><span class="ediffChangedB">.</span><span class="ediffChangedB">products</span><span class="ediffChangedB">_</span><span class="ediffChangedB">name</span><span class="ediffChangedB">,</span> if(s.status, s.specials_new_products_price, p.products_price) as products_price from &#034; . TABLE_PRODUCTS . &#034; p left join &#034; . TABLE_SPECIALS . &#034; s on p.products_id = s.products_id<span class="ediffChangedB">,</span> <span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">TABLE</span><span class="ediffChangedB">_</span><span class="ediffChangedB">PRODUCTS</span><span class="ediffChangedB">_</span><span class="ediffChangedB">DESCRIPTION</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">pd</span> where <span class="ediffChangedB">p</span><span class="ediffChangedB">.</span>products_status = &#039;1&#039; <span class="ediffChangedB">and</span> <span class="ediffChangedB">p</span><span class="ediffChangedB">.</span><span class="ediffChangedB">products</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">pd</span><span class="ediffChangedB">.</span><span class="ediffChangedB">products</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">and</span> <span class="ediffChangedB">pd</span><span class="ediffChangedB">.</span><span class="ediffChangedB">language</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">int</span><span class="ediffChangedB">)</span><span class="ediffChangedB">$</span><span class="ediffChangedB">languages</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span><span class="ediffChangedB">&#039;</span> order by p.products_date_added desc limit &#034; . MAX_DISPLAY_NEW_PRODUCTS);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">22</td><td class="diffLineNumbers">22</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; } else {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">23</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent ediffContentA">&nbsp;&nbsp;&nbsp; $new_products_query = tep_db_query(&#034;select distinct p.products_id, p.products_image, p.products_tax_class_id, if(s.status, s.specials_new_products_price, p.products_price) as products_price from &#034; . TABLE_PRODUCTS . &#034; p left join &#034; . TABLE_SPECIALS . &#034; s on p.products_id = s.products_id, &#034; . TABLE_PRODUCTS_TO_CATEGORIES . &#034; p2c, &#034; . TABLE_CATEGORIES . &#034; c where p.products_id = p2c.products_id and p2c.categories_id = c.categories_id and c.parent_id = &#039;&#034; . (int)$new_products_category_id . &#034;&#039; and p.products_status = &#039;1&#039; order by p.products_date_added desc limit &#034; . MAX_DISPLAY_NEW_PRODUCTS);</td>
        </tr>
        <tr>
            <td class="diffLineNumbers">&nbsp;</td><td class="diffLineNumbersB">23</td><td class="diffMarkerColB"><span class="textAddMarker">+</span></td><td class="lineContent ediffContentB">&nbsp;&nbsp;&nbsp; $new_products_query = tep_db_query(&#034;select distinct p.products_id, p.products_image, p.products_tax_class_id, <span class="ediffChangedB">pd</span><span class="ediffChangedB">.</span><span class="ediffChangedB">products</span><span class="ediffChangedB">_</span><span class="ediffChangedB">name</span><span class="ediffChangedB">,</span> if(s.status, s.specials_new_products_price, p.products_price) as products_price from &#034; . TABLE_PRODUCTS . &#034; p left join &#034; . TABLE_SPECIALS . &#034; s on p.products_id = s.products_id, &#034; . TABLE_PRODUCTS_<span class="ediffChangedB">DESCRIPTION</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">pd</span><span class="ediffChangedB">,</span> <span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">TABLE</span><span class="ediffChangedB">_</span><span class="ediffChangedB">PRODUCTS</span><span class="ediffChangedB">_</span>TO_CATEGORIES . &#034; p2c, &#034; . TABLE_CATEGORIES . &#034; c where p.products_id = p2c.products_id and p2c.categories_id = c.categories_id and c.parent_id = &#039;&#034; . (int)$new_products_category_id . &#034;&#039; and p.products_status = &#039;1&#039; <span class="ediffChangedB">and</span> <span class="ediffChangedB">p</span><span class="ediffChangedB">.</span><span class="ediffChangedB">products</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">pd</span><span class="ediffChangedB">.</span><span class="ediffChangedB">products</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">and</span> <span class="ediffChangedB">pd</span><span class="ediffChangedB">.</span><span class="ediffChangedB">language</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">=</span> <span class="ediffChangedB">&#039;</span><span class="ediffChangedB">&#034;</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">(</span><span class="ediffChangedB">int</span><span class="ediffChangedB">)</span><span class="ediffChangedB">$</span><span class="ediffChangedB">languages</span><span class="ediffChangedB">_</span><span class="ediffChangedB">id</span> <span class="ediffChangedB">.</span> <span class="ediffChangedB">&#034;</span><span class="ediffChangedB">&#039;</span> order by p.products_date_added desc limit &#034; . MAX_DISPLAY_NEW_PRODUCTS);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">24</td><td class="diffLineNumbers">24</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; }</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">25</td><td class="diffLineNumbers">25</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent"></td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">26</td><td class="diffLineNumbers">26</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; $row = 0;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">27</td><td class="diffLineNumbers">27</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; $col = 0;</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">28</td><td class="diffLineNumbers">28</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; $info_box_contents = array();</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">29</td><td class="diffLineNumbers">29</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp; while ($new_products = tep_db_fetch_array($new_products_query)) {</td>
        </tr>
        <tr>
            <td class="diffLineNumbersA">30</td><td class="diffLineNumbers">&nbsp;</td><td class="diffMarkerColA"><span class="textDelMarker">-</span></td><td class="lineContent diffContentA">&nbsp;&nbsp;&nbsp; $new_products[&#039;products_name&#039;] = tep_get_products_name($new_products[&#039;products_id&#039;]);</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">31</td><td class="diffLineNumbers">30</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp; $info_box_contents[$row][$col] = array(&#039;align&#039; =&gt; &#039;center&#039;,</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">32</td><td class="diffLineNumbers">31</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;params&#039; =&gt; &#039;class=&#034;smallText&#034; width=&#034;33%&#034; valign=&#034;top&#034;&#039;,</td>
        </tr>
        <tr>
                    <td class="diffLineNumbers">33</td><td class="diffLineNumbers">32</td><td class="diffMarkerCol">&nbsp;</td><td class="lineContent diffContent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#039;text&#039; =&gt; &#039;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCT_INFO, &#039;products_id=&#039; . $new_products[&#039;products_id&#039;]) . &#039;&#034;&gt;&#039; . tep_image(DIR_WS_IMAGES . $new_products[&#039;products_image&#039;], $new_products[&#039;products_name&#039;], SMALL_IMAGE_WIDTH, SMALL_IMAGE_HEIGHT) . &#039;&lt;/a&gt;&lt;br&gt;&lt;a href=&#034;&#039; . tep_href_link(FILENAME_PRODUCT_INFO, &#039;products_id=&#039; . $new_products[&#039;products_id&#039;]) . &#039;&#034;&gt;&#039; . $new_products[&#039;products_name&#039;] . &#039;&lt;/a&gt;&lt;br&gt;&#039; . $currencies-&gt;display_price($new_products[&#039;products_price&#039;], tep_get_tax_rate($new_products[&#039;products_tax_class_id&#039;])));</td>
        </tr>
</table>

</body>
</html>
